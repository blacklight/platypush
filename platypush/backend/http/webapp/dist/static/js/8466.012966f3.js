"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[8466],{537:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _Utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2002),_components_Loading__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9828),_index__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7342),vue__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3751),vue__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(641),mitt__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6720);const bus=(0,mitt__WEBPACK_IMPORTED_MODULE_3__.A)();__webpack_exports__.A={name:"Elements",components:{Loading:_components_Loading__WEBPACK_IMPORTED_MODULE_1__.A},mixins:[_Utils__WEBPACK_IMPORTED_MODULE_0__.A],props:{content:{type:String}},data(){return{loading:!1,unwatch:null}},methods:{_parseActions(e){const t=[...e.children].filter((e=>"actions"===e.tagName?.toLowerCase())),n=t?.length?t[0].children:e.children,s=[...n].filter((e=>"action"===e.tagName?.toLowerCase()));if(s?.length)return[...s].map((e=>({action:e.attributes.name.value,args:[...e.children].reduce(((e,t)=>{let n;try{n=JSON.parse(t.innerText)}catch(s){t.innerText?.length&&(n=t.innerText)}return e[t.tagName.toLowerCase()]=n,e}),{})})))},_parseVars(e){const t=[...e.children].filter((e=>"vars"===e.tagName?.toLowerCase()));if(t?.length)return[...t[0].children].reduce(((e,t)=>{let n;try{n=JSON.parse(t.innerText)}catch(s){t.innerText?.length&&(n=t.innerText)}return e[t.tagName.toLowerCase()]=n,e}),{})},_parseHandlers(element){const handlers={},parseHndlScript=hndlText=>app=>eval(`// noinspection JSUnusedLocalSymbols\n          (async function (self) {\n            ${hndlText}\n          })`)(app),parseEventHndl=hndlText=>app=>event=>eval(`// noinspection JSUnusedLocalSymbols\n            (async function (self, event) {\n              ${hndlText}\n            })`)(app,event),hndlTags=[...element.children].filter((e=>"handlers"===e.tagName?.toLowerCase()));if(hndlTags?.length){const e=[...hndlTags[0].children].filter((e=>"mounted"===e.tagName?.toLowerCase()));e?.length&&(handlers.mounted=parseHndlScript(e[0].innerText));const t=[...hndlTags[0].children].filter((e=>"refresh"===e.tagName?.toLowerCase()));t?.length&&(handlers.refresh={handler:parseHndlScript(t[0].innerText),interval:t[0].attributes.interval?.value||10});const n=[...hndlTags[0].children].filter((e=>"event"===e.tagName?.toLowerCase()));n?.length&&(handlers.events=n.reduce(((e,t)=>(e[t.attributes.type.value]=parseEventHndl(t.innerText),e)),{}))}const actionsTags=[...element.children].filter((e=>"actions"===e.tagName?.toLowerCase()));if(actionsTags?.length){const e=[...actionsTags[0].children].filter((e=>"before"===e.tagName?.toLowerCase()));e?.length&&(handlers.beforeActions=parseHndlScript(e[0].innerText));const t=[...actionsTags[0].children].filter((e=>"after"===e.tagName?.toLowerCase()));t?.length&&(handlers.afterActions=parseHndlScript(t[0].innerText))}return handlers},_parseProps(e){return[...e.attributes].reduce(((e,t)=>(e[t.name]=t.value,e)),{})},propagateEvent(e){bus.emit("event",e)},_addEventHandler(){this.unwatch=this.subscribe((e=>{bus.emit("event",e)}))},_removeEventHandler(){this.unwatch&&(this.unwatch(),this.unwatch=null)}},mounted(){this.loading=!0,this._addEventHandler();try{this.$refs.container.innerHTML=this.content,Object.entries(_index__WEBPACK_IMPORTED_MODULE_2__.A).forEach((([e,t])=>{this.$options.components[e]=t,[...this.$refs.container.getElementsByTagName(e)].forEach((e=>{const n=this._parseProps(e);n.actions=this._parseActions(e),n.handlers=this._parseHandlers(e),n._vars=this._parseVars(e);const s=document.createElement("div");s.setAttribute("class","component"),s.innerHTML=e.innerHTML,e.parentNode.replaceChild(s,e),(0,vue__WEBPACK_IMPORTED_MODULE_4__.Ef)({render(){return(0,vue__WEBPACK_IMPORTED_MODULE_5__.h)(t,n)},data(){return{bus:bus}}}).mount(s)}))}));for(const e of["handlers","actions","vars"])this.$refs.container.getElementsByTagName(e).forEach((e=>{e.parentNode.removeChild(e)}))}finally{this.loading=!1}},unmounted(){this._removeEventHandler()}}},2209:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _Utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2002);__webpack_exports__.A={mixins:[_Utils__WEBPACK_IMPORTED_MODULE_0__.A],props:{name:{type:String,default:"[Unnamed sensor]"},iconClass:{type:String},iconUrl:{type:String},iconColor:{type:String},actions:{type:Array,default:()=>[]},_vars:{type:Object,default:()=>({})},handlers:{type:Object,default:()=>({})},bus:{type:Object}},data(){return{vars:{...this._vars||{}},_interval:void 0,refresh:null,refreshInterval:null,value:null,loading:!1}},computed:{iconStyle(){if(this.iconClass?.length||!this.iconColor?.length)return{color:this.iconColor}},hasIcon(){return this.iconUrl?.length||this.iconClass?.length}},methods:{async run(){if(this.handlers.input)return this.handlers.input(this)(this.value);this.handlers.beforeActions&&await this.handlers.beforeActions(this);for(const e of this.actions)await this.request_(e);this.handlers.afterActions&&await this.handlers.afterActions(this)},async request_(action){const args=Object.entries(action.args).reduce(((args,[key,value])=>{if(value.trim){value=value.trim();const m=value.match(/^{{\s*(.*)\s*}}/);m&&(value=eval(`// noinspection JSUnusedLocalSymbols\n                        (function (self) {\n                            return ${m[1]}\n                        })`)(this))}return args[key]=value,args}),{});await this.request(action.action,args)},async processEvent(e){const t=(this.handlers.events||{})[e.type];t&&await t(this)(e)}},async mounted(){if(this.$root.bus.on("event",this.processEvent),this.handlers.mounted&&await this.handlers.mounted(this),this.handlers.refresh&&(this.refreshInterval=1e3*(this.handlers.refresh?.interval||0),this.refresh=()=>{this.handlers.refresh.handler(this)},await this.refresh(),this.refreshInterval)){const e=this,t=()=>e.refresh();this._interval=setInterval(t,this.refreshInterval)}},unmounted(){this._interval&&clearInterval(this._interval)}}},7342:function(e,t,n){n.d(t,{A:function(){return j}});var s=n(641),a=n(33);const r={key:0,class:"col-1 icon-container"},i=["src","alt"],l=["textContent"];function o(e,t,n,o,c,u){return(0,s.uX)(),(0,s.CE)("div",{class:"run component-row",onClick:t[0]||(t[0]=(...t)=>e.run&&e.run(...t))},[e.hasIcon?((0,s.uX)(),(0,s.CE)("div",r,[e.iconUrl?.length?((0,s.uX)(),(0,s.CE)("img",{key:0,class:"icon",src:e.iconUrl,alt:e.name},null,8,i)):((0,s.uX)(),(0,s.CE)("i",{key:1,class:(0,a.C4)(["icon",e.iconClass]),style:(0,a.Tr)(e.iconStyle)},null,6))])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,a.C4)({"col-11":e.hasIcon,"col-12":!e.hasIcon}),textContent:(0,a.v_)(e.name)},null,10,l)])}var c=n(2209),u={name:"Run",mixins:[c.A]},h=n(6262);const _=(0,h.A)(u,[["render",o],["__scopeId","data-v-7478b72d"]]);var d=_;const p={key:0,class:"col-1 icon-container"},v=["src","alt"],m=["textContent"],f={class:"col-3 value-container"},g={class:"value"},C=["textContent"];function E(e,t,n,r,i,l){return(0,s.uX)(),(0,s.CE)("div",{class:"sensor component-row",onClick:t[0]||(t[0]=(...e)=>l.run&&l.run(...e))},[e.hasIcon?((0,s.uX)(),(0,s.CE)("div",p,[e.iconUrl?.length?((0,s.uX)(),(0,s.CE)("img",{key:0,class:"icon",src:e.iconUrl,alt:e.name},null,8,v)):((0,s.uX)(),(0,s.CE)("i",{key:1,class:(0,a.C4)(["icon",e.iconClass]),style:(0,a.Tr)(e.iconStyle)},null,6))])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,a.C4)({"col-8":e.hasIcon,"col-9":!e.hasIcon}),textContent:(0,a.v_)(e.name)},null,10,m),(0,s.Lk)("div",f,[(0,s.Lk)("div",g,[(0,s.eW)((0,a.v_)(e.value)+" ",1),n.unit?((0,s.uX)(),(0,s.CE)("span",{key:0,textContent:(0,a.v_)(n.unit)},null,8,C)):(0,s.Q3)("",!0)])])])}var b={name:"Sensor",mixins:[c.A],props:{unit:{type:String}},methods:{async run(){if(this.handlers.beforeActions&&await this.handlers.beforeActions(this),this.actions?.length)for(const e of this.actions)await this.request_(e);else await this.refresh();this.handlers.afterActions&&await this.handlers.afterActions(this)}}};const y=(0,h.A)(b,[["render",E],["__scopeId","data-v-53594122"]]);var w=y;const k={class:"slider-root component-row"},L={key:0,class:"col-1 icon-container"},A=["src","alt"],T=["textContent"],x={class:"col-5 slider-container"},I={class:"slider"};function S(e,t,n,r,i,l){const o=(0,s.g2)("SliderElement");return(0,s.uX)(),(0,s.CE)("div",k,[e.hasIcon?((0,s.uX)(),(0,s.CE)("div",L,[e.iconUrl?.length?((0,s.uX)(),(0,s.CE)("img",{key:0,class:"icon",src:e.iconUrl,alt:e.name},null,8,A)):((0,s.uX)(),(0,s.CE)("i",{key:1,class:(0,a.C4)(["icon",e.iconClass]),style:(0,a.Tr)(e.iconStyle)},null,6))])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,a.C4)({"col-6":e.hasIcon,"col-7":!e.hasIcon}),textContent:(0,a.v_)(e.name)},null,10,T),(0,s.Lk)("div",x,[(0,s.Lk)("div",I,[(0,s.bF)(o,{value:e.value,range:[parseFloat(n.min),parseFloat(n.max)],onChange:l.run},null,8,["value","range","onChange"])])])])}var O=n(1808),D={name:"Slider",components:{SliderElement:O.A},mixins:[c.A],props:{min:{type:[String,Number],default:0},max:{type:[String,Number],required:!0}},methods:{async run(e){this.value=parseFloat(e.target.value),this.handlers.beforeActions&&await this.handlers.beforeActions(this);for(const t of this.actions)await this.request_(t);this.handlers.afterActions&&await this.handlers.afterActions(this)}}};const U=(0,h.A)(D,[["render",S],["__scopeId","data-v-71b842b2"]]);var M=U,P=n(3751);const X={key:0,class:"col-1 icon-container"},N=["src","alt"],B=["textContent"],R={class:"col-2 toggle-container"},H={class:"toggle"};function W(e,t,n,r,i,l){const o=(0,s.g2)("ToggleSwitch");return(0,s.uX)(),(0,s.CE)("div",{class:"switch component-row",onClick:t[0]||(t[0]=(...t)=>e.run&&e.run(...t))},[e.hasIcon?((0,s.uX)(),(0,s.CE)("div",X,[e.iconUrl?.length?((0,s.uX)(),(0,s.CE)("img",{key:0,class:"icon",src:e.iconUrl,alt:e.name},null,8,N)):((0,s.uX)(),(0,s.CE)("i",{key:1,class:(0,a.C4)(["icon",e.iconClass]),style:(0,a.Tr)(e.iconStyle)},null,6))])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,a.C4)({"col-9":e.hasIcon,"col-10":!e.hasIcon}),textContent:(0,a.v_)(e.name)},null,10,B),(0,s.Lk)("div",R,[(0,s.Lk)("div",H,[(0,s.bF)(o,{value:e.value,onInput:(0,P.D$)(e.run,["stop"])},null,8,["value","onInput"])])])])}var $=n(11),q={name:"Switch",components:{ToggleSwitch:$.A},mixins:[c.A]};const K=(0,h.A)(q,[["render",W],["__scopeId","data-v-97d3a936"]]);var Q=K,j={Run:d,Sensor:w,Slider:M,Switch:Q}},1808:function(e,t,n){n.d(t,{A:function(){return m}});var s=n(641),a=n(33),r=n(3751);const i={class:"slider-wrapper"},l=["textContent"],o=["textContent"],c={class:"slider-container"},u=["min","max","step","disabled","value"],h=["textContent"];function _(e,t,n,_,d,p){return(0,s.uX)(),(0,s.CE)("label",i,[n.withRange?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,a.C4)(["range-labels",{"with-label":n.withLabel}])},[n.withRange?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"label left",textContent:(0,a.v_)(n.range[0])},null,8,l)):(0,s.Q3)("",!0),n.withRange?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"label right",textContent:(0,a.v_)(n.range[1])},null,8,o)):(0,s.Q3)("",!0)],2)):(0,s.Q3)("",!0),(0,s.Lk)("span",c,[(0,s.Lk)("input",{class:(0,a.C4)(["slider",{"with-label":n.withLabel}]),type:"range",min:n.range[0],max:n.range[1],step:n.step,disabled:n.disabled,value:n.value,ref:"range",onInput:t[0]||(t[0]=(0,r.D$)((t=>e.$emit("input",t)),["stop"])),onChange:t[1]||(t[1]=(0,r.D$)((t=>e.$emit("change",t)),["stop"]))},null,42,u),n.withLabel?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"label",textContent:(0,a.v_)(n.value),ref:"label"},null,8,h)):(0,s.Q3)("",!0)])])}var d={emits:["input","change"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:()=>[0,100]},step:{type:Number,default:1},withLabel:{type:Boolean,default:!1},withRange:{type:Boolean,default:!1}}},p=n(6262);const v=(0,p.A)(d,[["render",_],["__scopeId","data-v-d90e850c"]]);var m=v},11:function(e,t,n){n.d(t,{A:function(){return p}});var s=n(641),a=n(33),r=n(3751);const i=e=>((0,s.Qi)("data-v-eff375b6"),e=e(),(0,s.jt)(),e),l=["checked","id"],o=i((()=>(0,s.Lk)("div",{class:"switch"},[(0,s.Lk)("div",{class:"dot"})],-1))),c={class:"label"};function u(e,t,n,i,u,h){return(0,s.uX)(),(0,s.CE)("div",{class:(0,a.C4)(["power-switch",{disabled:n.disabled}]),onClick:t[0]||(t[0]=(0,r.D$)(((...e)=>h.onInput&&h.onInput(...e)),["stop"]))},[(0,s.Lk)("input",{type:"checkbox",checked:n.value,id:n.id},null,8,l),(0,s.Lk)("label",null,[o,(0,s.Lk)("span",c,[(0,s.RG)(e.$slots,"default",{},void 0,!0)])])],2)}var h={name:"ToggleSwitch",emits:["input"],props:{id:{type:String},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput(e){if(this.disabled)return!1;this.$emit("input",e)}}},_=n(6262);const d=(0,_.A)(h,[["render",u],["__scopeId","data-v-eff375b6"]]);var p=d},8466:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var s=n(641);const a={class:"component-widget"},r={class:"container",ref:"container"};function i(e,t,n,i,l,o){const c=(0,s.g2)("Loading");return(0,s.uX)(),(0,s.CE)("div",a,[l.loading?((0,s.uX)(),(0,s.Wv)(c,{key:0})):(0,s.Q3)("",!0),(0,s.Lk)("div",r,null,512)])}var l=n(537),o=n(6262);const c=(0,o.A)(l.A,[["render",i],["__scopeId","data-v-450fcab1"]]);var u=c}}]);
//# sourceMappingURL=8466.012966f3.js.map
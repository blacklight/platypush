{"version":3,"file":"static/js/6975.7352e132.js","mappings":"qLACOA,MAAM,gB,SAGJA,MAAM,yB,SAqBNA,MAAM,yB,gKAxBbC,EAAAA,EAAAA,IA+CM,MA/CNC,EA+CM,CA9CWC,EAAAC,YAAS,WAAxBC,EAAAA,EAAAA,IAA4BC,EAAA,CAAAC,IAAA,KAEkD,UAAhCJ,EAAAK,YAAYC,kBAAe,WAAzER,EAAAA,EAAAA,IAcM,MAdNS,EAcM,EAbJC,EAAAA,EAAAA,IAYuCC,EAAA,CAZ/BJ,WAAYL,EAAAK,WACZK,OAAQV,EAAAU,OACRC,QAASX,EAAAC,UACTW,KAAMZ,EAAAY,KACNC,gBAAeC,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,kBAAmBD,IAC1CE,SAAMH,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,SAAUD,IACxBG,OAAIJ,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,OAAQD,IACpBI,eAAcL,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,iBAAkBD,IACxCK,eAAeC,EAAAC,aACfC,qBAAoBT,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,uBAAwBD,IACpDS,SAAMV,EAAA,KAAAA,EAAA,GAAAC,IAAEf,EAAAyB,eAAiBV,EAAQf,EAAAgB,MAAM,SAAUD,EAAO,GACxDW,mBAAmBL,EAAAM,iBACnBC,OAAId,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,OAAQD,K,0FAITf,EAAA6B,OAAOC,S,WAI5BhC,EAAAA,EAAAA,IAsBM,MAtBNiC,EAsBM,CAdeV,EAAAW,YAAYF,OAAS,IAAH,WAPrC5B,EAAAA,EAAAA,IAO6C+B,EAAA,C,MAP/B5B,WAAYL,EAAAK,WACZK,OAAQV,EAAAU,OACRmB,MAAOR,EAAAW,YACPrB,QAASX,EAAAC,UACT,YAAWD,EAAAK,YAAY6B,GACvBC,UAASd,EAAAe,QACTZ,SAAQH,EAAAM,kB,sGAcPN,EAAAgB,WAAWP,OAAS,IAAH,WAXhC5B,EAAAA,EAAAA,IAWwCoC,EAAA,C,MAX9BC,QAASlB,EAAAgB,WACTG,QAAS,cACT9B,OAAQV,EAAAU,OACR,kBAAiBV,EAAAyB,eACjBZ,gBAAeC,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,kBAAmBD,IAC1C0B,WAAQ3B,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,WAAYD,IAC5BG,OAAIJ,EAAA,KAAAA,EAAA,GAAAC,GAAEf,EAAAgB,MAAM,OAAQD,IACpBI,eAAcL,EAAA,MAAAA,EAAA,IAAAC,GAAEf,EAAAgB,MAAM,iBAAkBD,IACxCQ,qBAAoBT,EAAA,MAAAA,EAAA,IAAAC,GAAEf,EAAAgB,MAAM,uBAAwBD,IACpDS,SAAQH,EAAAqB,WACRd,OAAId,EAAA,MAAAA,EAAA,IAAAC,GAAEf,EAAAgB,MAAM,OAAQD,K,gFAxBE,WADlCb,EAAAA,EAAAA,IAGUyC,EAAA,C,MAHA,eAAa,G,mBACa,IAEpC,UAFoC,wB,yEAsCxC,GACEC,OAAQ,CAACC,EAAAA,YACTC,MAAO,CACL,kBACA,SACA,WACA,OACA,iBACA,uBACA,SACA,oBACA,QAGFC,WAAY,CACVC,YAAW,aACXC,QAAO,IACPC,MAAK,aACLC,QAAO,IACPC,QAAOA,EAAAA,GAGTC,SAAU,CACRrB,WAAAA,GACE,OAAOsB,KAAKC,aAAa7C,QAAQ8C,GAAS,CAAC,aAAc,YAAYC,SAASD,EAAKE,cAAe,EACpG,EAEArB,UAAAA,GACE,MAAMR,EAAQyB,KAAKC,aAAa7C,QAAQ8C,IAAU,CAAC,aAAc,YAAYC,SAASD,EAAKE,cAAe,GAE1G,OAAIJ,KAAKjD,YAAgBiD,KAAKjD,WAAWC,iBAAuD,UAApCgD,KAAKjD,WAAWC,gBAgBrEuB,EAfEA,EAAM8B,MAAK,CAACC,EAAGC,KACpB,GAAID,EAAEE,YAAcD,EAAEC,WACpB,OAAQ,IAAIC,KAAKH,EAAEE,YAAgB,IAAIC,KAAKF,EAAEC,YAEhD,GAAIF,EAAEE,WACJ,OAAQ,EAEV,GAAID,EAAEC,WACJ,OAAO,EAET,IAAIE,EAAQ,CAACJ,EAAEK,MAAQL,EAAEM,OAAS,GAAIL,EAAEI,MAAQJ,EAAEK,OAAS,IAC3D,OAAOF,EAAM,GAAGG,cAAcH,EAAM,GAAG,GAK7C,GAGFI,QAAS,CACPzC,gBAAAA,CAAiBtB,GACfiD,KAAKtC,MAAM,oBAAqB,CAC9BqD,KAAM,gBACHhE,GAEP,EAEAqC,UAAAA,CAAW4B,GACT,MAAMd,EAAOF,KAAKzB,MAAMyC,GACD,SAAnBd,EAAKE,WAAwBF,EAAKe,UACpCC,OAAOC,KAAKjB,EAAKe,UAAW,UAI9BjB,KAAK7B,eAAiB6C,CACxB,EAEA,kBAAMhD,CAAaoD,GACjB,MAAM,KAAElB,EAAI,GAAEmB,GAAOD,EACrBpB,KAAKsB,UAAW,EAEhB,UACQtB,KAAKuB,QAAQ,+BAAgC,CACjDC,YAAaxB,KAAKjD,WAAW6B,GAC7B6C,QAASvB,EAAKwB,iBACdC,OAAQN,UAGJrB,KAAKlB,SACb,CAAE,QACAkB,KAAKsB,UAAW,CAClB,CACF,EAEA,UAAMM,GACJ,MAAMC,EAAO7B,KAAK8B,aAClB,IAAI/E,EAAa8E,GAAM9E,WACvB,GAAKA,EAAL,CAGAiD,KAAKsB,UAAW,EAChB,IACEvE,QAAmBiD,KAAKuB,QAAQ,sBAAuB,CACrDE,QAAS1E,IAGPA,GACFiD,KAAK3B,iBAAiBtB,EAC1B,CAAE,QACAiD,KAAKsB,UAAW,CAClB,CAZQ,CAaV,EAEA,aAAMxC,GAGJ,GAAyC,UAArCkB,KAAKjD,YAAYC,gBAArB,CAGAgD,KAAKsB,UAAW,EAChB,IAC2C,YAArCtB,KAAKjD,YAAYC,gBACnBgD,KAAKzB,aACGyB,KAAKuB,QAAQ,iCAAkC,CACnDQ,UAAW/B,KAAKjD,WAAW6B,MAE7BoD,KAAKjF,IAAU,IACZA,EACHqD,UAAW,iBAGbJ,KAAKzB,MAAQyB,KAAKjD,YAAY6B,SAEpBoB,KAAKuB,QAAQ,2BAA4B,CAC7CQ,UAAW/B,KAAKjD,WAAW6B,GAC3BqD,MAAO,cAEAjC,KAAKuB,QAAQ,mCAAmCS,KAAKjF,IAAU,IACrEA,EACHqD,UAAW,gBAGnB,CAAE,QACAJ,KAAKsB,UAAW,CAClB,CA3BQ,CA4BV,GAGF,aAAMY,GACJlC,KAAK4B,aACC5B,KAAKlB,SACb,G,UClMF,MAAMqD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://platypush/./src/components/panels/Media/Providers/Jellyfin/views/Media/Index.vue","webpack://platypush/./src/components/panels/Media/Providers/Jellyfin/views/Media/Index.vue?0661"],"sourcesContent":["<template>\n  <div class=\"videos index\">\n    <Loading v-if=\"isLoading\" />\n\n    <div class=\"wrapper music-wrapper\" v-else-if=\"collection?.collection_type === 'music'\">\n      <Music :collection=\"collection\"\n             :filter=\"filter\"\n             :loading=\"isLoading\"\n             :path=\"path\"\n             @add-to-playlist=\"$emit('add-to-playlist', $event)\"\n             @delete=\"$emit('delete', $event)\"\n             @play=\"$emit('play', $event)\"\n             @play-with-opts=\"$emit('play-with-opts', $event)\"\n             @playlist-move=\"playlistMove\"\n             @remove-from-playlist=\"$emit('remove-from-playlist', $event)\"\n             @select=\"selectedResult = $event; $emit('select', $event)\"\n             @select-collection=\"selectCollection\"\n             @view=\"$emit('view', $event)\" />\n    </div>\n\n    <NoItems :with-shadow=\"false\"\n             v-else-if=\"!items?.length\">\n      No media found.\n    </NoItems>\n\n    <div class=\"wrapper items-wrapper\" v-else>\n      <Collections :collection=\"collection\"\n                   :filter=\"filter\"\n                   :items=\"collections\"\n                   :loading=\"isLoading\"\n                   :parent-id=\"collection?.id\"\n                   @refresh=\"refresh\"\n                   @select=\"selectCollection\"\n                   v-if=\"collections.length > 0\" />\n\n      <Results :results=\"mediaItems\"\n               :sources=\"{'jellyfin': true}\"\n               :filter=\"filter\"\n               :selected-result=\"selectedResult\"\n               @add-to-playlist=\"$emit('add-to-playlist', $event)\"\n               @download=\"$emit('download', $event)\"\n               @play=\"$emit('play', $event)\"\n               @play-with-opts=\"$emit('play-with-opts', $event)\"\n               @remove-from-playlist=\"$emit('remove-from-playlist', $event)\"\n               @select=\"selectItem\"\n               @view=\"$emit('view', $event)\"\n               v-if=\"mediaItems.length > 0\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Collections from \"@/components/panels/Media/Providers/Jellyfin/Collections\";\nimport Loading from \"@/components/Loading\";\nimport Mixin from \"@/components/panels/Media/Providers/Jellyfin/Mixin\";\nimport Music from \"../Music/Index\";\nimport NoItems from \"@/components/elements/NoItems\";\nimport Results from \"@/components/panels/Media/Results\";\n\nexport default {\n  mixins: [Mixin],\n  emits: [\n    'add-to-playlist',\n    'delete',\n    'download',\n    'play',\n    'play-with-opts',\n    'remove-from-playlist',\n    'select',\n    'select-collection',\n    'view',\n  ],\n\n  components: {\n    Collections,\n    Loading,\n    Music,\n    NoItems,\n    Results,\n  },\n\n  computed: {\n    collections() {\n      return this.sortedItems?.filter((item) => ['collection', 'playlist'].includes(item.item_type)) ?? []\n    },\n\n    mediaItems() {\n      const items = this.sortedItems?.filter((item) => !['collection', 'playlist'].includes(item.item_type)) ?? []\n\n      if (this.collection && (!this.collection.collection_type || this.collection.collection_type === 'books')) {\n        return items.sort((a, b) => {\n          if (a.created_at && b.created_at)\n            return (new Date(a.created_at)) < (new Date(b.created_at))\n\n          if (a.created_at)\n            return -1\n\n          if (b.created_at)\n            return 1\n\n          let names = [a.name || a.title || '', b.name || b.title || '']\n          return names[0].localeCompare(names[1])\n        })\n      }\n\n      return items\n    },\n  },\n\n  methods: {\n    selectCollection(collection) {\n      this.$emit('select-collection', {\n        type: 'homevideos',\n        ...collection,\n      })\n    },\n\n    selectItem(index) {\n      const item = this.items[index]\n      if (item.item_type === 'book' && item.embed_url) {\n        window.open(item.embed_url, '_blank')\n        return\n      }\n\n      this.selectedResult = index\n    },\n\n    async playlistMove(event) {\n      const { item, to } = event\n      this.loading_ = true\n\n      try {\n        await this.request('media.jellyfin.playlist_move', {\n          playlist_id: this.collection.id,\n          item_id: item.playlist_item_id,\n          to_pos: to,\n        })\n\n        await this.refresh()\n      } finally {\n        this.loading_ = false\n      }\n    },\n\n    async init() {\n      const args = this.getUrlArgs()\n      let collection = args?.collection\n      if (!collection)\n        return\n\n      this.loading_ = true\n      try {\n        collection = await this.request('media.jellyfin.info', {\n          item_id: collection,\n        })\n\n        if (collection)\n          this.selectCollection(collection)\n      } finally {\n        this.loading_ = false\n      }\n    },\n\n    async refresh() {\n      // Don't fetch items if we're in the music view -\n      // we'll fetch them in the Music component\n      if (this.collection?.collection_type === 'music')\n        return\n\n      this.loading_ = true\n      try {\n        if (this.collection?.collection_type === 'tvshows') {\n          this.items = (\n            await this.request('media.jellyfin.get_collections', {\n              parent_id: this.collection.id,\n            })\n          ).map((collection) => ({\n            ...collection,\n            item_type: 'collection',\n          }))\n        } else {\n          this.items = this.collection?.id ?\n            (\n              await this.request('media.jellyfin.get_items', {\n                parent_id: this.collection.id,\n                limit: 25000,\n              })\n            ) : (await this.request('media.jellyfin.get_collections')).map((collection) => ({\n              ...collection,\n              item_type: 'collection',\n            }))\n        }\n      } finally {\n        this.loading_ = false\n      }\n    },\n  },\n\n  async mounted() {\n    this.init()\n    await this.refresh()\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/components/panels/Media/Providers/Jellyfin/common.scss\";\n\n.index {\n  position: relative;\n\n  :deep(.items-wrapper) {\n    height: 100%;\n    position: relative;\n    overflow: auto;\n\n    .index {\n      height: fit-content;\n    }\n\n    .items {\n      overflow: hidden;\n    }\n  }\n\n  .music-wrapper {\n    height: 100%;\n  }\n\n  :deep(.floating-btn-container) {\n    position: fixed;\n    bottom: 5.5em;\n\n    @include until($tablet) {\n      right: 1em;\n    }\n\n    @include from($tablet) {\n      right: 2.5em;\n    }\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=19c9d0dd&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=19c9d0dd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-19c9d0dd\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_ctx","isLoading","_createBlock","_component_Loading","key","collection","collection_type","_hoisted_2","_createVNode","_component_Music","filter","loading","path","onAddToPlaylist","_cache","$event","$emit","onDelete","onPlay","onPlayWithOpts","onPlaylistMove","$options","playlistMove","onRemoveFromPlaylist","onSelect","selectedResult","onSelectCollection","selectCollection","onView","items","length","_hoisted_3","collections","_component_Collections","id","onRefresh","refresh","mediaItems","_component_Results","results","sources","onDownload","selectItem","_component_NoItems","mixins","Mixin","emits","components","Collections","Loading","Music","NoItems","Results","computed","this","sortedItems","item","includes","item_type","sort","a","b","created_at","Date","names","name","title","localeCompare","methods","type","index","embed_url","window","open","event","to","loading_","request","playlist_id","item_id","playlist_item_id","to_pos","init","args","getUrlArgs","parent_id","map","limit","mounted","__exports__","render"],"sourceRoot":""}
"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[3006,3644,2012,47],{6561:function(t,e,i){i.d(e,{A:function(){return d}});var l=i(641),s=i(33);const a={class:"no-items-container"};function n(t,e,i,n,o,r){return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",{class:(0,s.C4)(["no-items fade-in",{shadow:i.withShadow}])},[(0,l.RG)(t.$slots,"default",{},void 0,!0)],2)])}var o={name:"NoItems",props:{withShadow:{type:Boolean,default:!0}}},r=i(6262);const c=(0,r.A)(o,[["render",n],["__scopeId","data-v-4856c4d7"]]);var d=c},3644:function(t,e,i){i.r(e),i.d(e,{default:function(){return y}});var l=i(641),s=i(33);const a={class:"collections items"},n=["onClick"],o={class:"image"},r=["src","alt","onError"],c={key:0,class:"name"},d={key:1,class:"float bottom-right"};function u(t,e,i,u,m,h){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["collections index",{"is-root":!i.parentId}])},[(0,l.Lk)("div",a,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(h.filteredItems,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"collection item",key:e.id,onClick:i=>t.$emit("select",e)},[(0,l.Lk)("div",o,[m.fallbackImageCollections[e.id]?((0,l.uX)(),(0,l.CE)("i",{key:1,class:(0,s.C4)(h.collectionsIcons[e.type]??"fas fa-folder")},null,2)):((0,l.uX)(),(0,l.CE)("img",{key:0,src:e.image,alt:e.name,onError:t=>h.onImageError(e)},null,40,r))]),m.fallbackImageCollections[e.id]||i.parentId?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("h2",null,(0,s.v_)(e.name),1)])):(0,l.Q3)("",!0),e.year?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("span",null,(0,s.v_)(e.year),1)])):(0,l.Q3)("",!0)],8,n)))),128))])],2)}var m={props:{filter:{type:String},items:{type:Array,default:()=>[]},batchItems:{type:Number,default:100},parentId:{type:String}},data(){return{fallbackImageCollections:{},maxResultIndex:this.batchItems}},computed:{collectionsIcons(){return{books:"fas fa-book",homevideos:"fas fa-video",movies:"fas fa-film",music:"fas fa-music",playlists:"fas fa-list",photos:"fas fa-image",series:"fas fa-tv"}},filteredItems(){return Object.values(this.items).filter((t=>!this.filter||t.name.toLowerCase().includes(this.filter.toLowerCase()))).sort(((t,e)=>"album"===t.item_type&&"album"===e.item_type&&t.year&&e.year&&t.year!==e.year?e.year-t.year:t.name.localeCompare(e.name))).slice(0,this.maxResultIndex)}},methods:{onImageError(t){this.fallbackImageCollections[t.id]=!0},onScroll(t){const e=t.target;if(!e)return;const i=e.scrollHeight-e.scrollTop<=e.clientHeight+150;i&&(this.maxResultIndex+=this.batchItems)}},mounted(){this.$el.parentElement?.addEventListener("scroll",this.onScroll)},unmounted(){this.$el.parentElement?.removeEventListener("scroll",this.onScroll)}},h=i(6262);const f=(0,h.A)(m,[["render",u],["__scopeId","data-v-7f4d435e"]]);var y=f},2012:function(t,e,i){i.r(e),i.d(e,{default:function(){return n}});var l=i(47),s={mixins:[l["default"]],emits:["add-to-playlist","back","download","play","play-with-opts","select","view"],props:{collection:{type:Object},path:{type:Array,default:()=>[]}},data(){return{items:[],loading_:!1,selectedResult:null,sort:{attr:"title",desc:!1}}},computed:{isLoading(){return this.loading_||this.loading},sortedItems(){return this.items?[...this.items].sort(((t,e)=>{const i=this.sort.attr,l=this.sort.desc;let s=t[i],a=e[i];return"number"===typeof s||"number"===typeof a?(s=s||0,a=a||0,l?a-s:s-a):(s=(s||"").toString().toLowerCase(),a=(a||"").toString().toLowerCase(),l?a.localeCompare(s):s.localeCompare(a))})).map((t=>({item_type:t.type,...t,type:"jellyfin"}))):[]}},methods:{async refresh(){const t=this.collection?.name;if(t?.length){this.loading_=!0;try{this.items=await this.request("media.jellyfin.search",{collection:t,limit:1e3})}finally{this.loading_=!1}}}},watch:{collection(){this.refresh()}}};const a=s;var n=a},3006:function(t,e,i){i.r(e),i.d(e,{default:function(){return P}});var l=i(641),s=i(33),a=i(3751);const n=t=>((0,l.Qi)("data-v-1f40cb6a"),t=t(),(0,l.jt)(),t),o={class:"music index"},r={key:0,class:"artist header"},c={key:0,class:"image"},d=["src"],u={class:"info"},m=["textContent"],h={key:1,class:"album header"},f={key:0,class:"image"},y=["src"],p={class:"info"},g=["textContent"],v={key:0,class:"artist"},k=["textContent"],C=["textContent"],_={class:"details"},b={key:0,class:"row"},w=n((()=>(0,l.Lk)("span",{class:"label"},"Year:",-1))),I=["textContent"],A={key:1,class:"row"},L=n((()=>(0,l.Lk)("span",{class:"label"},"Duration:",-1))),E=["textContent"];function x(t,e,i,n,x,X){const S=(0,l.g2)("Loading"),$=(0,l.g2)("NoItems"),Q=(0,l.g2)("Collections"),j=(0,l.g2)("Results");return(0,l.uX)(),(0,l.CE)("div",o,[t.isLoading?((0,l.uX)(),(0,l.Wv)(S,{key:0})):t.items?.length?((0,l.uX)(),(0,l.CE)("main",{key:2,class:(0,s.C4)({album:"album"===X.view,artist:"artist"===X.view})},["artist"===X.view?((0,l.uX)(),(0,l.CE)("div",r,[t.collection.image?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("img",{src:t.collection.image},null,8,d)])):(0,l.Q3)("",!0),(0,l.Lk)("div",u,[(0,l.Lk)("h1",{textContent:(0,s.v_)(t.collection.name)},null,8,m)])])):(0,l.Q3)("",!0),"album"===X.view?((0,l.uX)(),(0,l.CE)("div",h,[t.collection.image?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("img",{src:t.collection.image},null,8,y)])):(0,l.Q3)("",!0),(0,l.Lk)("div",p,[(0,l.Lk)("h1",{textContent:(0,s.v_)(t.collection.name)},null,8,g),X.displayedArtist?.id?((0,l.uX)(),(0,l.CE)("div",v,[X.displayedArtist?((0,l.uX)(),(0,l.CE)("a",{key:0,href:"#",textContent:(0,s.v_)(X.displayedArtist.name),onClick:e[0]||(e[0]=(0,a.D$)(((...t)=>X.selectArtist&&X.selectArtist(...t)),["prevent","stop"]))},null,8,k)):((0,l.uX)(),(0,l.CE)("span",{key:1,textContent:(0,s.v_)(X.displayedArtist.name)},null,8,C))])):(0,l.Q3)("",!0),(0,l.Lk)("div",_,[t.collection.year?((0,l.uX)(),(0,l.CE)("div",b,[w,(0,l.Lk)("span",{class:"value",textContent:(0,s.v_)(t.collection.year)},null,8,I)])):(0,l.Q3)("",!0),t.collection.duration?((0,l.uX)(),(0,l.CE)("div",A,[L,(0,l.Lk)("span",{class:"value",textContent:(0,s.v_)(t.formatDuration(t.collection.duration,!0))},null,8,E)])):(0,l.Q3)("",!0)])])])):(0,l.Q3)("",!0),X.collections?.length>0?((0,l.uX)(),(0,l.Wv)(Q,{key:2,collection:t.collection,filter:t.filter,items:X.collections,loading:t.isLoading,"parent-id":t.collection?.id,onSelect:X.selectCollection},null,8,["collection","filter","items","loading","parent-id","onSelect"])):(0,l.Q3)("",!0),X.mediaItems?.length>0?((0,l.uX)(),(0,l.Wv)(j,{key:3,results:X.mediaItems,sources:{jellyfin:!0},filter:t.filter,"list-view":!0,"selected-result":t.selectedResult,"show-date":!1,onAddToPlaylist:e[1]||(e[1]=e=>t.$emit("add-to-playlist",e)),onDownload:e[2]||(e[2]=e=>t.$emit("download",e)),onPlay:e[3]||(e[3]=e=>t.$emit("play",e)),onPlayWithOpts:e[4]||(e[4]=e=>t.$emit("play-with-opts",e)),onRemoveFromPlaylist:e[5]||(e[5]=e=>t.$emit("remove-from-playlist",e)),onSelect:e[6]||(e[6]=e=>t.selectedResult=e),onView:e[7]||(e[7]=e=>t.$emit("view",e))},null,8,["results","filter","selected-result"])):(0,l.Q3)("",!0)],2)):((0,l.uX)(),(0,l.Wv)($,{key:1,"with-shadow":!1},{default:(0,l.k6)((()=>[(0,l.eW)(" No music found. ")])),_:1}))])}var X=i(3644),S=i(9828),$=i(2012),Q=i(6561),j=i(1101),R={mixins:[$["default"]],emits:["select","select-collection"],components:{Collections:X["default"],Loading:S.A,NoItems:Q.A,Results:j.A},data(){return{artist:null}},computed:{collections(){return(this.sortedItems?.filter((t=>["collection","artist","album"].includes(t.item_type)))??[]).sort(((t,e)=>t.name.localeCompare(e.name)))},displayedArtist(){return this.artist||this.collection?.artist},mediaItems(){return(this.sortedItems?.filter((t=>!["collection","artist","album"].includes(t.item_type)))??[]).sort(((t,e)=>"album"===this.view&&t.track_number&&e.track_number&&t.track_number!==e.track_number?t.track_number-e.track_number:t.name.localeCompare(e.name))).map((t=>("album"===this.view&&(t.artist=this.artist||this.collection.artist,t.album=this.collection,t.image=this.collection.image),t)))},view(){switch(this.collection?.item_type){case"artist":return"artist";case"album":return"album";default:return"index"}}},methods:{async selectArtist(){const t=this.displayedArtist?.id||this.getUrlArgs().artist;if(t?.length){this.loading_=!0;try{const e=this.displayedArtist||await this.request("media.jellyfin.info",{item_id:t});e&&(this.selectCollection(e),this.$nextTick((()=>{this.setUrlArgs({artist:e.id,collection:e.id})})))}finally{this.loading_=!1}}},selectCollection(t){t&&t?.id!==this.collection?.id&&("artist"===t.item_type?this.setUrlArgs({artist:t.id}):"album"===t.item_type?this.setUrlArgs({collection:t.id}):this.setUrlArgs({collection:null}),this.$emit("select-collection",{collection_type:"music",...t}))},async init(){const t=this.getUrlArgs();let e=t?.collection;if(e){this.loading_=!0;try{e=await this.request("media.jellyfin.info",{item_id:e}),e&&this.selectCollection(e)}finally{this.loading_=!1}}},async refresh(){this.loading_=!0;try{switch(this.view){case"artist":this.artist={...this.collection},this.setUrlArgs({artist:this.collection.id,collection:this.collection.id}),this.items=(await this.request("media.jellyfin.get_items",{parent_id:this.collection.id,limit:25e3})).map((t=>("album"===this.collection?.item_type&&(t.image=this.collection.image),t)));break;case"album":this.setUrlArgs({collection:this.collection.id,artist:this.collection.artist?.id}),this.items=await this.request("media.jellyfin.get_items",{parent_id:this.collection.id,limit:25e3});break;default:this.artist=null,this.items=await this.request("media.jellyfin.get_artists",{limit:5e3});break}}finally{this.loading_=!1}}},async mounted(){await this.init(),await this.refresh()},unmounted(){this.setUrlArgs({collection:null,artist:null,album:null})}},U=i(6262);const q=(0,U.A)(R,[["render",x],["__scopeId","data-v-1f40cb6a"]]);var P=q},47:function(t,e,i){i.r(e),i.d(e,{default:function(){return n}});var l=i(2002),s={mixins:[l.A],emits:["add-to-playlist","back","create-playlist","download","download-audio","path-change","play","remove-from-playlist","remove-playlist","rename-playlist"],props:{filter:{type:String,default:""},loading:{type:Boolean,default:!1},mediaPlugin:{type:String},selectedPlaylist:{default:null},selectedChannel:{default:null}},data(){return{loading_:!1}},computed:{isLoading(){return this.loading||this.loading_}}};const a=s;var n=a}}]);
//# sourceMappingURL=3006.5a686d4e.js.map
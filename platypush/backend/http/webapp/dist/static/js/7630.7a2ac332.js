"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[7630],{9002:function(e,t,s){s.d(t,{o:function(){return i}});class i{constructor(e){if(this.ranges={hue:[0,360],sat:[0,100],bri:[0,100],ct:[154,500]},e)for(const t of Object.keys(this.ranges))e[t]&&(this.ranges[t]=e[t])}normalize(e,t,s){return s[0]+(e-t[0])*(s[1]-s[0])/(t[1]-t[0])}hslToRgb(e,t,s){[e,t,s]=[this.normalize(e,this.ranges.hue,[0,360]),this.normalize(t,this.ranges.sat,[0,100]),this.normalize(s,this.ranges.bri,[0,100])],s/=100;const i=t*Math.min(s,1-s)/100,a=t=>{const a=(t+e/30)%12,n=s-i*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*n)};return[a(0),a(8),a(4)]}rgbToHsl(e,t,s){e/=255,t/=255,s/=255;const i=Math.max(e,t,s),a=Math.min(e,t,s);let n,l,o=(i+a)/2;if(i===a)n=l=0;else{const r=i-a;switch(l=o>.5?r/(2-i-a):r/(i+a),i){case e:n=(t-s)/r+(t<s?6:0);break;case t:n=(s-e)/r+2;break;case s:n=(e-t)/r+4;break}n/=6}return[parseInt(this.normalize(n,[0,1],this.ranges.hue)),parseInt(this.normalize(l,[0,1],this.ranges.sat)),parseInt(this.normalize(o,[0,1],this.ranges.bri))]}xyToRgb(e,t,s){null==s&&(s=this.ranges.bri[1]);const i=1-e-t,a=(s/(this.ranges.bri[1]-1)).toFixed(2),n=a/t*e,l=a/t*i;let o=1.656492*n-.354851*a-.255038*l,r=.707196*-n+1.655397*a+.036152*l,d=.051713*n-.121364*a+1.01153*l;return o>d&&o>r&&o>1?(r/=o,d/=o,o=1):r>d&&r>o&&r>1?(o/=r,d/=r,r=1):d>o&&d>r&&d>1&&(o/=d,r/=d,d=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,r=r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055,d=d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055,o=Math.round(255*o),r=Math.round(255*r),d=Math.round(255*d),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(d)&&(d=0),[o,r,d].map((e=>Math.min(Math.max(0,e),255)))}rgbToXY(e,t,s){e>1&&(e/=255),t>1&&(t/=255),s>1&&(s/=255),e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;const i=.664511*e+.154324*t+.162028*s,a=.283881*e+.668433*t+.047685*s,n=88e-6*e+.07231*t+.986039*s;let l=parseFloat((i/(i+a+n)).toFixed(4)),o=parseFloat((a/(i+a+n)).toFixed(4));return isNaN(l)&&(l=0),isNaN(o)&&(o=0),[l,o]}rgbToBri(e,t,s){return Math.min(2*this.rgbToHsl(e,t,s)[2],this.ranges.bri[1])}getRGB(e){return null!=e.red&&null!=e.green&&null!=e.blue?[e.red,e.green,e.blue]:null!=e.r&&null!=e.g&&null!=e.b?[e.r,e.g,e.b]:e.rgb?e.rgb:void 0}getXY(e){return null!=e.x&&null!=e.y?[e.x,e.y]:e.xy?e.xy:void 0}toRGB(e){const t=this.getRGB(e);if(t)return t;const s=this.getXY(e);return s&&e.bri?this.xyToRgb(...s,e.bri):e.hue&&e.sat&&e.bri?this.hslToRgb(e.hue,e.sat,e.bri):(console.debug("Could not determine color space"),void console.debug(e))}toXY(e){const t=this.getXY(e);if(t&&e.bri)return[t[0],t[1],e.bri];const s=this.getRGB(e);if(s)return this.rgbToXY(...s);if(e.hue&&e.sat&&e.bri){const t=this.hslToRgb(e.hue,e.sat,e.bri);return this.rgbToXY(...t)}console.debug("Could not determine color space"),console.debug(e)}toHSL(e){if(e.hue&&e.sat&&e.bri)return[e.hue,e.sat,e.bri];const t=this.getRGB(e);if(t)return this.rgbToHsl(...t);const s=this.getXY(e);if(s&&e.bri){const t=this.xyToRgb(...s,e.bri);return this.rgbToHsl(...t)}console.debug("Could not determine color space"),console.debug(e)}hexToRgb(e){return[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)))}rgbToHex(e){return"#"+e.map((e=>{let t=e.toString(16);return t.length<2&&(t="0"+t),t})).join("")}}},9265:function(e,t,s){s.d(t,{A:function(){return m}});var i=s(641),a=s(3751),n=s(33);const l={class:"dropdown-container"},o=["title"],r=["textContent"];function d(e,t,s,d,u,c){const v=(0,i.g2)("DropdownBody");return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("button",{title:s.title,ref:"button",onClick:t[0]||(t[0]=(0,a.D$)((e=>c.toggle(e)),["stop"]))},[s.iconClass?((0,i.uX)(),(0,i.CE)("i",{key:0,class:(0,n.C4)(["icon",s.iconClass])},null,2)):(0,i.Q3)("",!0),s.text?((0,i.uX)(),(0,i.CE)("span",{key:1,class:"text",textContent:(0,n.v_)(s.text)},null,8,r)):(0,i.Q3)("",!0)],8,o),(0,i.Lk)("div",{class:(0,n.C4)(["body-container",{hidden:!u.visible}]),ref:"dropdownContainer"},[(0,i.bF)(v,{id:s.id,keepOpenOnItemClick:s.keepOpenOnItemClick,style:(0,n.Tr)(s.style),ref:"dropdown",onClick:c.onClick},{default:(0,i.k6)((()=>[(0,i.RG)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","style","onClick"])],2)])}var u=s(4200),c=s(2537),v={components:{DropdownBody:u.A},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}},data(){return{visible:!1}},computed:{button(){const e=this.$refs.button?.$el;return e?e.querySelector("button"):this.$refs.button},buttonStyle(){return this.button?getComputedStyle(this.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),c.j.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$nextTick(this.adjustDropdownPos)},adjustDropdownPos(){const e=this.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},s={left:t.left,top:t.top+this.buttonHeight},i=this.getDropdownWidth(),a=this.getDropdownHeight();if(s.left+i>(window.innerWidth+window.scrollX)/2&&(s.left-=i-this.buttonWidth),s.top+a>(window.innerHeight+window.scrollY)/2){let e=s.top-(a+this.buttonHeight-10);e<0&&(e=0),s.top=e}const n=this.$refs.dropdown.$el;n.classList.add("fade-in"),n.style.top=`${s.top}px`,n.style.left=`${s.left}px`,c.j.emit("dropdown-open",this.$refs.dropdown)},toggle(e){e?.stopPropagation(),this.$emit("click",e),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}},p=s(6262);const h=(0,p.A)(v,[["render",d],["__scopeId","data-v-3f1ad726"]]);var m=h},4200:function(e,t,s){s.d(t,{A:function(){return u}});var i=s(641),a=s(33);const n=["id"];function l(e,t,s,l,o,r){return(0,i.uX)(),(0,i.CE)("div",{class:"dropdown",id:s.id,style:(0,a.Tr)(s.style),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,i.RG)(e.$slots,"default",{},void 0,!0)],12,n)}var o={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}}},r=s(6262);const d=(0,r.A)(o,[["render",l],["__scopeId","data-v-24c5aa28"]]);var u=d},9612:function(e,t,s){s.d(t,{A:function(){return h}});var i=s(641),a=s(33);const n=["title"],l={key:0,class:"col-2 icon"},o=["textContent"];function r(e,t,s,r,d,u){const c=(0,i.g2)("Icon");return(0,i.uX)(),(0,i.CE)("div",{class:(0,a.C4)(["row item",{...u.itemClass_,disabled:s.disabled}]),title:s.hoverText,onClick:t[0]||(t[0]=(...e)=>u.clicked&&u.clicked(...e))},[s.iconClass?.length||s.iconUrl?.length?((0,i.uX)(),(0,i.CE)("div",l,[(0,i.bF)(c,{class:(0,a.C4)(s.iconClass),url:s.iconUrl},null,8,["class","url"])])):(0,i.Q3)("",!0),(0,i.Lk)("div",{class:(0,a.C4)(["text",{"col-10":null!=s.iconClass}]),textContent:(0,a.v_)(s.text)},null,10,o)],10,n)}var d=s(3778),u=s(2537),c={components:{Icon:d.A},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||u.j.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},v=s(6262);const p=(0,v.A)(c,[["render",r],["__scopeId","data-v-2babe09c"]]);var h=p},3778:function(e,t,s){s.d(t,{A:function(){return c}});var i=s(641),a=s(33);const n={class:"icon-container"},l=["src","alt"];function o(e,t,s,o,r,d){return(0,i.uX)(),(0,i.CE)("div",n,[s.url?.length?((0,i.uX)(),(0,i.CE)("img",{key:0,class:"icon",src:s.url,alt:s.alt},null,8,l)):d.className?.length?((0,i.uX)(),(0,i.CE)("i",{key:1,class:(0,a.C4)(["icon",d.className]),style:(0,a.Tr)({color:s.color})},null,6)):(0,i.Q3)("",!0)])}var r={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=s(6262);const u=(0,d.A)(r,[["render",o],["__scopeId","data-v-706a3bd1"]]);var c=u},1808:function(e,t,s){s.d(t,{A:function(){return g}});var i=s(641),a=s(33),n=s(3751);const l={class:"slider-wrapper"},o=["textContent"],r=["textContent"],d={class:"slider-container"},u=["min","max","step","disabled","value"],c=["textContent"];function v(e,t,s,v,p,h){return(0,i.uX)(),(0,i.CE)("label",l,[s.withRange?((0,i.uX)(),(0,i.CE)("span",{key:0,class:(0,a.C4)(["range-labels",{"with-label":s.withLabel}])},[s.withRange?((0,i.uX)(),(0,i.CE)("span",{key:0,class:"label left",textContent:(0,a.v_)(s.range[0])},null,8,o)):(0,i.Q3)("",!0),s.withRange?((0,i.uX)(),(0,i.CE)("span",{key:1,class:"label right",textContent:(0,a.v_)(s.range[1])},null,8,r)):(0,i.Q3)("",!0)],2)):(0,i.Q3)("",!0),(0,i.Lk)("span",d,[(0,i.Lk)("input",{class:(0,a.C4)(["slider",{"with-label":s.withLabel}]),type:"range",min:s.range[0],max:s.range[1],step:s.step,disabled:s.disabled,value:s.value,ref:"range",onInput:t[0]||(t[0]=(0,n.D$)((t=>e.$emit("input",t)),["stop"])),onChange:t[1]||(t[1]=(0,n.D$)((t=>e.$emit("change",t)),["stop"]))},null,42,u),s.withLabel?((0,i.uX)(),(0,i.CE)("span",{key:0,class:"label",textContent:(0,a.v_)(s.value),ref:"label"},null,8,c)):(0,i.Q3)("",!0)])])}var p={emits:["input","change"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:()=>[0,100]},step:{type:Number,default:1},withLabel:{type:Boolean,default:!1},withRange:{type:Boolean,default:!1}}},h=s(6262);const m=(0,h.A)(p,[["render",v],["__scopeId","data-v-d90e850c"]]);var g=m},11:function(e,t,s){s.d(t,{A:function(){return h}});var i=s(641),a=s(33),n=s(3751);const l=e=>((0,i.Qi)("data-v-eff375b6"),e=e(),(0,i.jt)(),e),o=["checked","id"],r=l((()=>(0,i.Lk)("div",{class:"switch"},[(0,i.Lk)("div",{class:"dot"})],-1))),d={class:"label"};function u(e,t,s,l,u,c){return(0,i.uX)(),(0,i.CE)("div",{class:(0,a.C4)(["power-switch",{disabled:s.disabled}]),onClick:t[0]||(t[0]=(0,n.D$)(((...e)=>c.onInput&&c.onInput(...e)),["stop"]))},[(0,i.Lk)("input",{type:"checkbox",checked:s.value,id:s.id},null,8,o),(0,i.Lk)("label",null,[r,(0,i.Lk)("span",d,[(0,i.RG)(e.$slots,"default",{},void 0,!0)])])],2)}var c={name:"ToggleSwitch",emits:["input"],props:{id:{type:String},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput(e){if(this.disabled)return!1;this.$emit("input",e)}}},v=s(6262);const p=(0,v.A)(c,[["render",u],["__scopeId","data-v-eff375b6"]]);var h=p},7630:function(e,t,s){s.r(t),s.d(t,{default:function(){return vs}});var i=s(641),a=s(33);const n={class:"zigbee-container"},l={key:0,class:"info-body"},o={class:"row"},r=(0,i.Lk)("div",{class:"param-name"},"State",-1),d=["textContent"],u={class:"row"},c=(0,i.Lk)("div",{class:"param-name"},"Permit Join",-1),v=["textContent"],p={key:0,class:"row"},h=(0,i.Lk)("div",{class:"param-name"},"Network Channel",-1),m=["textContent"],g={class:"row"},b=(0,i.Lk)("div",{class:"param-name"},"Zigbee2MQTT Version",-1),y=["textContent"],f={key:1,class:"row"},k=(0,i.Lk)("div",{class:"param-name"},"MQTT Server",-1),C=["textContent"],w={key:2,class:"row"},_=(0,i.Lk)("div",{class:"param-name"},"Serial Port",-1),L=["textContent"],x={key:3,class:"row"},E=(0,i.Lk)("div",{class:"param-name"},"Firmware Type",-1),X=["textContent"],q={key:4,class:"row"},I=(0,i.Lk)("div",{class:"param-name"},"Firmware Version",-1),z={class:"param-value"},A={key:5,class:"row"},M=(0,i.Lk)("div",{class:"param-name"},"Firmware Revision",-1),$=["textContent"],D={class:"view-options"},R={class:"view-selector col-s-8 col-m-9 col-l-10"},S=["value"],G=["textContent","selected","value"],Q={class:"buttons"},T=["disabled"],F=(0,i.Lk)("i",{class:"fa fa-plus"},null,-1),O=[F],N=["disabled"],V=(0,i.Lk)("i",{class:"fa fa-sync-alt"},null,-1),j=[V],B={class:"view-container"},Z={key:0,class:"view devices"},U={key:0,class:"no-items"},W={key:0,class:"loading"},H={key:1,class:"empty"},P={key:1,class:"view groups"},Y={key:0,class:"no-items"},K={key:0,class:"loading"},J={key:1,class:"empty"};function ee(e,t,s,F,V,ee){const te=(0,i.g2)("Loading"),se=(0,i.g2)("Modal"),ie=(0,i.g2)("DropdownItem"),ae=(0,i.g2)("Dropdown"),ne=(0,i.g2)("Device"),le=(0,i.g2)("Group");return(0,i.uX)(),(0,i.CE)("div",n,[V.loading?((0,i.uX)(),(0,i.Wv)(te,{key:0})):(0,i.Q3)("",!0),(0,i.bF)(se,{title:"Network Info",ref:"infoModal"},{default:(0,i.k6)((()=>[V.status.info?((0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",o,[r,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.state)},null,8,d)]),(0,i.Lk)("div",u,[c,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.permit_join)},null,8,v)]),V.status.info.network?((0,i.uX)(),(0,i.CE)("div",p,[h,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.network.channel)},null,8,m)])):(0,i.Q3)("",!0),(0,i.Lk)("div",g,[b,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.version)},null,8,y)]),V.status.info.config?.mqtt?((0,i.uX)(),(0,i.CE)("div",f,[k,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.config.mqtt.server)},null,8,C)])):(0,i.Q3)("",!0),V.status.info.config?.serial?((0,i.uX)(),(0,i.CE)("div",w,[_,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.config.serial.port)},null,8,L)])):(0,i.Q3)("",!0),V.status.info.coordinator?.type?((0,i.uX)(),(0,i.CE)("div",x,[E,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.coordinator.type)},null,8,X)])):(0,i.Q3)("",!0),V.status.info.coordinator?.meta?((0,i.uX)(),(0,i.CE)("div",q,[I,(0,i.Lk)("div",z,(0,a.v_)(V.status.info.coordinator.meta.maintrel)+"."+(0,a.v_)(V.status.info.coordinator.meta.majorrel)+"."+(0,a.v_)(V.status.info.coordinator.meta.minorrel),1)])):(0,i.Q3)("",!0),V.status.info.coordinator?.meta?((0,i.uX)(),(0,i.CE)("div",A,[M,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(V.status.info.coordinator.meta.revision)},null,8,$)])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])),_:1},512),(0,i.Lk)("div",D,[(0,i.Lk)("div",R,[(0,i.Lk)("label",null,[(0,i.Lk)("select",{value:V.selected.view,onChange:t[0]||(t[0]=e=>this.selected.view=e.target.value)},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.views,((e,t)=>((0,i.uX)(),(0,i.CE)("option",{textContent:(0,a.v_)((t[0].toUpperCase()+t.slice(1)).replace("_"," ")),key:t,selected:e,value:t},null,8,G)))),128))],40,S)])]),(0,i.Lk)("div",Q,["groups"===V.selected.view?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-default",title:"Add Group",disabled:V.loading,onClick:t[1]||(t[1]=(...e)=>ee.addGroup&&ee.addGroup(...e))},O,8,T)):(0,i.Q3)("",!0),(0,i.bF)(ae,{ref:"networkCommandsDropdown","icon-class":"fa fa-cog",title:"Network commands"},{default:(0,i.k6)((()=>[(0,i.bF)(ie,{text:"Network Info",disabled:V.loading,onInput:t[2]||(t[2]=t=>e.$refs.infoModal.show())},null,8,["disabled"]),V.status.info?.permit_join?((0,i.uX)(),(0,i.Wv)(ie,{key:1,text:"Disable Join",disabled:V.loading,onInput:t[4]||(t[4]=e=>ee.permitJoin(!1))},null,8,["disabled"])):((0,i.uX)(),(0,i.Wv)(ie,{key:0,text:"Permit Join",disabled:V.loading,onInput:t[3]||(t[3]=e=>ee.permitJoin(!0))},null,8,["disabled"])),(0,i.bF)(ie,{text:"Factory Reset",disabled:V.loading,onInput:ee.factoryReset},null,8,["disabled","onInput"])])),_:1},512),(0,i.Lk)("button",{class:"btn btn-default",title:"Refresh network",disabled:V.loading,onClick:t[5]||(t[5]=(...e)=>ee.refresh&&ee.refresh(...e))},j,8,N)])]),(0,i.Lk)("div",B,["devices"===V.selected.view?((0,i.uX)(),(0,i.CE)("div",Z,[Object.keys(V.devices).length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",U,[V.loading?((0,i.uX)(),(0,i.CE)("div",W,"Loading devices...")):((0,i.uX)(),(0,i.CE)("div",H,"No devices found on the network"))])),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.devices,((e,t)=>((0,i.uX)(),(0,i.Wv)(ne,{key:t,device:e,groups:V.groups,selected:V.selected.deviceId===t,onSelect:e=>V.selected.deviceId=V.selected.deviceId===t?null:t,onRename:ee.refreshDevices,onRemove:ee.refreshDevices,onGroupsEdit:ee.refreshGroups},null,8,["device","groups","selected","onSelect","onRename","onRemove","onGroupsEdit"])))),128))])):"groups"===V.selected.view?((0,i.uX)(),(0,i.CE)("div",P,[Object.keys(V.groups).length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Y,[V.loading?((0,i.uX)(),(0,i.CE)("div",K,"Loading groups...")):((0,i.uX)(),(0,i.CE)("div",J,"No groups available on the network"))])),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.groups,((e,t)=>((0,i.uX)(),(0,i.Wv)(le,{key:t,group:e,devices:V.devices,selected:V.selected.groupId===t,onSelect:e=>V.selected.groupId=V.selected.groupId===t?null:t,onRename:ee.refreshGroups,onRemove:ee.refreshGroups,onEdit:ee.refreshGroups},null,8,["group","devices","selected","onSelect","onRename","onRemove","onEdit"])))),128))])):(0,i.Q3)("",!0)])])}var te=s(9265),se=s(9612),ie=s(9828),ae=s(2002),ne=s(3751);const le=e=>((0,i.Qi)("data-v-6437b841"),e=e(),(0,i.jt)(),e),oe={class:"groups"},re=["value","checked"],de=["textContent"],ue=le((()=>(0,i.Lk)("div",{class:"footer buttons"},[(0,i.Lk)("button",{type:"submit"},"Save")],-1))),ce=["textContent"],ve={key:1,class:"params"},pe={class:"row"},he=le((()=>(0,i.Lk)("div",{class:"param-name"},"Name",-1))),me={class:"param-value"},ge=["value"],be={class:"buttons"},ye=le((()=>(0,i.Lk)("i",{class:"fas fa-times"},null,-1))),fe=[ye],ke=le((()=>(0,i.Lk)("button",{type:"submit",class:"btn btn-default"},[(0,i.Lk)("i",{class:"fa fa-check"})],-1))),Ce=["textContent"],we={class:"buttons"},_e=le((()=>(0,i.Lk)("i",{class:"fa fa-edit"},null,-1))),Le=[_e],xe={class:"row"},Ee=le((()=>(0,i.Lk)("div",{class:"param-name"},"IEEE Address",-1))),Xe=["textContent"],qe={key:0,class:"row"},Ie=le((()=>(0,i.Lk)("div",{class:"param-name"},"Network Address",-1))),ze=["textContent"],Ae={class:"row"},Me=le((()=>(0,i.Lk)("div",{class:"param-name"},"Type",-1))),$e=["textContent"],De={key:1,class:"row"},Re=le((()=>(0,i.Lk)("div",{class:"param-name"},"Vendor",-1))),Se={class:"param-value"},Ge={key:2,class:"row"},Qe=le((()=>(0,i.Lk)("div",{class:"param-name"},"Model",-1))),Te={class:"param-value"},Fe={key:3,class:"row"},Oe=le((()=>(0,i.Lk)("div",{class:"param-name"},"Model ID",-1))),Ne={class:"param-value"},Ve={key:4,class:"row"},je=le((()=>(0,i.Lk)("div",{class:"param-name"},"Description",-1))),Be={class:"param-value"},Ze={key:5,class:"row"},Ue=le((()=>(0,i.Lk)("div",{class:"param-name"},"Software Build ID",-1))),We={class:"param-value"},He={key:6,class:"row"},Pe=le((()=>(0,i.Lk)("div",{class:"param-name"},"Date Code",-1))),Ye={class:"param-value"},Ke={key:7,class:"row"},Je=le((()=>(0,i.Lk)("div",{class:"param-name"},"Power Source",-1))),et={class:"param-value"},tt={key:8,class:"section values"},st=le((()=>(0,i.Lk)("div",{class:"header"},[(0,i.Lk)("div",{class:"title"},"Values")],-1))),it={class:"body"},at={class:"param-name"},nt={key:0,class:"text"},lt=["textContent"],ot=["textContent"],rt={class:"param-value"},dt={key:2},ut=["value","disabled","onChange"],ct={key:3},vt=["value","onChange"],pt={key:0},ht=["value","textContent","selected","disabled"],mt={key:4},gt=["onChange","value"],bt={key:5},yt=["disabled","value","onChange"],ft={class:"section actions"},kt=le((()=>(0,i.Lk)("div",{class:"header"},[(0,i.Lk)("div",{class:"title"},"Actions")],-1))),Ct={class:"body"},wt=le((()=>(0,i.Lk)("div",{class:"param-name"},"Manage groups",-1))),_t=le((()=>(0,i.Lk)("div",{class:"param-value"},[(0,i.Lk)("i",{class:"fa fa-network-wired"})],-1))),Lt=[wt,_t],xt={key:0,class:"param-name"},Et={key:1,class:"param-name"},Xt=le((()=>(0,i.Lk)("div",{class:"param-value"},[(0,i.Lk)("i",{class:"fa fa-sync-alt"})],-1))),qt=le((()=>(0,i.Lk)("div",{class:"param-name"},"Remove Device",-1))),It=le((()=>(0,i.Lk)("div",{class:"param-value"},[(0,i.Lk)("i",{class:"fa fa-trash"})],-1))),zt=[qt,It],At=le((()=>(0,i.Lk)("div",{class:"param-name"},"Force Remove Device",-1))),Mt=le((()=>(0,i.Lk)("div",{class:"param-value"},[(0,i.Lk)("i",{class:"fa fa-trash"})],-1))),$t=[At,Mt];function Dt(e,t,s,n,l,o){const r=(0,i.g2)("Loading"),d=(0,i.g2)("Modal"),u=(0,i.g2)("ToggleSwitch"),c=(0,i.g2)("Slider");return(0,i.uX)(),(0,i.CE)("div",{class:(0,a.C4)(["item device",{selected:s.selected}])},[l.loading?((0,i.uX)(),(0,i.Wv)(r,{key:0})):(0,i.Q3)("",!0),(0,i.bF)(d,{class:"groups-modal",ref:"groupsModal",title:"Device groups"},{default:(0,i.k6)((()=>[l.loading?((0,i.uX)(),(0,i.Wv)(r,{key:0})):(0,i.Q3)("",!0),(0,i.Lk)("form",{class:"content",onSubmit:t[0]||(t[0]=(0,ne.D$)(((...e)=>o.manageGroups&&o.manageGroups(...e)),["prevent"]))},[(0,i.Lk)("div",oe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.groups,((e,t)=>((0,i.uX)(),(0,i.CE)("label",{class:"row group",key:t},[(0,i.Lk)("input",{type:"checkbox",value:t,checked:o.associatedGroups.has(parseInt(e.id))},null,8,re),(0,i.Lk)("span",{class:"name",textContent:(0,a.v_)(e.friendly_name?.length?e.friendly_name:`[Group #${e.id}]`)},null,8,de)])))),128))]),ue],32)])),_:1},512),(0,i.Lk)("div",{class:(0,a.C4)(["row name header vertical-center",{selected:s.selected}]),textContent:(0,a.v_)(s.device.friendly_name||s.device.ieee_address),onClick:t[1]||(t[1]=t=>e.$emit("select"))},null,10,ce),s.selected?((0,i.uX)(),(0,i.CE)("div",ve,[(0,i.Lk)("div",pe,[he,(0,i.Lk)("div",me,[(0,i.Lk)("div",{class:(0,a.C4)(["name-edit",{hidden:!l.editName}])},[(0,i.Lk)("form",{onSubmit:t[3]||(t[3]=(0,ne.D$)(((...e)=>o.rename&&o.rename(...e)),["prevent"]))},[(0,i.Lk)("label",null,[(0,i.Lk)("input",{type:"text",name:"name",ref:"name",value:s.device.friendly_name},null,8,ge)]),(0,i.Lk)("span",be,[(0,i.Lk)("button",{type:"button",class:"btn btn-default",onClick:t[2]||(t[2]=e=>l.editName=!1)},fe),ke])],32)],2),(0,i.Lk)("div",{class:(0,a.C4)(["name-edit",{hidden:l.editName}])},[(0,i.Lk)("span",{textContent:(0,a.v_)(s.device.friendly_name)},null,8,Ce),(0,i.Lk)("span",we,[(0,i.Lk)("button",{type:"button",class:"btn btn-default",onClick:t[4]||(t[4]=e=>l.editName=!0)},Le)])],2)])]),(0,i.Lk)("div",xe,[Ee,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(s.device.ieee_address)},null,8,Xe)]),s.device.network_address?((0,i.uX)(),(0,i.CE)("div",qe,[Ie,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(s.device.network_address)},null,8,ze)])):(0,i.Q3)("",!0),(0,i.Lk)("div",Ae,[Me,(0,i.Lk)("div",{class:"param-value",textContent:(0,a.v_)(s.device.type)},null,8,$e)]),s.device.definition?.vendor?((0,i.uX)(),(0,i.CE)("div",De,[Re,(0,i.Lk)("div",Se,(0,a.v_)(s.device.definition.vendor),1)])):(0,i.Q3)("",!0),s.device.definition?.model?((0,i.uX)(),(0,i.CE)("div",Ge,[Qe,(0,i.Lk)("div",Te,(0,a.v_)(s.device.definition.model),1)])):(0,i.Q3)("",!0),s.device.model_id?((0,i.uX)(),(0,i.CE)("div",Fe,[Oe,(0,i.Lk)("div",Ne,(0,a.v_)(s.device.model_id),1)])):(0,i.Q3)("",!0),s.device.definition?.description?((0,i.uX)(),(0,i.CE)("div",Ve,[je,(0,i.Lk)("div",Be,(0,a.v_)(s.device.definition.description),1)])):(0,i.Q3)("",!0),s.device.software_build_id?((0,i.uX)(),(0,i.CE)("div",Ze,[Ue,(0,i.Lk)("div",We,(0,a.v_)(s.device.software_build_id),1)])):(0,i.Q3)("",!0),s.device.definition?.date_code?((0,i.uX)(),(0,i.CE)("div",He,[Pe,(0,i.Lk)("div",Ye,(0,a.v_)(s.device.definition.date_code),1)])):(0,i.Q3)("",!0),s.device.power_source?((0,i.uX)(),(0,i.CE)("div",Ke,[Je,(0,i.Lk)("div",et,(0,a.v_)(s.device.power_source),1)])):(0,i.Q3)("",!0),Object.keys(o.displayedValues).length?((0,i.uX)(),(0,i.CE)("div",tt,[st,(0,i.Lk)("div",it,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.displayedValues,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"row value",key:t},[(0,i.Lk)("div",at,[(0,i.eW)((0,a.v_)(e.description)+" ",1),null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,i.uX)(),(0,i.CE)("span",nt,"Color")):(0,i.Q3)("",!0),e.property?((0,i.uX)(),(0,i.CE)("span",{key:1,class:"name",textContent:(0,a.v_)(e.property)},null,8,lt)):(0,i.Q3)("",!0),e.unit?((0,i.uX)(),(0,i.CE)("span",{key:2,class:"unit",textContent:(0,a.v_)(e.unit)},null,8,ot)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",rt,["binary"===e.type?((0,i.uX)(),(0,i.Wv)(u,{key:0,value:null!=e.value_on?e.value===e.value_on:!!e.value,disabled:!e.writable,onInput:t=>o.setValue(e,t)},null,8,["value","disabled","onInput"])):"numeric"===e.type&&null!=e.value_min&&null!=e.value_max?((0,i.uX)(),(0,i.Wv)(c,{key:1,"with-label":!0,range:[e.value_min,e.value_max],value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,8,["range","value","disabled","onChange"])):"numeric"!==e.type||null!=e.value_min&&null!=e.value_max?"enum"===e.type?((0,i.uX)(),(0,i.CE)("label",ct,[(0,i.Lk)("select",{value:e.readable&&null!=e.value?e.value:"",onChange:t=>o.setValue(e,t)},[e.readable?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("option",pt)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.values,(t=>((0,i.uX)(),(0,i.CE)("option",{key:t,value:t,textContent:(0,a.v_)(t),selected:e.readable&&e.value===t,disabled:!e.writable},null,8,ht)))),128))],40,vt)])):null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,i.uX)(),(0,i.CE)("label",mt,[(0,i.Lk)("input",{type:"color",onChange:(0,ne.D$)((t=>o.setValue(e,t)),["stop"]),value:"#"+o.rgbColor.map((e=>(e=Number(e).toString(16),1===e.length?"0"+e:e))).join("")},null,40,gt)])):((0,i.uX)(),(0,i.CE)("label",bt,[(0,i.Lk)("input",{type:"text",disabled:!e.writable,value:e.value,onChange:t=>o.setValue(e,t)},null,40,yt)])):((0,i.uX)(),(0,i.CE)("label",dt,[(0,i.Lk)("input",{type:"number","with-label":!0,value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,40,ut)]))])])))),128))])])):(0,i.Q3)("",!0),(0,i.Lk)("div",ft,[kt,(0,i.Lk)("div",Ct,[(0,i.Lk)("div",{class:"row",onClick:t[5]||(t[5]=t=>e.$refs.groupsModal.show())},Lt),(0,i.Lk)("div",{class:"row",onClick:t[6]||(t[6]=e=>l.otaUpdatesAvailable?o.installOtaUpdates():o.checkOtaUpdates())},[l.otaUpdatesAvailable?((0,i.uX)(),(0,i.CE)("div",Et,"Install updates")):((0,i.uX)(),(0,i.CE)("div",xt,"Check for updates")),Xt]),(0,i.Lk)("div",{class:"row",onClick:t[7]||(t[7]=e=>o.remove(!1))},zt),(0,i.Lk)("div",{class:"row error",onClick:t[8]||(t[8]=e=>o.remove(!0))},$t)])])])):(0,i.Q3)("",!0)],2)}var Rt=s(1808),St=s(11),Gt=s(9002),Qt=s(9513),Tt={name:"Device",components:{Modal:Qt.A,ToggleSwitch:St.A,Slider:Rt.A,Loading:ie.A},mixins:[ae.A],emits:["select","rename","remove","groups-edit"],props:{device:{type:Object,required:!0},groups:{type:Object,default:()=>{}},selected:{type:Boolean,default:!1}},data(){return{editName:!1,loading:!1,status:{},otaUpdatesAvailable:!1}},computed:{values(){if(!this.device.definition?.exposes)return{};const e=e=>{const t=(e,s)=>{if(e.features){e.property&&(s[e.property]=s[e.property]||{},s=s[e.property]);for(const i of e.features)t(i,s)}else e.property&&(s[e.property]=e)},s={};for(const i of e)t(i,s);return s};return e(this.device.definition.exposes)},displayedValues(){const e={},t=(e,[s,i])=>(s in this.status&&(i={...i,value:this.status[s]}),null!=i.access&&(i.readable=!!(1&i.access),i.writable=!!(2&i.access),delete i.access),e[s]=i,Object.entries(i).filter((e=>e[1]instanceof Object)).reduce(t,e[s]),e);return Object.entries(this.values).reduce(t,e),e},rgbColor(){if(!this.displayedValues.color)return;const e=this.displayedValues.color?.value;if(e){if(null!=e.x&&null!=e.y){const t=new Gt.o({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return t.xyToRgb(e.x,e.y,this.displayedValues.brightness.value)}if(null!=e.hue&&(null!=e.saturation||null!=e.sat)){const t=null!=e.saturation?"saturation":"sat",s=new Gt.o({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[t]?.value_min||0,this.displayedValues.color[t].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return s.hslToRgb(e.hue,e[t],this.displayedValues.brightness.value)}return null}},associatedGroups(){return new Set(Object.values(this.groups).filter((e=>new Set((e.members||[]).map((e=>e.ieee_address))).has(this.device.ieee_address))).map((e=>parseInt(e.id))))}},methods:{async refresh(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.device_get",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}},async rename(){const e=(this.$refs.name.value||"").trim();if(e.length&&e!==this.device.friendly_name){this.loading=!0;try{await this.request("zigbee.mqtt.device_rename",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,name:e}),this.$emit("rename",{name:this.device.friendly_name,newName:e})}finally{this.editName=!1,this.loading=!1}}},async remove(e){if(confirm("Are you really sure that you want to remove this device from the network?")){e=!!e,this.loading=!0;try{await this.request("zigbee.mqtt.device_remove",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,force:e}),this.$emit("remove",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}}},async setValue(e,t){const s={device:this.device.friendly_name||this.device.ieee_address,property:e.property,value:null};switch(e.type){case"binary":e.value_toggle?s.value=e.value_toggle:e.value_on&&e.value_off?s.value=e.value===e.value_on?e.value_off:e.value_on:s.value=!e.value;break;case"numeric":s.value=parseFloat(t.target.value);break;case"enum":t.target.value?.length&&(s.value=t.target.value);break;default:if(null!=e.x&&null!=e.y||null!=e.hue&&(null!=e.saturation||null!=e.sat)){s.property="color";const i=t.target.value.slice(1).split(/([0-9a-fA-F]{2})/).filter(((e,t)=>t%2)).map((e=>parseInt(e,16)));if(null!=e.x&&null!=e.y){const e=new Gt.o({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),t=e.rgbToXY(...i);s.value={x:t[0],y:t[1]}}else{const e=null!=this.displayedValues.color.saturation?"saturation":"sat",t=new Gt.o({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[e]?.value_min||0,this.displayedValues.color[e].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),a=t.rgbToHsl(...i);s.value={hue:a[0]},s.value[e]=a[1]}}break}if(null!=s.value){this.loading=!0;try{await this.request("zigbee.mqtt.device_set",s),await this.refresh()}finally{this.loading=!1}}},async manageGroups(e){const t=[...e.target.querySelectorAll("input[type=checkbox]")].reduce(((e,t)=>{const s=parseInt(t.value);return t.checked&&!this.associatedGroups.has(s)?e.add.add(s):!t.checked&&this.associatedGroups.has(s)&&e.remove.add(s),e}),{add:new Set,remove:new Set}),s=async e=>{await Promise.all([...t[e]].map((async t=>{await this.request(`zigbee.mqtt.group_${e}_device`,{group:this.groups[t].friendly_name,device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})})))};this.loading=!0;try{await Promise.all(Object.keys(t).map(s)),this.$emit("groups-edit",t)}finally{this.loading=!1}},async checkOtaUpdates(){this.loading=!0;try{this.otaUpdatesAvailable=(await this.request("zigbee.mqtt.device_check_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})).update_available,this.otaUpdatesAvailable?this.notify({text:"A firmware update is available for the device",image:{iconClass:"fa fa-sync-alt"}}):this.notify({text:"The device is up to date",image:{iconClass:"fa fa-check"}})}finally{this.loading=!1}},async installOtaUpdates(){this.loading=!0;try{await this.request("zigbee.mqtt.device_install_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})}finally{this.loading=!1}}},mounted(){this.$watch((()=>this.selected),(e=>{e&&this.refresh()})),this.$watch((()=>this.status.update_available),(e=>{this.otaUpdatesAvailable=e})),this.subscribe((e=>{e.device!==this.device.friendly_name&&e.device!==this.device.ieee_address||(this.status={...this.status,...e.properties})}),`on-property-change-${this.device.ieee_address}`,"platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePropertySetEvent")},unmounted(){this.unsubscribe(`on-property-change-${this.device.ieee_address}`)}},Ft=s(6262);const Ot=(0,Ft.A)(Tt,[["render",Dt],["__scopeId","data-v-6437b841"]]);var Nt=Ot;const Vt=e=>((0,i.Qi)("data-v-7667f7ba"),e=e(),(0,i.jt)(),e),jt=["textContent"],Bt={key:1,class:"params"},Zt={class:"section devices"},Ut=Vt((()=>(0,i.Lk)("div",{class:"header"},[(0,i.Lk)("div",{class:"title"},"Devices")],-1))),Wt={class:"body"},Ht=["checked","value","onChange"],Pt=["textContent"],Yt={class:"section actions"},Kt=Vt((()=>(0,i.Lk)("div",{class:"header"},[(0,i.Lk)("div",{class:"title"},"Actions")],-1))),Jt={class:"body"},es=Vt((()=>(0,i.Lk)("div",{class:"col-10"},"Rename Group",-1))),ts=Vt((()=>(0,i.Lk)("div",{class:"buttons col-2 pull-right"},[(0,i.Lk)("i",{class:"fa fa-edit"})],-1))),ss=[es,ts],is=Vt((()=>(0,i.Lk)("div",{class:"col-10"},"Remove Group",-1))),as=Vt((()=>(0,i.Lk)("div",{class:"buttons col-2 pull-right"},[(0,i.Lk)("i",{class:"fa fa-trash"})],-1))),ns=[is,as];function ls(e,t,s,n,l,o){const r=(0,i.g2)("Loading");return(0,i.uX)(),(0,i.CE)("div",{class:(0,a.C4)(["item group",{selected:s.selected}])},[l.loading?((0,i.uX)(),(0,i.Wv)(r,{key:0})):(0,i.Q3)("",!0),(0,i.Lk)("div",{class:(0,a.C4)(["row name header vertical-center",{selected:s.selected}]),textContent:(0,a.v_)(s.group.friendly_name),onClick:t[0]||(t[0]=t=>e.$emit("select"))},null,10,jt),s.selected?((0,i.uX)(),(0,i.CE)("div",Bt,[(0,i.Lk)("div",Zt,[Ut,(0,i.Lk)("div",Wt,[(0,i.Lk)("form",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.devices,((e,t)=>((0,i.uX)(),(0,i.CE)("label",{class:"row",key:t},[(0,i.Lk)("input",{type:"checkbox",checked:o.members.has(e.ieee_address),value:e.ieee_address,onChange:t=>o.toggleDevice(e.ieee_address)},null,40,Ht),(0,i.Lk)("span",{class:"label",textContent:(0,a.v_)(e.friendly_name?.length?e.friendly_name:e.ieee_address)},null,8,Pt)])))),128))])])]),(0,i.Lk)("div",Yt,[Kt,(0,i.Lk)("div",Jt,[(0,i.Lk)("div",{class:"row",onClick:t[1]||(t[1]=(...e)=>o.rename&&o.rename(...e))},ss),(0,i.Lk)("div",{class:"row",onClick:t[2]||(t[2]=(...e)=>o.remove&&o.remove(...e))},ns)])])])):(0,i.Q3)("",!0)],2)}var os={name:"Group",emits:["select","remove","edit"],mixins:[ae.A],components:{Loading:ie.A},props:{group:{type:Object,required:!0},devices:{type:Object,default:()=>({})},selected:{type:Boolean,default:!1}},data(){return{loading:!1,values:{}}},computed:{devicesByAddress(){return Object.entries(this.devices).reduce(((e,t)=>{const s=t[1];return e[s.ieee_address]=s,e}),{})},members(){return new Set((this.group.members||[]).map((e=>e.ieee_address)))}},methods:{async remove(){if(confirm("Are you sure that you want to remove this group?")){this.loading=!0;try{await this.request("zigbee.mqtt.group_remove",{name:this.group.friendly_name}),this.$emit("remove",{name:this.group.friendly_name})}finally{this.loading=!1}}},async rename(){let e=prompt("New group name",this.group.friendly_name);if(e?.length){e=e.trim(),this.loading=!0;try{await this.request("zigbee.mqtt.group_rename",{group:this.group.friendly_name||this.group.id,name:e}),this.$emit("rename",{name:this.group.friendly_name,newName:e})}finally{this.loading=!1}}},async toggleDevice(e){const t=this.devicesByAddress[e],s=t.friendly_name?.length?t.friendly_name:e,i=this.members.has(e)?"remove":"add";this.loading=!0;try{await this.request(`zigbee.mqtt.group_${i}_device`,{group:this.group.friendly_name,device:s}),this.$emit("edit",{device:s,method:i})}finally{this.loading=!1}}}};const rs=(0,Ft.A)(os,[["render",ls],["__scopeId","data-v-7667f7ba"]]);var ds=rs,us={name:"ZigbeeMqtt",components:{Modal:Qt.A,Dropdown:te.A,DropdownItem:se.A,Loading:ie.A,Device:Nt,Group:ds},mixins:[ae.A],data(){return{devices:{},groups:{},status:{},loading:!1,selected:{view:"devices",deviceId:void 0,groupId:void 0},views:{devices:!0,groups:!0},modal:{group:{visible:!1}}}},methods:{async refreshDevices(){this.loading=!0;try{this.devices=(await this.request("zigbee.mqtt.devices")).reduce(((e,t)=>(t.friendly_name in this.devices&&(t={values:this.devices[t.friendly_name].values||{},...this.devices[t.friendly_name]}),e[t.friendly_name]=t,e)),{})}finally{this.loading=!1}},async refreshGroups(){this.loading=!0;try{this.groups=(await this.request("zigbee.mqtt.groups")).reduce(((e,t)=>(e[t.id]=t,e)),{})}finally{this.loading=!1}},async refreshInfo(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.info")}finally{this.loading=!1}},refresh(){this.refreshDevices(),this.refreshGroups(),this.refreshInfo()},updateProperties(e,t){this.devices[e].values=t},async addGroup(){const e=prompt("Group name");if(e&&e.length){this.loading=!0;try{await this.request("zigbee.mqtt.group_add",{name:e})}finally{this.loading=!1}await this.refreshGroups()}},async permitJoin(e){const t={permit:!!e};if(e){let e=prompt("Join allow period in seconds (0 or empty for no time limits)","60");t.seconds=e.length?parseInt(e):null}this.loading=!0;try{await this.request("zigbee.mqtt.permit_join",t),setTimeout(this.refreshInfo,1e3)}finally{this.loading=!1}},async factoryReset(){if(confirm("Are you SURE that you want to do a device factory reset?")||confirm("Are you REALLY sure? ALL network information and custom firmware will be lost!!")){this.loading=!0;try{await this.request("zigbee.mqtt.factory_reset")}finally{this.loading=!1}}},async addToGroup(e,t){this.loading=!0,await this.request("zigbee.mqtt.group_add_device",{device:e,group:t}),this.loading=!1;const s=this;setTimeout((()=>{s.refresh(),s.refreshGroups()}),100)}},created(){this.subscribe((()=>{this.notify({text:"WARNING: The controller is offline",error:!0})}),"on-zigbee-offline","platypush.message.event.zigbee.mqtt.ZigbeeMqttOfflineEvent"),this.subscribe((()=>{this.notify({text:"The controller is now online",iconClass:"fas fa-check"})}),"on-zigbee-online","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the device",error:!0})}),"on-zigbee-device-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to add the group",error:!0})}),"on-zigbee-group-add-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove group",error:!0})}),"on-zigbee-group-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the devices from group",error:!0})}),"on-zigbee-remove-all-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllFailedEvent"),this.subscribe((e=>{this.notify({text:e.error||"[Unknown error]",error:!0})}),"on-zigbee-error","platypush.message.event.zigbee.mqtt.ZigbeeMqttErrorEvent"),this.subscribe(this.refresh,"on-zigbee-device-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePairingEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceConnectedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBannedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceWhitelistedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRenamedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBindEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceUnbindEvent"),this.subscribe(this.refreshGroups,"on-zigbee-group-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllEvent")},mounted(){this.refresh()},unmounted(){this.unsubscribe("on-zigbee-error"),this.unsubscribe("on-zigbee-remove-all-failed"),this.unsubscribe("on-zigbee-group-remove-failed"),this.unsubscribe("on-zigbee-group-add-failed"),this.unsubscribe("on-zigbee-device-remove-failed"),this.unsubscribe("on-zigbee-online"),this.unsubscribe("on-zigbee-offline"),this.unsubscribe("on-zigbee-device-update"),this.unsubscribe("on-zigbee-group-update")}};const cs=(0,Ft.A)(us,[["render",ee]]);var vs=cs}}]);
//# sourceMappingURL=7630.7a2ac332.js.map
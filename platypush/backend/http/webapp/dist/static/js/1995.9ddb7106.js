"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[1995],{226:function(e,t,s){s.d(t,{A:function(){return n}});s(4114);var a=s(2002),l={name:"Utils",mixins:[a.A],computed:{audioExtensions(){return new Set(["3gp","aa","aac","aax","act","aiff","amr","ape","au","awb","dct","dss","dvf","flac","gsm","iklax","ivs","m4a","m4b","m4p","mmf","mp3","mpc","msv","nmf","nsf","ogg,","opus","ra,","raw","sln","tta","vox","wav","wma","wv","webm","8svx"])},videoExtensions(){return new Set(["webm","mkv","flv","flv","vob","ogv","ogg","drc","gif","gifv","mng","avi","mts","m2ts","mov","qt","wmv","yuv","rm","rmvb","asf","amv","mp4","m4p","m4v","mpg","mp2","mpeg","mpe","mpv","mpg","mpeg","m2v","m4v","svi","3gp","3g2","mxf","roq","nsv","flv","f4v","f4p","f4a","f4b"])},mediaExtensions(){return new Set([...this.videoExtensions,...this.audioExtensions])}},methods:{convertTime(e){e=parseFloat(e);const t={};t.h=""+parseInt(e/3600),t.m=""+parseInt(e/60-60*t.h),t.s=""+parseInt(e-(3600*t.h+60*t.m));for(const a of["m","s"])parseInt(t[a])<10&&(t[a]="0"+t[a]);const s=[];return parseInt(t.h)&&s.push(t.h),s.push(t.m,t.s),s.join(":")},async startStreaming(e,t,s=!1){let a=e,l=null;e instanceof Object?(a=e.url,l=e.subtitles):e={url:a};const i=await this.request(`${t}.start_streaming`,{media:a,subtitles:l,download:s});return{...e,...i}},async stopStreaming(e,t){await this.request(`${t}.stop_streaming`,{media_id:e})}}};const i=l;var n=i},1995:function(e,t,s){s.r(t),s.d(t,{default:function(){return Jt}});var a=s(641),l=s(33),i=s(3751);const n={key:0,class:"nav-container mobile"},o={class:"nav-container from tablet"},c={class:"view-container"},r={class:"track-info-container"},d={key:0,class:"track-info-content"},u={key:0,class:"row file"},h=["textContent"],p={key:1,class:"row artist"},k={class:"col-9 value"},v=["href","textContent"],y={key:2,class:"row track-title"},m=["textContent"],f={key:3,class:"row album"},g={class:"col-9 value"},b=["href","textContent"],C={key:4,class:"row date"},w=["textContent"],L={key:5,class:"row duration"},T=["textContent"],$={key:6,class:"row track"},x=["textContent"],P={key:7,class:"row disc"},I=["textContent"],E={key:8,class:"row url"},A={class:"col-9 value"},S=["href","textContent"],X={class:"playlists-modal-container"},D={class:"filter"},_={class:"playlists"},F=["checked","onChange"],R=["textContent"];function V(e,t,s,V,M,Q){const N=(0,a.g2)("Loading"),O=(0,a.g2)("Nav"),B=(0,a.g2)("Playlist"),q=(0,a.g2)("Playlists"),W=(0,a.g2)("Search"),j=(0,a.g2)("Library"),K=(0,a.g2)("MediaView"),U=(0,a.g2)("Modal"),H=(0,a.g2)("FormFooter");return(0,a.uX)(),(0,a.CE)(a.FK,null,[s.loading?((0,a.uX)(),(0,a.Wv)(N,{key:0})):((0,a.uX)(),(0,a.Wv)(K,{key:1,"plugin-name":s.pluginName,image:s.images[s.track?.uri||s.track?.file],status:s.status,track:s.track,onNext:t[34]||(t[34]=t=>e.$emit("next")),onPause:t[35]||(t[35]=t=>e.$emit("pause")),onPlay:t[36]||(t[36]=t=>e.$emit("play",t)),onPrevious:t[37]||(t[37]=t=>e.$emit("previous")),onRandom:t[38]||(t[38]=t=>e.$emit("random",t)),onRepeat:t[39]||(t[39]=t=>e.$emit("repeat",t)),onSearch:Q.search,onSeek:t[40]||(t[40]=t=>e.$emit("seek",t)),onConsume:t[41]||(t[41]=t=>e.$emit("consume",t)),onSetVolume:t[42]||(t[42]=t=>e.$emit("set-volume",t)),onStop:t[43]||(t[43]=t=>e.$emit("stop"))},{default:(0,a.k6)((()=>[(0,a.Lk)("main",null,[M.navVisible?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(O,{"selected-view":M.selectedView,onInput:t[0]||(t[0]=e=>M.selectedView=e),onToggle:t[1]||(t[1]=e=>M.navVisible=!M.navVisible)},null,8,["selected-view"])])):(0,a.Q3)("",!0),(0,a.Lk)("div",o,[(0,a.bF)(O,{"selected-view":M.selectedView,onInput:t[2]||(t[2]=e=>M.selectedView=e),onToggle:t[3]||(t[3]=e=>M.navVisible=!M.navVisible)},null,8,["selected-view"])]),(0,a.Lk)("div",c,["playing"===M.selectedView?((0,a.uX)(),(0,a.Wv)(B,{key:0,tracks:s.tracks,status:s.status,loading:s.loading,devices:s.devices,"selected-device":s.selectedDevice,"active-device":s.activeDevice,"show-nav-button":!M.navVisible,"with-clear":!0,"with-save":!0,"with-swap":!0,onPlay:t[4]||(t[4]=t=>e.$emit("play",t)),onClear:t[5]||(t[5]=t=>e.$emit("clear")),onSwap:t[6]||(t[6]=t=>e.$emit("swap-tracks",t)),onAdd:t[7]||(t[7]=t=>e.$emit("add-to-tracklist",t)),onRemove:t[8]||(t[8]=t=>e.$emit("remove-from-tracklist",t)),onMove:t[9]||(t[9]=t=>e.$emit("tracklist-move",t)),onSave:t[10]||(t[10]=t=>e.$emit("tracklist-save",t)),onInfo:t[11]||(t[11]=t=>e.$emit("info",t)),onAddToPlaylist:Q.openAddToPlaylist,onSearch:Q.search,onToggleNav:t[12]||(t[12]=e=>M.navVisible=!M.navVisible),onRefreshStatus:Q.refreshStatus,onSelectDevice:Q.selectDevice},null,8,["tracks","status","loading","devices","selected-device","active-device","show-nav-button","onAddToPlaylist","onSearch","onRefreshStatus","onSelectDevice"])):"playlists"===M.selectedView?((0,a.uX)(),(0,a.Wv)(q,{key:1,playlists:s.playlists,loading:s.loading,devices:s.devices,status:s.status,"selected-device":s.selectedDevice,"active-device":s.activeDevice,"edited-playlist":s.editedPlaylist,tracks:s.editedPlaylistTracks,"show-nav-button":!M.navVisible,onPlay:t[13]||(t[13]=t=>e.$emit("play-playlist",t)),onLoad:t[14]||(t[14]=t=>e.$emit("load-playlist",t)),onRemove:t[15]||(t[15]=t=>e.$emit("remove-playlist",t)),onPlaylistEdit:t[16]||(t[16]=t=>e.$emit("playlist-edit",t)),onLoadTracks:t[17]||(t[17]=t=>e.$emit("add-to-tracklist-from-edited-playlist",t)),onRemoveTrack:t[18]||(t[18]=t=>e.$emit("remove-from-playlist",t)),onInfo:t[19]||(t[19]=t=>e.$emit("info",t)),onPlaylistAdd:t[20]||(t[20]=t=>e.$emit("playlist-add",t)),onAddToPlaylist:Q.openAddToPlaylist,onTrackMove:t[21]||(t[21]=t=>e.$emit("playlist-track-move",t)),onSearch:Q.search,onToggleNav:t[22]||(t[22]=e=>M.navVisible=!M.navVisible),onRefreshStatus:Q.refreshStatus,onSelectDevice:Q.selectDevice},null,8,["playlists","loading","devices","status","selected-device","active-device","edited-playlist","tracks","show-nav-button","onAddToPlaylist","onSearch","onRefreshStatus","onSelectDevice"])):"search"===M.selectedView?((0,a.uX)(),(0,a.Wv)(W,{key:2,loading:s.loading,results:s.searchResults,devices:s.devices,"selected-device":s.selectedDevice,"active-device":s.activeDevice,"show-nav-button":!M.navVisible,onSearch:Q.search,onClear:t[23]||(t[23]=t=>e.$emit("search-clear")),onInfo:t[24]||(t[24]=t=>e.$emit("info",t)),onPlay:t[25]||(t[25]=t=>e.$emit("play",t)),onLoad:t[26]||(t[26]=t=>e.$emit("add-to-tracklist",t)),onAddToPlaylist:Q.openAddToPlaylist,onRefreshStatus:Q.refreshStatus,onToggleNav:t[27]||(t[27]=e=>M.navVisible=!M.navVisible),onSelectDevice:Q.selectDevice},null,8,["loading","results","devices","selected-device","active-device","show-nav-button","onSearch","onAddToPlaylist","onRefreshStatus","onSelectDevice"])):"library"===M.selectedView?((0,a.uX)(),(0,a.Wv)(j,{key:3,loading:s.loading,results:s.libraryResults,path:s.path,devices:s.devices,"selected-device":s.selectedDevice,"active-device":s.activeDevice,"show-nav-button":!M.navVisible,onSearch:Q.search,onClear:t[28]||(t[28]=t=>e.$emit("search-clear")),onInfo:t[29]||(t[29]=t=>e.$emit("info",t)),onPlay:t[30]||(t[30]=t=>e.$emit("play",t)),onLoad:t[31]||(t[31]=t=>e.$emit("add-to-tracklist",t)),onAddToPlaylist:Q.openAddToPlaylist,onCd:t[32]||(t[32]=t=>e.$emit("cd",t)),onToggleNav:t[33]||(t[33]=e=>M.navVisible=!M.navVisible),onRefreshStatus:Q.refreshStatus,onSelectDevice:Q.selectDevice},null,8,["loading","results","path","devices","selected-device","active-device","show-nav-button","onSearch","onAddToPlaylist","onRefreshStatus","onSelectDevice"])):(0,a.Q3)("",!0)])])])),_:1},8,["plugin-name","image","status","track","onSearch"])),(0,a.Lk)("div",r,[(0,a.bF)(U,{title:"Track info",ref:"trackInfo"},{default:(0,a.k6)((()=>[s.trackInfo?((0,a.uX)(),(0,a.CE)("div",d,[s.trackInfo.file?((0,a.uX)(),(0,a.CE)("div",u,[t[50]||(t[50]=(0,a.Lk)("div",{class:"col-3 attr"},"File",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(s.trackInfo.file)},null,8,h)])):(0,a.Q3)("",!0),s.trackInfo.artist?((0,a.uX)(),(0,a.CE)("div",p,[t[51]||(t[51]=(0,a.Lk)("div",{class:"col-3 attr"},"Artist",-1)),(0,a.Lk)("div",k,[(0,a.Lk)("a",{href:e.$route.fullPath,textContent:(0,l.v_)(s.trackInfo.artist),onClick:t[44]||(t[44]=(0,i.D$)((e=>Q.search({artist:s.trackInfo.artist})),["prevent"]))},null,8,v)])])):(0,a.Q3)("",!0),s.trackInfo.title?((0,a.uX)(),(0,a.CE)("div",y,[t[52]||(t[52]=(0,a.Lk)("div",{class:"col-3 attr"},"Title",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(s.trackInfo.title)},null,8,m)])):(0,a.Q3)("",!0),s.trackInfo.album?((0,a.uX)(),(0,a.CE)("div",f,[t[53]||(t[53]=(0,a.Lk)("div",{class:"col-3 attr"},"Album",-1)),(0,a.Lk)("div",g,[(0,a.Lk)("a",{href:e.$route.fullPath,textContent:(0,l.v_)(s.trackInfo.album),onClick:t[45]||(t[45]=(0,i.D$)((e=>Q.search({artist:s.trackInfo.artist,album:s.trackInfo.album})),["prevent"]))},null,8,b)])])):(0,a.Q3)("",!0),s.trackInfo.date?((0,a.uX)(),(0,a.CE)("div",C,[t[54]||(t[54]=(0,a.Lk)("div",{class:"col-3 attr"},"Date",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(s.trackInfo.date)},null,8,w)])):(0,a.Q3)("",!0),s.trackInfo.time?((0,a.uX)(),(0,a.CE)("div",L,[t[55]||(t[55]=(0,a.Lk)("div",{class:"col-3 attr"},"Duration",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(e.convertTime(s.trackInfo.time))},null,8,T)])):(0,a.Q3)("",!0),s.trackInfo.track?((0,a.uX)(),(0,a.CE)("div",$,[t[56]||(t[56]=(0,a.Lk)("div",{class:"col-3 attr"},"Track",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(s.trackInfo.track)},null,8,x)])):(0,a.Q3)("",!0),s.trackInfo.disc?((0,a.uX)(),(0,a.CE)("div",P,[t[57]||(t[57]=(0,a.Lk)("div",{class:"col-3 attr"},"Disc",-1)),(0,a.Lk)("div",{class:"col-9 value",textContent:(0,l.v_)(s.trackInfo.disc)},null,8,I)])):(0,a.Q3)("",!0),s.trackInfo.url?((0,a.uX)(),(0,a.CE)("div",E,[t[58]||(t[58]=(0,a.Lk)("div",{class:"col-3 attr"},"URL",-1)),(0,a.Lk)("div",A,[(0,a.Lk)("a",{href:s.trackInfo.url,textContent:(0,l.v_)(s.trackInfo.uri||s.trackInfo.url),target:"_blank"},null,8,S)])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])),_:1},512)]),(0,a.Lk)("div",X,[(0,a.bF)(U,{title:"Playlists",ref:"playlistsModal",onClose:t[48]||(t[48]=e=>M.addToPlaylistTrack=null),onOpen:t[49]||(t[49]=e=>M.selectedPlaylists=[...Array(s.playlists.length).keys()].map((()=>!1)))},{default:(0,a.k6)((()=>[(0,a.Lk)("div",D,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"search",placeholder:"Filter","onUpdate:modelValue":t[46]||(t[46]=e=>M.playlistFilter=e)},null,512),[[i.Jo,M.playlistFilter]])])]),(0,a.Lk)("div",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.playlists,((e,t)=>((0,a.uX)(),(0,a.CE)("label",{class:(0,l.C4)(["row playlist",{hidden:M.playlistFilter?.length>0&&e.name.toLowerCase().indexOf(M.playlistFilter.toLowerCase())<0}]),key:t},[(0,a.Lk)("input",{type:"checkbox",checked:M.selectedPlaylists[t],onChange:e=>M.selectedPlaylists[t]=e.target.checked},null,40,F),(0,a.Lk)("span",{class:"name",textContent:(0,l.v_)(e.name)},null,8,R)],2)))),128))]),(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.Lk)("button",{onClick:t[47]||(t[47]=(...e)=>Q.addToPlaylist&&Q.addToPlaylist(...e))},t[59]||(t[59]=[(0,a.Lk)("i",{class:"fa fa-plus"},null,-1),(0,a.eW)(" Â  Add ")]))])),_:1})])),_:1},512)])],64)}const M={class:"form-footer"};function Q(e,t,s,l,i,n){return(0,a.uX)(),(0,a.CE)("div",M,[(0,a.RG)(e.$slots,"default",{},void 0,!0)])}var N={name:"FormFooter"},O=s(6262);const B=(0,O.A)(N,[["render",Q],["__scopeId","data-v-2495ce8a"]]);var q=B,W=s(9828),j=s(9513),K=s(226),U=s(8654);const H=["title","onClick"];function J(e,t,s,i,n,o){return(0,a.uX)(),(0,a.CE)("nav",null,[(0,a.Lk)("button",{class:"menu-button mobile",onClick:t[0]||(t[0]=t=>e.$emit("toggle"))},t[1]||(t[1]=[(0,a.Lk)("i",{class:"fa fa-bars"},null,-1)])),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.views,((t,i)=>((0,a.uX)(),(0,a.CE)("li",{key:i,title:t.displayName,class:(0,l.C4)({selected:i===s.selectedView}),onClick:t=>e.$emit("input",i)},[(0,a.Lk)("i",{class:(0,l.C4)(t.iconClass)},null,2)],10,H)))),128))])}var z={name:"Nav",emits:["input","toggle"],props:{selectedView:{type:String},collapsed:{type:Boolean,default:!1},views:{type:Object,default:()=>({playing:{iconClass:"fas fa-play",displayName:"Queue"},search:{iconClass:"fas fa-search",displayName:"Search"},playlists:{iconClass:"fas fa-list-ul",displayName:"Playlists"},library:{iconClass:"fas fa-compact-disc",displayName:"Library"}})}}};const G=(0,O.A)(z,[["render",J],["__scopeId","data-v-0896abbc"]]);var Y=G;const Z={key:1,class:"playlist fade-in"},ee={class:"header-container"},te={class:"col-7 filter"},se={class:"col-5 buttons"},ae={key:0,class:"no-content"},le=["onDragstart","onDragend","onDragover","data-index","onClick","onContextmenu","onDblclick"],ie={class:"col-10"},ne={class:"title"},oe={key:0,class:"artist"},ce=["textContent","onClick"],re={key:1,class:"album"},de=["textContent","onClick"],ue={class:"col-2 right-side"},he=["textContent"],pe={class:"actions"};function ke(e,t,s,n,o,c){const r=(0,a.g2)("Loading"),d=(0,a.g2)("DropdownItem"),u=(0,a.g2)("Dropdown"),h=(0,a.g2)("MusicHeader");return s.loading?((0,a.uX)(),(0,a.Wv)(r,{key:0})):((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.Lk)("div",ee,[(0,a.bF)(h,{ref:"header"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",te,[s.withBack?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"back-btn",title:"Back",onClick:t[0]||(t[0]=t=>e.$emit("back"))},t[10]||(t[10]=[(0,a.Lk)("i",{class:"fas fa-arrow-left"},null,-1)]))):(0,a.Q3)("",!0),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"search",placeholder:"Filter","onUpdate:modelValue":t[1]||(t[1]=e=>o.filter=e)},null,512),[[i.Jo,o.filter]])])]),(0,a.Lk)("div",se,[s.showNavButton?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"mobile",title:"Menu",onClick:t[2]||(t[2]=t=>e.$emit("toggle-nav"))},t[11]||(t[11]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))):(0,a.Q3)("",!0),(0,a.bF)(u,{title:"Actions","icon-class":"fa fa-ellipsis-h"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{text:"Add track","icon-class":"fa fa-plus",onInput:c.addTrack},null,8,["onInput"]),null!=s.devices?((0,a.uX)(),(0,a.Wv)(d,{key:0,text:"Refresh status","icon-class":"fa fa-sync",onInput:t[3]||(t[3]=t=>e.$emit("refresh-status"))})):(0,a.Q3)("",!0),s.withSave?((0,a.uX)(),(0,a.Wv)(d,{key:1,text:"Save as playlist","icon-class":"fa fa-save",disabled:!s.tracks?.length,onInput:c.playlistSave},null,8,["disabled","onInput"])):(0,a.Q3)("",!0),s.withSwap&&2===o.selectedTracks?.length?((0,a.uX)(),(0,a.Wv)(d,{key:2,text:"Swap tracks","icon-class":"fa fa-retweet",onInput:t[4]||(t[4]=t=>e.$emit("swap",o.selectedTracks))})):(0,a.Q3)("",!0),(0,a.bF)(d,{text:o.selectionMode?"End selection":"Start selection","icon-class":"far fa-check-square",disabled:!s.tracks?.length,onInput:t[5]||(t[5]=e=>o.selectionMode=!o.selectionMode)},null,8,["text","disabled"]),(0,a.bF)(d,{text:o.selectedTracks?.length===s.tracks?.length?"Unselect all":"Select all","icon-class":"fa fa-check-double",disabled:!s.tracks?.length,onInput:t[6]||(t[6]=e=>o.selectedTracks=o.selectedTracks.length===s.tracks.length?[]:[...Array(s.tracks.length).keys()])},null,8,["text","disabled"]),o.selectedTracks.length>0?((0,a.uX)(),(0,a.Wv)(d,{key:3,text:"Remove track"+(o.selectedTracks.length>1?"s":""),"icon-class":"fa fa-trash",onInput:t[7]||(t[7]=t=>e.$emit("remove",[...new Set(o.selectedTracks)]))},null,8,["text"])):(0,a.Q3)("",!0),s.withClear?((0,a.uX)(),(0,a.Wv)(d,{key:4,text:"Clear playlist","icon-class":"fa fa-ban",disabled:!s.tracks?.length,onInput:t[8]||(t[8]=t=>e.$emit("clear"))},null,8,["disabled"])):(0,a.Q3)("",!0)])),_:1}),Object.keys(s.devices||{}).length?((0,a.uX)(),(0,a.Wv)(u,{key:1,title:"Players","icon-class":"fa fa-volume-up"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.devices,((t,i)=>((0,a.uX)(),(0,a.Wv)(d,{key:i,textContent:(0,l.v_)(t.name),"item-class":{active:s.activeDevice===i,selected:s.selectedDevice===i},"icon-class":"fa fa-volume-up",onInput:t=>e.$emit("select-device",i)},null,8,["textContent","item-class","onInput"])))),128))])),_:1})):(0,a.Q3)("",!0)])])),_:1},512)]),(0,a.Lk)("div",{class:"body",ref:"body",onScroll:t[9]||(t[9]=(...e)=>c.onScroll&&c.onScroll(...e))},[s.tracks?.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",ae," No tracks are loaded ")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.displayedTrackIndices,(t=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["row track",c.trackClass(t)]),onDragstart:e=>c.onTrackDragStart(t),onDragend:e=>c.onTrackDragEnd(t),onDragover:e=>c.onTrackDragOver(t),draggable:"true",key:t,"data-index":t,onClick:(0,i.D$)((e=>c.onTrackClick(e,t)),["left"]),onContextmenu:(0,i.D$)((s=>e.$refs["menu"+t][0].toggle(s)),["right","prevent"]),onDblclick:s=>e.$emit("play",{pos:t})},[(0,a.Lk)("div",ie,[(0,a.Lk)("div",ne,[(0,a.eW)((0,l.v_)(s.tracks[t].title||"[No Title]")+" ",1),c.isPlayingTrack(t)?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,l.C4)(["playing-icon",{paused:"pause"===s.status?.state}])},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)([...Array(3).keys()],(e=>((0,a.uX)(),(0,a.CE)("span",{key:e})))),128))],2)):(0,a.Q3)("",!0)]),s.tracks[t].artist?((0,a.uX)(),(0,a.CE)("div",oe,[(0,a.Lk)("a",{textContent:(0,l.v_)(s.tracks[t].artist),onClick:(0,i.D$)((e=>c.searchArtist(s.tracks[t])),["prevent"])},null,8,ce)])):(0,a.Q3)("",!0),s.tracks[t].album?((0,a.uX)(),(0,a.CE)("div",re,[(0,a.Lk)("a",{textContent:(0,l.v_)(s.tracks[t].album),onClick:(0,i.D$)((e=>c.searchAlbum(s.tracks[t])),["prevent"])},null,8,de)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ue,[(0,a.Lk)("span",{class:"duration",textContent:(0,l.v_)(s.tracks[t].time?e.convertTime(s.tracks[t].time):"-:--")},null,8,he),(0,a.Lk)("span",pe,[(0,a.bF)(u,{title:"Actions","icon-class":"fa fa-ellipsis-h",ref_for:!0,ref:"menu"+t},{default:(0,a.k6)((()=>[(0,a.bF)(d,{text:"Play","icon-class":"fa fa-play",onInput:e=>c.onMenuPlay(t)},null,8,["onInput"]),s.withAddToQueue?((0,a.uX)(),(0,a.Wv)(d,{key:0,text:"Add to queue","icon-class":"fa fa-plus",onInput:s=>e.$emit("add-to-queue",[...new Set([...o.selectedTracks,t])])},null,8,["onInput"])):(0,a.Q3)("",!0),(0,a.bF)(d,{text:"Add to playlist","icon-class":"fa fa-list-ul",onInput:a=>e.$emit("add-to-playlist",s.tracks[t])},null,8,["onInput"]),(0,a.bF)(d,{text:"Remove","icon-class":"fa fa-trash",onInput:s=>e.$emit("remove",[...new Set([...o.selectedTracks,t])])},null,8,["onInput"]),(0,a.bF)(d,{text:"Info","icon-class":"fa fa-info",onInput:a=>e.$emit("info",s.tracks[t])},null,8,["onInput"])])),_:2},1536)])])],42,le)))),128))],544)]))}s(4114);const ve={class:"header"};function ye(e,t,s,l,i,n){return(0,a.uX)(),(0,a.CE)("div",ve,[(0,a.RG)(e.$slots,"default",{},void 0,!0)])}var me={name:"Header"};const fe=(0,O.A)(me,[["render",ye],["__scopeId","data-v-7e4bd102"]]);var ge=fe,be=s(9265),Ce=s(9612),we={name:"Playlist",mixins:[K.A],components:{DropdownItem:Ce.A,Dropdown:be.A,MusicHeader:ge,Loading:W.A},emits:["add","add-to-playlist","add-to-queue","add-to-queue-and-play","back","clear","info","move","play","refresh-status","remove","save","search","select-device","swap","toggle-nav"],props:{tracks:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},status:{type:Object,default:()=>{}},devices:{type:Object},selectedDevice:{type:String},activeDevice:{type:String},maxVisibleTracks:{type:Number,default:100},showNavButton:{type:Boolean,default:!1},withAddToQueue:{type:Boolean,default:!1},withBack:{type:Boolean,default:!1},withClear:{type:Boolean,default:!1},withSave:{type:Boolean,default:!1},withSwap:{type:Boolean,default:!1}},data(){return{selectionMode:!1,selectedTracks:[],filter:"",infoTrack:null,sourcePos:null,targetPos:null,centerPos:0,mounted:!1,scrollTimeout:null}},computed:{selectedTracksSet(){return new Set(this.selectedTracks)},trackIndicesByToken(){const e={};return this.tracks.forEach(((t,s)=>{const a=[t?.artist,t?.album,t?.title].filter((e=>e?.trim()?.length)).map((e=>e.trim().toLowerCase())).join(" ");e[a]||(e[a]=new Set),e[a].add(s)})),e},displayedTrackIndices(){let e=[...Array(this.tracks.length).keys()];if(this.filter?.length){const t=this.filter?.trim()?.replace(/\s+/g," ").toLowerCase(),s=new Set;Object.entries(this.trackIndicesByToken).forEach((([e,a])=>{e.indexOf(t)<0||s.add(...a)})),e=[...s],e.sort()}if(e.length>this.maxVisibleTracks){const t=Math.max(0,this.centerPos-Math.floor(this.maxVisibleTracks/2));e=e.slice(t,t+this.maxVisibleTracks)}return e}},methods:{getTrackElements(){return this.$refs.body.querySelectorAll(".track")},onTrackClick(e,t){if(e.shiftKey){const e=this.selectedTracks.sort();e.length?t<e[0]?this.selectedTracks=[...this.selectedTracks,...[...Array(e[0]-t).keys()].map((e=>e+t))]:t>e[e.length-1]&&(this.selectedTracks=[...this.selectedTracks,...[...Array(t-e[e.length-1]+1).keys()].map((t=>t+e[e.length-1]))]):this.selectedTracks=[t]}else{const s=this.selectedTracks.indexOf(t);this.selectionMode||e.ctrlKey?s>=0?this.selectedTracks.splice(s,1):this.selectedTracks.push(t):this.selectedTracks=s>=0?[]:[t]}},isPlayingTrack(e){return("play"===this.status?.state||"pause"===this.status?.state)&&(!this.withAddToQueue&&this.status?.playingPos===e)},trackClass(e){return{selected:this.selectedTracksSet.has(e),active:this.isPlayingTrack(e)}},addTrack(){const e=prompt("Item path or URL");e?.length&&this.$emit("add",e)},onMenuPlay(e){this.withAddToQueue?this.$emit("add-to-queue-and-play",[...new Set([...this.selectedTracks,e])]):this.$emit("play",{pos:e})},onTrackDragStart(e){this.sourcePos=e,this.selectedTracksSet.has(e)||(this.selectedTracks=[e]),this.$nextTick((()=>{const e=[...this.getTrackElements()].filter(((e,t)=>this.selectedTracksSet.has(t)));e.forEach((e=>e.classList.add("dragging")))}))},onTrackDragEnd(){if(this.getTrackElements().forEach((e=>{e.classList.remove("dragover"),e.classList.remove("top"),e.classList.remove("bottom")})),null!=this.sourcePos&&null!=this.targetPos&&this.sourcePos!==this.targetPos){const e=this.selectedTracks.length?this.selectedTracks:[this.sourcePos];this.$emit("move",{from:e,to:this.targetPos})}this.sourcePos=null,this.targetPos=null,this.selectedTracks=[],this.getTrackElements().forEach((e=>e.classList.remove("dragging")))},onTrackDragOver(e){this.targetPos=e;const t=this.getTrackElements(),s=[...t].find((t=>parseInt(t.dataset.index||-1)===e)),a=Math.min(...this.selectedTracks);t.forEach((e=>{e.classList.remove("dragover"),e.classList.remove("top"),e.classList.remove("bottom")})),e!==a&&(s.classList.add("dragover"),e>a?s.classList.add("bottom"):s.classList.add("top"))},onScroll(){const e=this.$refs.body.scrollTop,t=parseFloat(getComputedStyle(this.$refs.body).height),s=this.$refs.body.scrollHeight;if(e<5){if(this.scrollTimeout)return;this.scrollTimeout=setTimeout((()=>{this.centerPos=Math.max(0,parseInt(this.centerPos-this.maxVisibleTracks/1.5)),this.$refs.body.scrollTop=6,this.scrollTimeout=null}),250)}else if(e>=s-t-5){if(this.scrollTimeout)return;this.scrollTimeout=setTimeout((()=>{this.centerPos=Math.min(this.tracks.length-1,parseInt(this.centerPos+this.maxVisibleTracks/1.5)),this.scrollTimeout=null}),250)}},playlistSave(){const e=prompt("Playlist name");e?.length&&this.$emit("save",e)},scrollToTrack(e){this.centerPos=e||this.status?.playingPos||0,this.$nextTick((()=>{this.$refs.body?([...this.$refs.body.querySelectorAll(".track")].filter((e=>e.classList.contains("active"))).forEach((e=>e.scrollIntoView({block:"center",behavior:"smooth"}))),this.mounted=!0):this.$watch((()=>this.$refs.body),(()=>{this.mounted||this.scrollToTrack(e)}))}))},searchArtist(e){const t={};if(e.artist_uri&&(t.uris=[e.artist_uri]),!e.artist)return console.warn("No artist information available"),void console.debug(e);t.artist=e.artist,this.$emit("search",t)},searchAlbum(e){const t={};if(e.album_uri&&(t.uris=[e.album_uri]),!e.artist||!e.album)return console.warn("No artist/album information available"),void console.debug(e);t.artist=e.artist,t.album=e.album,this.$emit("search",t)}},mounted(){this.withAddToQueue||(this.scrollToTrack(),this.$watch((()=>this.status),(()=>this.scrollToTrack())),this.$watch((()=>this.filter),(e=>{e?.length||this.scrollToTrack()})))}};const Le=(0,O.A)(we,[["render",ke],["__scopeId","data-v-2e7a5aae"]]);var Te=Le;const $e={key:1,class:"editor-container fade-in"},xe={key:2,class:"playlists fade-in"},Pe={class:"header-container"},Ie={class:"col-7 filter"},Ee={class:"col-5 buttons"},Ae={class:"body",ref:"body"},Se={key:0,class:"no-content"},Xe=["onClick","onDblclick"],De={class:"col-10 name-container"},_e=["textContent"],Fe={class:"col-2 right-side"},Re={class:"actions"};function Ve(e,t,s,n,o,c){const r=(0,a.g2)("Loading"),d=(0,a.g2)("Playlist"),u=(0,a.g2)("DropdownItem"),h=(0,a.g2)("Dropdown"),p=(0,a.g2)("MusicHeader");return s.loading?((0,a.uX)(),(0,a.Wv)(r,{key:0})):null!=s.editedPlaylist?((0,a.uX)(),(0,a.CE)("div",$e,[(0,a.bF)(d,{tracks:s.tracks||[],status:s.status,devices:s.devices,"selected-device":s.selectedDevice,"active-device":s.activeDevice,"show-nav-button":s.showNavButton,"with-add-to-queue":!0,"with-back":!0,onAdd:t[0]||(t[0]=t=>e.$emit("playlist-add",t)),onAddToPlaylist:t[1]||(t[1]=t=>e.$emit("add-to-playlist",t)),onAddToQueue:t[2]||(t[2]=t=>e.$emit("load-tracks",{tracks:t,play:!1})),onAddToQueueAndPlay:t[3]||(t[3]=t=>e.$emit("load-tracks",{tracks:t,play:!0})),onBack:t[4]||(t[4]=t=>e.$emit("playlist-edit",null)),onDownload:t[5]||(t[5]=t=>e.$emit("download",t)),onInfo:t[6]||(t[6]=t=>e.$emit("info",t)),onMove:t[7]||(t[7]=t=>e.$emit("track-move",{...t,playlist:s.editedPlaylist})),onPlay:t[8]||(t[8]=t=>e.$emit("load-tracks",{tracks:[t],play:!0})),onRefreshStatus:t[9]||(t[9]=t=>e.$emit("refresh-status")),onRemove:t[10]||(t[10]=t=>e.$emit("remove-track",t)),onSearch:t[11]||(t[11]=t=>e.$emit("search",t)),onSelectDevice:t[12]||(t[12]=t=>e.$emit("select-device",t)),onToggleNav:t[13]||(t[13]=t=>e.$emit("toggle-nav"))},null,8,["tracks","status","devices","selected-device","active-device","show-nav-button"])])):((0,a.uX)(),(0,a.CE)("div",xe,[(0,a.Lk)("div",Pe,[(0,a.bF)(p,{ref:"header"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ie,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"search",placeholder:"Filter","onUpdate:modelValue":t[14]||(t[14]=e=>o.filter=e)},null,512),[[i.Jo,o.filter]])])]),(0,a.Lk)("div",Ee,[Object.keys(s.devices||{}).length?((0,a.uX)(),(0,a.Wv)(h,{key:0,title:"Players","icon-class":"fa fa-volume-up"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.devices,((t,i)=>((0,a.uX)(),(0,a.Wv)(u,{key:i,textContent:(0,l.v_)(t.name),"item-class":{active:s.activeDevice===i,selected:s.selectedDevice===i},"icon-class":"fa fa-volume-up",onInput:t=>e.$emit("select-device",i)},null,8,["textContent","item-class","onInput"])))),128))])),_:1})):(0,a.Q3)("",!0),null!=s.devices?((0,a.uX)(),(0,a.CE)("button",{key:1,title:"Refresh status",onClick:t[15]||(t[15]=t=>e.$emit("refresh-status"))},t[17]||(t[17]=[(0,a.Lk)("i",{class:"fa fa-sync"},null,-1)]))):(0,a.Q3)("",!0),s.showNavButton?((0,a.uX)(),(0,a.CE)("button",{key:2,class:"mobile",title:"Menu",onClick:t[16]||(t[16]=t=>e.$emit("toggle-nav"))},t[18]||(t[18]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))):(0,a.Q3)("",!0)])])),_:1},512)]),(0,a.Lk)("div",Ae,[s.playlists?.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Se," No playlists found ")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.playlists,((s,n)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["row playlist",{hidden:!c.displayedPlaylists.has(n)}]),key:n,onClick:t=>e.$emit("playlist-edit",n),onDblclick:t=>e.$emit("load",n)},[(0,a.Lk)("div",De,[t[19]||(t[19]=(0,a.Lk)("div",{class:"icon"},[(0,a.Lk)("i",{class:"fa fa-list"})],-1)),(0,a.Lk)("div",{class:"name",textContent:(0,l.v_)(s.name||"[No Name]")},null,8,_e)]),(0,a.Lk)("div",Fe,[(0,a.Lk)("span",Re,[(0,a.bF)(h,{title:"Actions","icon-class":"fa fa-ellipsis-h"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{text:"Play","icon-class":"fa fa-play",onClick:(0,i.D$)((t=>e.$emit("play",n)),["stop"])},null,8,["onClick"]),(0,a.bF)(u,{text:"Load","icon-class":"fa fa-list-ul",onClick:(0,i.D$)((t=>e.$emit("load",n)),["stop"])},null,8,["onClick"]),(0,a.bF)(u,{text:"Edit","icon-class":"fa fa-edit",onClick:(0,i.D$)((t=>e.$emit("playlist-edit",n)),["stop"])},null,8,["onClick"]),(0,a.bF)(u,{text:"Remove","icon-class":"fa fa-trash",onClick:(0,i.D$)((t=>e.$emit("remove",n)),["stop"])},null,8,["onClick"])])),_:2},1024)])])],42,Xe)))),128))],512)]))}var Me={name:"Playlists",mixins:[K.A],components:{Dropdown:be.A,DropdownItem:Ce.A,MusicHeader:ge,Loading:W.A,Playlist:Te},emits:["add-to-playlist","download","info","load","load-tracks","play","playlist-add","playlist-edit","refresh-status","remove","remove-track","search","select-device","track-move"],props:{playlists:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},tracks:{type:Array,default:()=>[]},editedPlaylist:{type:Number},devices:{type:Object},status:{type:Object,default:()=>{}},selectedDevice:{type:String},activeDevice:{type:String},showNavButton:{type:Boolean,default:!1}},data(){return{selectedTracks:[],filter:"",trackFilter:"",sourcePos:null,targetPos:null}},computed:{selectedTracksSet(){return new Set(this.selectedTracks)},displayedPlaylists(){const e=[...Array(this.playlists.length).keys()];if(!this.filter?.length)return new Set(e);const t=this,s=(t.filter||"").toLowerCase();return new Set(e.filter((e=>{const t=this.playlists[e];return(t?.name||"").toLowerCase().indexOf(s)>=0})))},displayedTracks(){const e=[...Array(this.tracks.length).keys()];if(!this.trackFilter?.length)return new Set(e);const t=this,s=(t.trackFilter||"").toLowerCase();return new Set(e.filter((e=>{const t=this.tracks[e];return(t?.artist||"").toLowerCase().indexOf(s)>=0||(t?.title||"").toLowerCase().indexOf(s)>=0||(t?.album||"").toLowerCase().indexOf(s)>=0})))}},methods:{onTrackClick(e,t){if(e.shiftKey){const e=this.selectedTracks.sort();e.length?t<e[0]?this.selectedTracks=[...this.selectedTracks,...[...Array(e[0]-t).keys()].map((e=>e+t))]:t>e[e.length-1]&&(this.selectedTracks=[...this.selectedTracks,...[...Array(t-e[e.length-1]+1).keys()].map((t=>t+e[e.length-1]))]):this.selectedTracks=[t]}else{const s=this.selectedTracks.indexOf(t);e.ctrlKey?s>=0?this.selectedTracks.splice(s,1):this.selectedTracks.push(t):this.selectedTracks=s>=0?[]:[t]}},onTrackDragStart(e){this.sourcePos=e},onTrackDragEnd(){this.$refs.editor.querySelectorAll(".track").forEach((e=>e.classList.remove("dragover"))),null!=this.sourcePos&&null!=this.targetPos&&this.sourcePos!==this.targetPos&&(this.$emit("track-move",{from:this.selectedTracks,to:this.targetPos,playlist:this.editedPlaylist}),this.sourcePos=null,this.targetPos=null,this.selectedTracks=[])},onTrackDragOver(e){this.targetPos=e;const t=this.$refs.editor.querySelectorAll(".track");t.forEach((e=>e.classList.remove("dragover"))),[...t][e].classList.add("dragover")}}};const Qe=(0,O.A)(Me,[["render",Ve],["__scopeId","data-v-557666b2"]]);var Ne=Qe;const Oe={class:"search-form"},Be={class:"row"},qe={class:"row"},We={class:"row"},je={class:"row"},Ke={class:"col-10 search-box"},Ue={class:"col-2 buttons"},He={class:"results"},Je=["onClick"],ze={class:"col-10"},Ge={class:"title-container"},Ye=["title"],Ze={key:0,class:"fa fa-user"},et={key:1,class:"fa fa-compact-disc"},tt={key:2,class:"fa fa-list"},st={key:3,class:"fa fa-music"},at={class:"title"},lt={key:0},it={key:1},nt={key:2},ot={key:3},ct=["textContent"],rt=["textContent"],dt={class:"col-2 right-side"},ut=["textContent"],ht={class:"actions"};function pt(e,t,s,n,o,c){const r=(0,a.g2)("FormFooter"),d=(0,a.g2)("MusicHeader"),u=(0,a.g2)("DropdownItem"),h=(0,a.g2)("Dropdown");return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["search fade-in",{"form-collapsed":c.formCollapsed}])},[s.showNavButton&&!c.formCollapsed?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"nav-toggler mobile floating",title:"Menu",onClick:t[0]||(t[0]=t=>e.$emit("toggle-nav"))},t[10]||(t[10]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))):(0,a.Q3)("",!0),c.formCollapsed?((0,a.uX)(),(0,a.Wv)(d,{key:2},{default:(0,a.k6)((()=>[(0,a.Lk)("label",Ke,[(0,a.Lk)("button",{class:"back-btn",title:"Back",onClick:t[7]||(t[7]=(...e)=>c.clear&&c.clear(...e))},t[13]||(t[13]=[(0,a.Lk)("i",{class:"fas fa-arrow-left"},null,-1)])),(0,a.bo)((0,a.Lk)("input",{type:"search",placeholder:"Filter","onUpdate:modelValue":t[8]||(t[8]=e=>o.filter=e)},null,512),[[i.Jo,o.filter]])]),(0,a.Lk)("span",Ue,[s.showNavButton?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"mobile",title:"Menu",onClick:t[9]||(t[9]=t=>e.$emit("toggle-nav"))},t[14]||(t[14]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))):(0,a.Q3)("",!0)])])),_:1})):((0,a.uX)(),(0,a.CE)("div",{key:1,class:"form-container",onSubmit:t[6]||(t[6]=(0,i.D$)((t=>e.$emit("search",c.filteredQuery)),["prevent"]))},[(0,a.Lk)("form",Oe,[(0,a.Lk)("div",Be,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Any","onUpdate:modelValue":t[1]||(t[1]=e=>o.query.any=e)},null,512),[[i.Jo,o.query.any]])])]),(0,a.Lk)("div",qe,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Artist","onUpdate:modelValue":t[2]||(t[2]=e=>o.query.artist=e)},null,512),[[i.Jo,o.query.artist]])])]),(0,a.Lk)("div",We,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Title","onUpdate:modelValue":t[3]||(t[3]=e=>o.query.title=e)},null,512),[[i.Jo,o.query.title]])])]),(0,a.Lk)("div",je,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Album","onUpdate:modelValue":t[4]||(t[4]=e=>o.query.album=e)},null,512),[[i.Jo,o.query.album]])])]),(0,a.bF)(r,null,{default:(0,a.k6)((()=>[(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>c.clear&&c.clear(...e))},t[11]||(t[11]=[(0,a.Lk)("i",{class:"icon fa fa-times"},null,-1),(0,a.Lk)("span",{class:"btn-title"},"Clear",-1)])),t[12]||(t[12]=(0,a.Lk)("button",{type:"submit"},[(0,a.Lk)("i",{class:"icon fa fa-search"}),(0,a.Lk)("span",{class:"btn-title"},"Search")],-1))])),_:1})])],32)),(0,a.Lk)("div",He,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.results,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["row track",{selected:o.selectedResults.has(s),hidden:!c.displayedTracks.has(s)}]),key:s,onClick:e=>c.resultClick(s,e)},[(0,a.Lk)("div",ze,[(0,a.Lk)("div",Ge,[t.type?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"type",title:t.type},["artist"===t.type?((0,a.uX)(),(0,a.CE)("i",Ze)):"album"===t.type?((0,a.uX)(),(0,a.CE)("i",et)):"playlist"===t.type?((0,a.uX)(),(0,a.CE)("i",tt)):((0,a.uX)(),(0,a.CE)("i",st))],8,Ye)):(0,a.Q3)("",!0),(0,a.Lk)("div",at,["playlist"===t.type?((0,a.uX)(),(0,a.CE)("span",lt,(0,l.v_)(t.name||t.title||"[No Name]"),1)):"artist"===t.type?((0,a.uX)(),(0,a.CE)("span",it,(0,l.v_)(t.name||t.title||t.artist||"[No Name]"),1)):"album"===t.type?((0,a.uX)(),(0,a.CE)("span",nt,(0,l.v_)(t.name||t.title||t.album||"[No Title]"),1)):((0,a.uX)(),(0,a.CE)("span",ot,(0,l.v_)(t.title||"[No Title]"),1))])]),t.artist?.length&&"artist"!==t.type?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"artist",textContent:(0,l.v_)(t.artist)},null,8,ct)):(0,a.Q3)("",!0),t.album?.length&&"album"!==t.type?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"album",textContent:(0,l.v_)(t.album)},null,8,rt)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",dt,[(0,a.Lk)("span",{class:"duration",textContent:(0,l.v_)(t.time&&parseInt(t.time)?e.convertTime(t.time):"-:--")},null,8,ut),(0,a.Lk)("span",ht,[(0,a.bF)(h,{title:"Actions","icon-class":"fa fa-ellipsis-h"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{text:"Play","icon-class":"fa fa-play",onInput:e=>c.play(s)},null,8,["onInput"]),(0,a.bF)(u,{text:"Add to queue","icon-class":"fa fa-plus",onInput:e=>c.load(s)},null,8,["onInput"]),(0,a.bF)(u,{text:"Add to playlist","icon-class":"fa fa-list-ul",onInput:s=>e.$emit("add-to-playlist",t)},null,8,["onInput"]),(0,a.bF)(u,{text:"Info","icon-class":"fa fa-info",onInput:s=>e.$emit("info",t)},null,8,["onInput"])])),_:2},1024)])])],10,Je)))),128))])],2)}var kt={name:"Search",components:{Dropdown:be.A,DropdownItem:Ce.A,FormFooter:q,MusicHeader:ge},mixins:[K.A],emits:["add-to-playlist","clear","info","load","play","refresh-status","search","select-device","toggle-nav"],props:{loading:{type:Boolean,default:!1},results:{type:Array},devices:{type:Object},selectedDevice:{type:String},activeDevice:{type:String},showNavButton:{type:Boolean,default:!1}},data(){return{selectedResults:new Set,filter:"",query:{any:"",artist:"",title:"",album:""}}},computed:{formCollapsed(){return this.results?.length>0},filteredQuery(){return Object.entries(this.query).filter((e=>e[1]?.length)).reduce(((e,[t,s])=>(e[t]=s,e)),{})},displayedTracks(){return new Set([...Array(this.results?.length||0).keys()].filter((e=>{const t=this.results[e];if(!this.filter?.length)return t;const s=this.filter.toLowerCase();return(t?.artist||"").toLowerCase().indexOf(s)>=0||(t?.title||"").toLowerCase().indexOf(s)>=0||(t?.album||"").toLowerCase().indexOf(s)>=0})))}},methods:{clear(){this.$emit("clear"),this.selectedResults=new Set},resultClick(e,t){if(t.shiftKey){if(this.selectedResults.size>0&&!this.selectedResults.has(e)){const t=[...this.selectedResults],s=Math.min(Math.min(t),e),a=Math.max(Math.max(t),e);this.selectedResults=new Set([...Array(a-s+1).keys()].map((e=>e+s)))}}else t.ctrlKey||(this.selectedResults=new Set),this.selectedResults.has(e)?this.selectedResults.delete(e):this.selectedResults.add(e)},play(e){this.$emit("play",this.results[e]),this.selectedResults.size&&this.selectedResults.forEach((e=>{this.$emit("load",e)}))},load(e){this.selectedResults.has(e)||this.selectedResults.add(e),this.selectedResults.forEach((e=>{this.$emit("load",this.results[e])}))}}};const vt=(0,O.A)(kt,[["render",pt],["__scopeId","data-v-45f74ccb"]]);var yt=vt;const mt={class:"library fade-in"},ft={class:"col-10 search-box"},gt={class:"col-2 buttons"},bt={class:"results"},Ct=["onClick"],wt={class:"col-10 left-side"},Lt={class:"icon-container"},Tt={key:0,class:"icon fa fa-folder"},$t={key:1,class:"icon fa fa-user"},xt={key:2,class:"icon fa fa-compact-disc"},Pt={key:3,class:"icon fa fa-list"},It={key:4,class:"icon fa fa-music"},Et={class:"info"},At={class:"title"},St=["textContent"],Xt=["textContent"],Dt=["textContent"],_t=["textContent"],Ft=["textContent"],Rt={class:"artist-album"},Vt=["textContent"],Mt=["textContent"],Qt={class:"col-2 right-side"},Nt=["textContent"],Ot={class:"actions"};function Bt(e,t,s,n,o,c){const r=(0,a.g2)("Loading"),d=(0,a.g2)("MusicHeader"),u=(0,a.g2)("DropdownItem"),h=(0,a.g2)("Dropdown");return(0,a.uX)(),(0,a.CE)("div",mt,[s.loading?((0,a.uX)(),(0,a.Wv)(r,{key:0})):(0,a.Q3)("",!0),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.Lk)("label",ft,[(0,a.bo)((0,a.Lk)("input",{type:"search",placeholder:"Filter","onUpdate:modelValue":t[0]||(t[0]=e=>o.filter=e)},null,512),[[i.Jo,o.filter]])]),(0,a.Lk)("div",gt,[s.showNavButton?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"mobile",title:"Menu",onClick:t[1]||(t[1]=t=>e.$emit("toggle-nav"))},t[3]||(t[3]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))):(0,a.Q3)("",!0)])])),_:1}),(0,a.Lk)("div",bt,[c.isRoot?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",{key:0,class:"row track back-track",onClick:t[2]||(t[2]=(...e)=>c.back&&c.back(...e))},t[4]||(t[4]=[(0,a.Lk)("div",{class:"icon-container"},[(0,a.Lk)("i",{class:"icon fa fa-folder"})],-1),(0,a.Lk)("div",{class:"result-container"},[(0,a.Lk)("div",{class:"title"},"..")],-1)]))),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.results,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["row track",{selected:o.selectedResults.has(s),hidden:!c.displayedResults.has(s)}]),key:s,onClick:e=>c.resultClick(s,e)},[(0,a.Lk)("div",wt,[(0,a.Lk)("div",Lt,[c.isDirectory(s)?((0,a.uX)(),(0,a.CE)("i",Tt)):c.isArtist(s)?((0,a.uX)(),(0,a.CE)("i",$t)):c.isAlbum(s)?((0,a.uX)(),(0,a.CE)("i",xt)):c.isPlaylist(s)?((0,a.uX)(),(0,a.CE)("i",Pt)):t.file?((0,a.uX)(),(0,a.CE)("i",It)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Et,[(0,a.Lk)("div",At,[c.isDirectory(s)?((0,a.uX)(),(0,a.CE)("span",{key:0,textContent:(0,l.v_)(t.name||t.directory.split("/").pop())},null,8,St)):c.isArtist(s)?((0,a.uX)(),(0,a.CE)("span",{key:1,textContent:(0,l.v_)(t.name||t.artist)},null,8,Xt)):c.isAlbum(s)?((0,a.uX)(),(0,a.CE)("span",{key:2,textContent:(0,l.v_)(t.name||t.album)},null,8,Dt)):c.isPlaylist(s)?((0,a.uX)(),(0,a.CE)("span",{key:3,textContent:(0,l.v_)(t.name||t.playlist)},null,8,_t)):t.title?((0,a.uX)(),(0,a.CE)("span",{key:4,textContent:(0,l.v_)(t.title)},null,8,Ft)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Rt,[t.artist?.length?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"artist",textContent:(0,l.v_)(t.artist)},null,8,Vt)):(0,a.Q3)("",!0),t.album?.length?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"album",textContent:(0,l.v_)(t.album)},null,8,Mt)):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",Qt,[(0,a.Lk)("span",{class:"duration",textContent:(0,l.v_)(t.time&&parseInt(t.time)?e.convertTime(t.time):"-:--")},null,8,Nt),(0,a.Lk)("span",Ot,[(0,a.bF)(h,{title:"Actions","icon-class":"fa fa-ellipsis-h"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{text:"Play","icon-class":"fa fa-play",onInput:e=>c.play(s)},null,8,["onInput"]),(0,a.bF)(u,{text:"Add to queue","icon-class":"fa fa-plus",onInput:e=>c.load(s)},null,8,["onInput"]),(0,a.bF)(u,{text:"Add to playlist","icon-class":"fa fa-list-ul",onInput:s=>e.$emit("add-to-playlist",t)},null,8,["onInput"]),(0,a.bF)(u,{text:"Info","icon-class":"fa fa-info",onInput:s=>e.$emit("info",t)},null,8,["onInput"])])),_:2},1024)])])],10,Ct)))),128))])])}var qt={name:"Library",components:{Dropdown:be.A,DropdownItem:Ce.A,MusicHeader:ge,Loading:W.A},mixins:[K.A],emits:["add-to-playlist","cd","info","load","play","refresh-status","search","select-device","toggle-nav"],props:{loading:{type:Boolean,default:!1},results:{type:Array},path:{type:Array,default:()=>[]},devices:{type:Object},selectedDevice:{type:String},activeDevice:{type:String},showNavButton:{type:Boolean,default:!1}},data(){return{selectedResults:new Set,filter:"",query:{any:"",artist:"",title:"",album:""}}},computed:{displayedResults(){return new Set([...Array(this.results?.length||0).keys()].filter((e=>{const t=this.results[e];if(!this.filter?.length)return t;const s=this.filter.toLowerCase();return(t?.artist||"").toLowerCase().indexOf(s)>=0||(t?.title||"").toLowerCase().indexOf(s)>=0||(t?.album||"").toLowerCase().indexOf(s)>=0||(t?.directory||"").toLowerCase().indexOf(s)>=0})))},isRoot(){return!this.path?.length||!this.path[0]?.length||"/"===this.path[0]}},methods:{resultClick(e,t){if(t.shiftKey){if(this.selectedResults.size>0&&!this.selectedResults.has(e)){const t=[...this.selectedResults],s=Math.min(Math.min(t),e),a=Math.max(Math.max(t),e);this.selectedResults=new Set([...Array(a-s+1).keys()].map((e=>e+s)))}}else if(t.ctrlKey)this.selectedResults.has(e)?this.selectedResults.delete(e):this.selectedResults.add(e);else if(this.isDirectory(e)||this.isArtist(e)||this.isAlbum(e)||this.isPlaylist(e)){const t=this.results[e].uri||this.results[e].directory;this.$emit("cd",[...this.path,t])}else this.selectedResults=new Set,this.selectedResults.has(e)?this.selectedResults.delete(e):this.selectedResults.add(e)},play(e){this.$emit("play",this.results[e]),this.selectedResults.size&&this.selectedResults.forEach((e=>{this.$emit("load",e)}))},load(e){this.selectedResults.has(e)||this.selectedResults.add(e),this.selectedResults.forEach((e=>{this.$emit("load",this.results[e])}))},back(){this.isRoot||this.$emit("cd",this.path.slice(0,-1))},isDirectory(e){return this.results[e].directory||"directory"===this.results[e].type},isArtist(e){return"artist"===this.results[e].type},isAlbum(e){return"album"===this.results[e].type},isPlaylist(e){return"playlist"===this.results[e].type}}};const Wt=(0,O.A)(qt,[["render",Bt],["__scopeId","data-v-9ace6422"]]);var jt=Wt,Kt=s(2002),Ut={emits:["add-to-playlist","add-to-tracklist","add-to-tracklist-from-edited-playlist","cd","clear","consume","info","load-playlist","new-playing-track","next","pause","play","play-playlist","playlist-add","playlist-edit","playlist-track-move","playlist-update","previous","random","refresh-status","remove-from-playlist","remove-from-tracklist","remove-playlist","repeat","search","search-clear","seek","select-device","set-volume","status-update","stop","swap-tracks","tracklist-move","tracklist-save"],mixins:[Kt.A,K.A],components:{Loading:W.A,Modal:j.A,Nav:Y,MediaView:U.A,Playlist:Te,Playlists:Ne,FormFooter:q,Search:yt,Library:jt},props:{pluginName:{type:String,required:!0},loading:{type:Boolean,default:!1},config:{type:Object,default:()=>{}},tracks:{type:Array,default:()=>[]},images:{type:Object,default:()=>{}},editedPlaylistTracks:{type:Array,default:()=>[]},playlists:{type:Array,default:()=>[]},status:{type:Object,default:()=>{}},track:{type:Object,default:null},editedPlaylist:{type:Number},trackInfo:{type:Object,default:()=>{}},searchResults:{type:Array},libraryResults:{type:Array},path:{type:Array,default:()=>[]},devices:{type:Object},activeDevice:{type:String},selectedDevice:{type:String}},data(){return{selectedView:"playing",selectedPlaylists:[],addToPlaylistTrack:null,playlistFilter:"",navVisible:!1}},methods:{async onStatusEvent(e){e.plugin_name===this.pluginName&&this.$emit("status-update",e)},async onPlaylistEvent(e){e.plugin_name===this.pluginName&&this.$emit("playlist-update",e)},async onNewPlayingTrack(e){e.plugin_name===this.pluginName&&(this.notify({html:`<b>${e.track?.artist}</b><br>${e.track?.title}`,image:{iconClass:"fa fa-play"}}),this.$emit("new-playing-track",e))},async openAddToPlaylist(e){this.addToPlaylistTrack=e,this.$refs.playlistsModal.isVisible=!0},async addToPlaylist(){this.$emit("add-to-playlist",{track:this.addToPlaylistTrack,playlists:[...Array(this.selectedPlaylists.length).keys()].filter((e=>this.selectedPlaylists[e]))}),this.$refs.playlistsModal.isVisible=!1,this.addToPlaylistTrack=null,this.playlistFilter=""},async search(e){this.$emit("search",e),this.$refs.trackInfo.isVisible=!1,this.selectedView="search"},selectDevice(e){this.$emit("select-device",e)},refreshStatus(){this.$emit("refresh-status")}},mounted(){this.subscribe(this.onStatusEvent,"on-status-update","platypush.message.event.music.MusicPlayEvent","platypush.message.event.music.MusicPauseEvent","platypush.message.event.music.MusicStopEvent","platypush.message.event.music.SeekChangeEvent","platypush.message.event.music.VolumeChangeEvent","platypush.message.event.music.MuteChangeEvent","platypush.message.event.music.PlaybackRepeatModeChangeEvent","platypush.message.event.music.PlaybackRandomModeChangeEvent","platypush.message.event.music.PlaybackConsumeModeChangeEvent","platypush.message.event.music.PlaybackSingleModeChangeEvent"),this.subscribe(this.onPlaylistEvent,"on-playlist-update","platypush.message.event.music.PlaylistChangeEvent"),this.subscribe(this.onNewPlayingTrack,"on-new-playing-track","platypush.message.event.music.NewPlayingTrackEvent"),this.$watch((()=>this.trackInfo),(e=>{null!=e&&(this.$refs.trackInfo.isVisible=!0)}))},unmounted(){this.unsubscribe("on-status-update"),this.unsubscribe("on-playlist-update")}};const Ht=(0,O.A)(Ut,[["render",V],["__scopeId","data-v-5a75ab98"]]);var Jt=Ht}}]);
//# sourceMappingURL=1995.9ddb7106.js.map
"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[1671],{226:function(e,t,s){s.d(t,{A:function(){return r}});s(4114);var n=s(2002),a={name:"Utils",mixins:[n.A],computed:{audioExtensions(){return new Set(["3gp","aa","aac","aax","act","aiff","amr","ape","au","awb","dct","dss","dvf","flac","gsm","iklax","ivs","m4a","m4b","m4p","mmf","mp3","mpc","msv","nmf","nsf","ogg,","opus","ra,","raw","sln","tta","vox","wav","wma","wv","webm","8svx"])},videoExtensions(){return new Set(["webm","mkv","flv","flv","vob","ogv","ogg","drc","gif","gifv","mng","avi","mts","m2ts","mov","qt","wmv","yuv","rm","rmvb","asf","amv","mp4","m4p","m4v","mpg","mp2","mpeg","mpe","mpv","mpg","mpeg","m2v","m4v","svi","3gp","3g2","mxf","roq","nsv","flv","f4v","f4p","f4a","f4b"])},mediaExtensions(){return new Set([...this.videoExtensions,...this.audioExtensions])}},methods:{convertTime(e){e=parseFloat(e);const t={};t.h=""+parseInt(e/3600),t.m=""+parseInt(e/60-60*t.h),t.s=""+parseInt(e-(3600*t.h+60*t.m));for(const n of["m","s"])parseInt(t[n])<10&&(t[n]="0"+t[n]);const s=[];return parseInt(t.h)&&s.push(t.h),s.push(t.m,t.s),s.join(":")},async startStreaming(e,t,s=!1){let n=e,a=null;e instanceof Object?(n=e.url,a=e.subtitles):e={url:n};const l=await this.request(`${t}.start_streaming`,{media:n,subtitles:a,download:s});return{...e,...l}},async stopStreaming(e,t){await this.request(`${t}.stop_streaming`,{media_id:e})}}};const l=a;var r=l},9265:function(e,t,s){s.d(t,{A:function(){return h}});var n=s(641),a=s(3751),l=s(33);const r={class:"dropdown-container"},o=["title"],i=["textContent"];function d(e,t,s,d,c,u){const p=(0,n.g2)("DropdownBody");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("button",{title:s.title,ref:"button",onClick:t[0]||(t[0]=(0,a.D$)((e=>u.toggle(e)),["stop"]))},[s.iconClass?((0,n.uX)(),(0,n.CE)("i",{key:0,class:(0,l.C4)(["icon",s.iconClass])},null,2)):(0,n.Q3)("",!0),s.text?((0,n.uX)(),(0,n.CE)("span",{key:1,class:"text",textContent:(0,l.v_)(s.text)},null,8,i)):(0,n.Q3)("",!0)],8,o),(0,n.Lk)("div",{class:(0,l.C4)(["body-container",{hidden:!c.visible}]),ref:"dropdownContainer"},[(0,n.bF)(p,{id:s.id,keepOpenOnItemClick:s.keepOpenOnItemClick,style:(0,l.Tr)(s.style),ref:"dropdown",onClick:u.onClick},{default:(0,n.k6)((()=>[(0,n.RG)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","style","onClick"])],2)])}var c=s(4200),u=s(2537),p={components:{DropdownBody:c.A},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}},data(){return{visible:!1}},computed:{button(){const e=this.$refs.button?.$el;return e?e.querySelector("button"):this.$refs.button},buttonStyle(){return this.button?getComputedStyle(this.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),u.j.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$nextTick(this.adjustDropdownPos)},adjustDropdownPos(){const e=this.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},s={left:t.left,top:t.top+this.buttonHeight},n=this.getDropdownWidth(),a=this.getDropdownHeight();if(s.left+n>(window.innerWidth+window.scrollX)/2&&(s.left-=n-this.buttonWidth),s.top+a>(window.innerHeight+window.scrollY)/2){let e=s.top-(a+this.buttonHeight-10);e<0&&(e=0),s.top=e}const l=this.$refs.dropdown.$el;l.classList.add("fade-in"),l.style.top=`${s.top}px`,l.style.left=`${s.left}px`,u.j.emit("dropdown-open",this.$refs.dropdown)},toggle(e){e?.stopPropagation(),this.$emit("click",e),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}},v=s(6262);const f=(0,v.A)(p,[["render",d],["__scopeId","data-v-3f1ad726"]]);var h=f},4200:function(e,t,s){s.d(t,{A:function(){return c}});var n=s(641),a=s(33);const l=["id"];function r(e,t,s,r,o,i){return(0,n.uX)(),(0,n.CE)("div",{class:"dropdown",id:s.id,style:(0,a.Tr)(s.style),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,n.RG)(e.$slots,"default",{},void 0,!0)],12,l)}var o={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}}},i=s(6262);const d=(0,i.A)(o,[["render",r],["__scopeId","data-v-24c5aa28"]]);var c=d},9612:function(e,t,s){s.d(t,{A:function(){return f}});var n=s(641),a=s(33);const l=["title"],r={key:0,class:"col-2 icon"},o=["textContent"];function i(e,t,s,i,d,c){const u=(0,n.g2)("Icon");return(0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["row item",{...c.itemClass_,disabled:s.disabled}]),title:s.hoverText,onClick:t[0]||(t[0]=(...e)=>c.clicked&&c.clicked(...e))},[s.iconClass?.length||s.iconUrl?.length?((0,n.uX)(),(0,n.CE)("div",r,[(0,n.bF)(u,{class:(0,a.C4)(s.iconClass),url:s.iconUrl},null,8,["class","url"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,a.C4)(["text",{"col-10":null!=s.iconClass}]),textContent:(0,a.v_)(s.text)},null,10,o)],10,l)}var d=s(3778),c=s(2537),u={components:{Icon:d.A},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||c.j.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},p=s(6262);const v=(0,p.A)(u,[["render",i],["__scopeId","data-v-2babe09c"]]);var f=v},3778:function(e,t,s){s.d(t,{A:function(){return u}});var n=s(641),a=s(33);const l={class:"icon-container"},r=["src","alt"];function o(e,t,s,o,i,d){return(0,n.uX)(),(0,n.CE)("div",l,[s.url?.length?((0,n.uX)(),(0,n.CE)("img",{key:0,class:"icon",src:s.url,alt:s.alt},null,8,r)):d.className?.length?((0,n.uX)(),(0,n.CE)("i",{key:1,class:(0,a.C4)(["icon",d.className]),style:(0,a.Tr)({color:s.color})},null,6)):(0,n.Q3)("",!0)])}var i={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=s(6262);const c=(0,d.A)(i,[["render",o],["__scopeId","data-v-706a3bd1"]]);var u=c},1671:function(e,t,s){s.d(t,{A:function(){return ye}});var n=s(641),a=s(33);const l={class:"torrent-container"},r={class:"nav-container"};function o(e,t,s,o,i,d){const c=(0,n.g2)("Info"),u=(0,n.g2)("Modal"),p=(0,n.g2)("Header"),v=(0,n.g2)("Transfers"),f=(0,n.g2)("Results"),h=(0,n.g2)("Nav");return(0,n.uX)(),(0,n.CE)("div",l,[d.infoItem?((0,n.uX)(),(0,n.Wv)(u,{key:0,title:"Torrent info",visible:null!==d.infoItem,onClose:t[0]||(t[0]=e=>i.infoIndex=null)},{default:(0,n.k6)((()=>[(0,n.bF)(c,{torrent:d.infoItem},null,8,["torrent"])])),_:1},8,["visible"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,a.C4)(["header-container",{"with-nav":!i.navCollapsed}])},[(0,n.bF)(p,{"with-nav":!i.navCollapsed,"selected-view":i.selectedView,loading:i.loading,onSearch:t[1]||(t[1]=e=>d.search(e)),onTorrentAdd:t[2]||(t[2]=e=>d.download(e)),onToggle:t[3]||(t[3]=e=>i.navCollapsed=!i.navCollapsed)},null,8,["with-nav","selected-view","loading"])],2),(0,n.Lk)("main",null,[(0,n.Lk)("div",{class:(0,a.C4)(["view-container",{"with-nav":!i.navCollapsed}])},["transfers"===i.selectedView?((0,n.uX)(),(0,n.Wv)(v,{key:0,transfers:i.transfers,onPause:t[4]||(t[4]=e=>d.pause(e)),onResume:t[5]||(t[5]=e=>d.resume(e)),onRemove:t[6]||(t[6]=e=>d.remove(e))},null,8,["transfers"])):"search"===i.selectedView?((0,n.uX)(),(0,n.Wv)(f,{key:1,results:i.results,onDownload:t[7]||(t[7]=e=>d.download(e)),onInfo:t[8]||(t[8]=e=>i.infoIndex=e),onNextPage:t[9]||(t[9]=e=>d.search(i.query,i.page+1))},null,8,["results"])):(0,n.Q3)("",!0)],2),(0,n.Lk)("div",r,[i.navCollapsed?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(h,{key:0,"selected-view":i.selectedView,onToggle:t[10]||(t[10]=e=>i.navCollapsed=!i.navCollapsed),onInput:t[11]||(t[11]=e=>i.selectedView=e)},null,8,["selected-view"]))])])])}const i={class:"info"},d={class:"row"},c={class:"value"},u={class:"row"},p={class:"value"},v={class:"row"},f={class:"value"},h={class:"row"},m={class:"value"},k={class:"row"},g={class:"value"},y={class:"row"},C={class:"value"},w={key:0,class:"row"},b={class:"value"},L={key:1,class:"row"},I={class:"value"};function x(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("div",d,[t[2]||(t[2]=(0,n.Lk)("div",{class:"label"},"Title",-1)),(0,n.Lk)("div",c,(0,a.v_)(s.torrent.title),1)]),(0,n.Lk)("div",u,[t[5]||(t[5]=(0,n.Lk)("div",{class:"label"},"URL",-1)),(0,n.Lk)("div",p,[(0,n.Lk)("button",{title:"Open",onClick:t[0]||(t[0]=e=>o.openInNewTab(s.torrent.url))},t[3]||(t[3]=[(0,n.Lk)("i",{class:"fas fa-up-right-from-square"},null,-1)])),(0,n.Lk)("button",{title:"Copy",onClick:t[1]||(t[1]=t=>e.copyToClipboard(s.torrent.url))},t[4]||(t[4]=[(0,n.Lk)("i",{class:"fas fa-clipboard"},null,-1)]))])]),(0,n.Lk)("div",v,[t[6]||(t[6]=(0,n.Lk)("div",{class:"label"},"Size",-1)),(0,n.Lk)("div",f,(0,a.v_)(e.convertSize(s.torrent.size)),1)]),(0,n.Lk)("div",h,[t[7]||(t[7]=(0,n.Lk)("div",{class:"label"},"Seeders",-1)),(0,n.Lk)("div",m,(0,a.v_)(s.torrent.seeds),1)]),(0,n.Lk)("div",k,[t[8]||(t[8]=(0,n.Lk)("div",{class:"label"},"Leechers",-1)),(0,n.Lk)("div",g,(0,a.v_)(s.torrent.peers),1)]),(0,n.Lk)("div",y,[t[9]||(t[9]=(0,n.Lk)("div",{class:"label"},"Uploaded",-1)),(0,n.Lk)("div",C,(0,a.v_)(e.formatDate(s.torrent.created_at,!0)),1)]),s.torrent.description?((0,n.uX)(),(0,n.CE)("div",w,[t[10]||(t[10]=(0,n.Lk)("div",{class:"label"},"Description",-1)),(0,n.Lk)("div",b,(0,a.v_)(s.torrent.description),1)])):(0,n.Q3)("",!0),s.torrent.year?((0,n.uX)(),(0,n.CE)("div",L,[t[11]||(t[11]=(0,n.Lk)("div",{class:"label"},"Year",-1)),(0,n.Lk)("div",I,(0,a.v_)(s.torrent.year),1)])):(0,n.Q3)("",!0)])}var _=s(2002),E={mixins:[_.A],props:{torrent:{type:Object,default:()=>({})}},methods:{openInNewTab(e){window.open(e,"_blank")}}},T=s(6262);const S=(0,T.A)(E,[["render",x],["__scopeId","data-v-8eed74b0"]]);var $=S,X=s(3751);const A={class:"row"},D={class:"search-box"},F=["disabled","placeholder"],N=["placeholder","value"],Q={class:"button-container"},U={key:0,type:"submit",title:"Loading",disabled:""},R={key:1,type:"submit",title:"Add torrent URL"},O={key:2,type:"submit",title:"Search"},q={key:0,class:"right side col-1"};function V(e,t,s,l,r,o){const i=(0,n.g2)("Loading");return(0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["header",{"with-nav":s.withNav}])},[(0,n.Lk)("div",A,[(0,n.Lk)("div",{class:(0,a.C4)(["left side",o.leftSideClasses])},[(0,n.Lk)("form",{onSubmit:t[1]||(t[1]=(0,X.D$)(((...e)=>o.submit&&o.submit(...e)),["prevent"]))},[(0,n.Lk)("label",D,["transfers"===s.selectedView?(0,n.bo)(((0,n.uX)(),(0,n.CE)("input",{key:0,type:"search",disabled:s.loading,placeholder:o.placeholder,"onUpdate:modelValue":t[0]||(t[0]=e=>r.torrentURL=e)},null,8,F)),[[X.Jo,r.torrentURL]]):"search"===s.selectedView?((0,n.uX)(),(0,n.CE)("input",{key:1,type:"search",placeholder:o.placeholder,value:s.query,ref:"search"},null,8,N)):(0,n.Q3)("",!0)]),(0,n.Lk)("span",Q,[s.loading?((0,n.uX)(),(0,n.CE)("button",U,[(0,n.bF)(i)])):"transfers"===s.selectedView?((0,n.uX)(),(0,n.CE)("button",R,t[3]||(t[3]=[(0,n.Lk)("i",{class:"fa fa-download"},null,-1)]))):"search"===s.selectedView?((0,n.uX)(),(0,n.CE)("button",O,t[4]||(t[4]=[(0,n.Lk)("i",{class:"fa fa-search"},null,-1)]))):(0,n.Q3)("",!0)])],32)],2),s.withNav?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",q,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=t=>e.$emit("toggle")),title:"Toggle navigation"},t[5]||(t[5]=[(0,n.Lk)("i",{class:"fa fa-bars"},null,-1)]))]))])],2)}var P=s(9828),j={name:"Header",emits:["torrent-add","search","toggle"],components:{Loading:P.A},props:{query:{type:String,default:""},loading:{type:Boolean,default:!1},withNav:{type:Boolean,default:!1},selectedView:{type:String,default:"transfers"}},data(){return{torrentURL:""}},computed:{placeholder(){return"transfers"===this.selectedView?"Add torrent URL":"Search torrents"},leftSideClasses(){return this.withNav?{"col-11":!0}:{"col-12":!0}}},methods:{submit(){const e=this.$refs?.search?.value?.trim();"transfers"===this.selectedView&&this.torrentURL?.length?this.$emit("torrent-add",this.torrentURL):"search"===this.selectedView&&e?.length&&this.$emit("search",e)}}};const H=(0,T.A)(j,[["render",V],["__scopeId","data-v-0ae4cd8d"]]);var W=H,z=s(9513);const B=["title","onClick"];function K(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("nav",null,[(0,n.Lk)("button",{class:"menu-button",onClick:t[0]||(t[0]=t=>e.$emit("toggle"))},t[1]||(t[1]=[(0,n.Lk)("i",{class:"fa fa-bars"},null,-1)])),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.views,((t,l)=>((0,n.uX)(),(0,n.CE)("li",{key:l,title:t.displayName,class:(0,a.C4)({selected:l===s.selectedView}),onClick:t=>e.$emit("input",l)},[(0,n.Lk)("i",{class:(0,a.C4)(t.iconClass)},null,2)],10,B)))),128))])}var M={emits:["input","toggle"],props:{selectedView:{type:String},collapsed:{type:Boolean,default:!1},views:{type:Object,default:()=>({search:{displayName:"Search",iconClass:"fa fa-search"},transfers:{displayName:"Transfers",iconClass:"fa fa-download"}})}}};const Y=(0,T.A)(M,[["render",K],["__scopeId","data-v-5185ff00"]]);var G=Y;const J={class:"results-container"},Z={key:0,class:"no-content"},ee={class:"info"},te={class:"title"},se={class:"additional-info"},ne={class:"info-pill size"},ae={class:"value"},le={class:"info-pill seeds"},re={class:"value"},oe={class:"info-pill created-at"},ie={class:"value"},de={class:"actions"},ce=["onClick"],ue=["onClick"];function pe(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("div",J,[s.results?.length?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"results",ref:"body",onScroll:t[0]||(t[0]=(...e)=>o.onScroll&&o.onScroll(...e))},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.results,((s,l)=>((0,n.uX)(),(0,n.CE)("div",{class:"result",key:l},[(0,n.Lk)("div",ee,[(0,n.Lk)("div",te,(0,a.v_)(s.title),1),(0,n.Lk)("div",se,[(0,n.Lk)("span",ne,[t[1]||(t[1]=(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-hdd"})],-1)),t[2]||(t[2]=(0,n.Lk)("span",{class:"separator"},null,-1)),(0,n.Lk)("span",ae,(0,a.v_)(e.convertSize(s.size)),1)]),t[7]||(t[7]=(0,n.Lk)("span",{class:"separator"}," | ",-1)),(0,n.Lk)("span",le,[t[3]||(t[3]=(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-users"})],-1)),t[4]||(t[4]=(0,n.Lk)("span",{class:"separator"},null,-1)),(0,n.Lk)("span",re,(0,a.v_)(s.seeds),1)]),t[8]||(t[8]=(0,n.Lk)("span",{class:"separator"}," | ",-1)),(0,n.Lk)("span",oe,[t[5]||(t[5]=(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-calendar"})],-1)),t[6]||(t[6]=(0,n.Lk)("span",{class:"separator"},null,-1)),(0,n.Lk)("span",ie,(0,a.v_)(e.formatDate(s.created_at,!0)),1)]),t[9]||(t[9]=(0,n.Lk)("span",{class:"separator"}," | ",-1))])]),(0,n.Lk)("div",de,[(0,n.Lk)("button",{title:"Torrent info",onClick:t=>e.$emit("info",l)},t[10]||(t[10]=[(0,n.Lk)("i",{class:"fa fa-info-circle"},null,-1)]),8,ce),(0,n.Lk)("button",{title:"Download",onClick:t=>e.$emit("download",s.url)},t[11]||(t[11]=[(0,n.Lk)("i",{class:"fa fa-download"},null,-1)]),8,ue)])])))),128))],544)):((0,n.uX)(),(0,n.CE)("div",Z,"No results"))])}var ve={emits:["download","info","next-page"],mixins:[_.A],props:{results:{type:Array,default:()=>[]},page:{type:Number,default:1}},data(){return{scrollTimeout:null}},methods:{onScroll(){const e=this.$refs.body.scrollTop,t=parseFloat(getComputedStyle(this.$refs.body).height),s=this.$refs.body.scrollHeight;if(e>=s-t-5){if(this.scrollTimeout||!this.results.length)return;this.scrollTimeout=setTimeout((()=>{this.scrollTimeout=null}),250),this.$emit("next-page",this.page+1)}}}};const fe=(0,T.A)(ve,[["render",pe],["__scopeId","data-v-52a230bc"]]);var he=fe,me=s(7388),ke={mixins:[_.A],components:{Info:$,Header:W,Modal:z.A,Nav:G,Results:he,Transfers:me.A},props:{pluginName:{type:String,required:!0}},data(){return{loading:!1,transfers:{},results:[],selectedView:"transfers",navCollapsed:!1,query:"",page:1,infoIndex:null}},computed:{infoItem(){return null===this.infoIndex?null:this.results[this.infoIndex]}},methods:{torrentId(e){return e?.hash&&e.hash.length?e.hash:e.url},onTorrentUpdate(e){this.transfers[this.torrentId(e)]=e},onTorrentQueued(e){this.onTorrentUpdate(e),this.notify({text:"Torrent queued for download",image:{icon:"hourglass-start"}})},onTorrentStart(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download started: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentResume(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download resumed: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentPause(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download paused: <b>${e.name}</b>`,image:{icon:"pause"}})},onTorrentCompleted(e){this.onTorrentUpdate(e),this.transfers[this.torrentId(e)].finish_date=(new Date).toISOString(),this.transfers[this.torrentId(e)].progress=100,this.notify({html:`Torrent download completed: <b>${e.name}</b>`,image:{icon:"check"}})},onTorrentRemove(e){const t=this.torrentId(e);t in this.transfers&&delete this.transfers[t]},async search(e,t=1){this.loading=!0,this.query=e;let s=[];try{s=await this.request(`${this.pluginName}.search`,{query:e,page:t})}finally{this.loading=!1}this.results=1===t?s:this.results.concat(s),s.length>0&&(this.page=t)},async download(e){await this.request(`${this.pluginName}.download`,{torrent:e})},async pause(e){await this.request(`${this.pluginName}.pause`,{torrent:e.url}),await this.refresh()},async resume(e){await this.request(`${this.pluginName}.resume`,{torrent:e.url}),await this.refresh()},async remove(e){await this.request(`${this.pluginName}.remove`,{torrent:e.url}),await this.refresh()},async refresh(){this.loading=!0;try{this.transfers=Object.values(await this.request(`${this.pluginName}.status`)||{}).reduce(((e,t)=>(e[this.torrentId(t)]=t,e)),{})}finally{this.loading=!1}}},mounted(){this.refresh(),this.selectedView=this.transfers.length?"transfers":"search",this.subscribe(this.onTorrentUpdate,"on-torrent-update","platypush.message.event.torrent.TorrentDownloadStartEvent","platypush.message.event.torrent.TorrentDownloadProgressEvent","platypush.message.event.torrent.TorrentSeedingStartEvent","platypush.message.event.torrent.TorrentStateChangeEvent"),this.subscribe(this.onTorrentQueued,"on-torrent-queued","platypush.message.event.torrent.TorrentQueuedEvent"),this.subscribe(this.onTorrentStart,"on-torrent-queued","platypush.message.event.torrent.TorrentDownloadedMetadataEvent"),this.subscribe(this.onTorrentResume,"on-torrent-resume","platypush.message.event.torrent.TorrentResumedEvent"),this.subscribe(this.onTorrentPause,"on-torrent-pause","platypush.message.event.torrent.TorrentPausedEvent"),this.subscribe(this.onTorrentStop,"on-torrent-stop","platypush.message.event.torrent.TorrentDownloadStopEvent"),this.subscribe(this.onTorrentCompleted,"on-torrent-completed","platypush.message.event.torrent.TorrentDownloadCompletedEvent"),this.subscribe(this.onTorrentRemove,"on-torrent-remove","platypush.message.event.torrent.TorrentRemovedEvent");const e=document.querySelector('.search-box input[type="search"]');e&&this.$nextTick((()=>e.focus()))},destroy(){this.unsubscribe("on-torrent-update"),this.unsubscribe("on-torrent-remove")}};const ge=(0,T.A)(ke,[["render",o],["__scopeId","data-v-250eee36"]]);var ye=ge},7388:function(e,t,s){s.d(t,{A:function(){return se}});var n=s(641),a=s(33);const l={key:1,class:"torrent-transfers fade-in"},r={key:0,class:"no-content"},o=["onClick"],i={class:"col-8 left side"},d=["textContent"],c={class:"col-2 right side"},u=["textContent"],p={class:"col-2 right side"},v={key:0,class:"modal-body torrent-info"},f={key:0,class:"row"},h=["textContent"],m={key:1,class:"row"},k=["textContent"],g={class:"row"},y=["textContent"],C={class:"row"},w=["textContent"],b={class:"row"},L=["textContent"],I={class:"row"},x=["textContent"],_={key:2,class:"row"},E=["textContent"],T={class:"row"},S={class:"value nowrap"},$=["href","textContent"],X={class:"row"},A=["textContent"],D={key:3,class:"row"},F=["textContent"],N={key:4,class:"row"},Q=["textContent"],U={key:5,class:"row"},R=["textContent"],O={key:6,class:"row"},q={class:"value files-container"},V=["href","textContent"],P={key:0,class:"modal-body torrent-files"},j={class:"col-1 icon"},H={key:1,class:"fa fa-file"},W=["textContent"];function z(e,t,s,z,B,K){const M=(0,n.g2)("Loading"),Y=(0,n.g2)("DropdownItem"),G=(0,n.g2)("Dropdown"),J=(0,n.g2)("Modal");return B.loading?((0,n.uX)(),(0,n.Wv)(M,{key:0})):((0,n.uX)(),(0,n.CE)("div",l,[Object.keys(s.transfers).length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",r,"No torrent transfers in progress")),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.transfers,((s,l)=>((0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["row item",{selected:B.selectedItem===l}]),key:l,onClick:e=>B.selectedItem=l},[(0,n.Lk)("div",i,[(0,n.Lk)("i",{class:(0,a.C4)(["icon fa",{"fa-check":null!=s.finish_date,"fa-play":!s.finish_date&&"downloading"===s.state&&!s.paused,"fa-pause":!s.finish_date&&"downloading"===s.state&&s.paused,"fa-stop":!s.finish_date&&"stopped"===s.state}])},null,2),(0,n.Lk)("div",{class:"title",textContent:(0,a.v_)(s.name||s.hash||s.url)},null,8,d)]),(0,n.Lk)("div",c,[(0,n.Lk)("span",{textContent:(0,a.v_)(`${s.progress}%`)},null,8,u)]),(0,n.Lk)("div",p,[(0,n.bF)(G,{title:"Actions","icon-class":"fa fa-ellipsis-h",onClick:e=>B.selectedItem=l},{default:(0,n.k6)((()=>["downloading"!==s.state||s.paused?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(Y,{key:0,"icon-class":"fa fa-pause",text:"Pause transfer",onInput:t=>e.$emit("pause",s)},null,8,["onInput"])),"downloading"===s.state&&s.paused?((0,n.uX)(),(0,n.Wv)(Y,{key:1,"icon-class":"fa fa-play",text:"Resume transfer",onInput:t=>e.$emit("resume",s)},null,8,["onInput"])):(0,n.Q3)("",!0),(0,n.bF)(Y,{"icon-class":"fa fa-trash",text:"Remove transfer",onInput:t=>e.$emit("remove",s)},null,8,["onInput"]),(0,n.bF)(Y,{"icon-class":"fa fa-folder",text:"View files",onInput:t[0]||(t[0]=t=>e.$refs.torrentFiles.isVisible=!0)}),(0,n.bF)(Y,{"icon-class":"fa fa-info",text:"Torrent info",onInput:t[1]||(t[1]=t=>e.$refs.torrentInfo.isVisible=!0)})])),_:2},1032,["onClick"])])],10,o)))),128)),(0,n.bF)(J,{ref:"torrentInfo",title:"Torrent info",width:"80%"},{default:(0,n.k6)((()=>[null!=B.selectedItem&&s.transfers[B.selectedItem]?((0,n.uX)(),(0,n.CE)("div",v,[s.transfers[B.selectedItem].name?((0,n.uX)(),(0,n.CE)("div",f,[t[2]||(t[2]=(0,n.Lk)("div",{class:"attr"},"Name",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[B.selectedItem].name)},null,8,h)])):(0,n.Q3)("",!0),s.transfers[B.selectedItem].state?((0,n.uX)(),(0,n.CE)("div",m,[t[3]||(t[3]=(0,n.Lk)("div",{class:"attr"},"State",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[B.selectedItem].state)},null,8,k)])):(0,n.Q3)("",!0),(0,n.Lk)("div",g,[t[4]||(t[4]=(0,n.Lk)("div",{class:"attr"},"Progress",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${s.transfers[B.selectedItem].progress||0}%`)},null,8,y)]),(0,n.Lk)("div",C,[t[5]||(t[5]=(0,n.Lk)("div",{class:"attr"},"DL rate",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${e.convertSize(s.transfers[B.selectedItem].download_rate||0)}/s`)},null,8,w)]),(0,n.Lk)("div",b,[t[6]||(t[6]=(0,n.Lk)("div",{class:"attr"},"UL rate",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${e.convertSize(s.transfers[B.selectedItem].upload_rate||0)}/s`)},null,8,L)]),(0,n.Lk)("div",I,[t[7]||(t[7]=(0,n.Lk)("div",{class:"attr"},"Size",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.convertSize(s.transfers[B.selectedItem].size||0))},null,8,x)]),s.transfers[B.selectedItem].remaining_bytes?((0,n.uX)(),(0,n.CE)("div",_,[t[8]||(t[8]=(0,n.Lk)("div",{class:"attr"},"Remaining",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.convertSize(s.transfers[B.selectedItem].remaining_bytes))},null,8,E)])):(0,n.Q3)("",!0),(0,n.Lk)("div",T,[t[9]||(t[9]=(0,n.Lk)("div",{class:"attr"},"URL",-1)),(0,n.Lk)("div",S,[(0,n.Lk)("a",{href:s.transfers[B.selectedItem].url,target:"_blank",textContent:(0,a.v_)(s.transfers[B.selectedItem].url)},null,8,$)])]),(0,n.Lk)("div",X,[t[10]||(t[10]=(0,n.Lk)("div",{class:"attr"},"Peers",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[B.selectedItem].peers||0)},null,8,A)]),s.transfers[B.selectedItem].start_date?((0,n.uX)(),(0,n.CE)("div",D,[t[11]||(t[11]=(0,n.Lk)("div",{class:"attr"},"Started",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.formatDateTime(s.transfers[B.selectedItem].start_date))},null,8,F)])):(0,n.Q3)("",!0),s.transfers[B.selectedItem].finish_date?((0,n.uX)(),(0,n.CE)("div",N,[t[12]||(t[12]=(0,n.Lk)("div",{class:"attr"},"Finished",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.formatDateTime(s.transfers[B.selectedItem].finish_date))},null,8,Q)])):(0,n.Q3)("",!0),s.transfers[B.selectedItem].save_path?((0,n.uX)(),(0,n.CE)("div",U,[t[13]||(t[13]=(0,n.Lk)("div",{class:"attr"},"Save path",-1)),(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[B.selectedItem].save_path)},null,8,R)])):(0,n.Q3)("",!0),s.transfers[B.selectedItem].files?((0,n.uX)(),(0,n.CE)("div",O,[t[14]||(t[14]=(0,n.Lk)("div",{class:"attr"},"Files",-1)),(0,n.Lk)("div",q,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.transfers[B.selectedItem].files,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"file",key:t},[(0,n.Lk)("a",{href:`/file?path=${encodeURIComponent(e)}`,target:"_blank",textContent:(0,a.v_)(e)},null,8,V)])))),128))])])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)])),_:1},512),(0,n.bF)(J,{ref:"torrentFiles",title:"Torrent files",width:"80%"},{default:(0,n.k6)((()=>[null!=B.selectedItem&&s.transfers[B.selectedItem]?((0,n.uX)(),(0,n.CE)("div",P,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(K.relativeFiles,((t,l)=>((0,n.uX)(),(0,n.CE)("div",{class:"row",key:t},[(0,n.Lk)("div",j,[s.isMedia&&e.mediaExtensions.has(t.split(".").pop())?((0,n.uX)(),(0,n.Wv)(G,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(Y,{"icon-class":"fa fa-play",text:"Play",onInput:t=>e.$emit("play",{url:`file://${s.transfers[B.selectedItem].files[l]}`,type:"file"})},null,8,["onInput"])])),_:2},1024)):((0,n.uX)(),(0,n.CE)("i",H))]),(0,n.Lk)("div",{class:"col-11 name",textContent:(0,a.v_)(t)},null,8,W)])))),128))])):(0,n.Q3)("",!0)])),_:1},512)]))}var B=s(9828),K=s(2002),M=s(226),Y=s(9513),G=s(9265),J=s(9612),Z={emits:["pause","play","play-with-captions","refresh","remove","resume"],components:{Dropdown:G.A,DropdownItem:J.A,Loading:B.A,Modal:Y.A},mixins:[K.A,M.A],props:{isMedia:{type:Boolean,default:!1},transfers:{type:Object,default:()=>({})}},data(){return{loading:!1,selectedItem:null}},computed:{relativeFiles(){return null!=this.selectedItem&&this.transfers[this.selectedItem]?.files?.length?this.transfers[this.selectedItem].files.map((e=>e.split("/").pop())):[]}}},ee=s(6262);const te=(0,ee.A)(Z,[["render",z],["__scopeId","data-v-65e233cd"]]);var se=te}}]);
//# sourceMappingURL=1671.4d1a8fec.js.map
"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[472],{472:function(e,a,l){l.r(a),l.d(a,{default:function(){return Q}});var s=l(6252),t=l(3577),i=l(9963);const n=e=>((0,s.dD)("data-v-f6d939d8"),e=e(),(0,s.Cn)(),e),o={class:"entity alarm-container"},d={class:"icon col-1"},u={class:"label col-5"},c=["textContent"],r={key:0,class:"value"},v={key:1,class:"value"},m={key:2,class:"value"},h={key:3,class:"value next-run"},p=["textContent"],f=["textContent"],g={class:"child enable"},b=["for"],_=n((()=>(0,s._)("div",{class:"name col-6"},"Enabled",-1))),k={class:"value col-6"},w={key:0,class:"child buttons"},y={key:0,class:"label col-6"},C={class:"value"},D=n((()=>(0,s._)("i",{class:"fas fa-pause"},null,-1))),x={class:"value"},z=n((()=>(0,s._)("i",{class:"fas fa-times"},null,-1))),I=n((()=>(0,s._)("label",{class:"label"},[(0,s._)("div",{class:"value"},[(0,s._)("i",{class:"fas fa-trash"}),(0,s.Uk)("   Remove ")])],-1))),$=[I],R={key:2,class:"child edit"},S=n((()=>(0,s._)("div",{class:"label name col-11"},[(0,s._)("i",{class:"fas fa-pen-to-square"}),(0,s.Uk)("  Edit ")],-1))),E={class:"value col-1 collapse-toggler"},q={class:"alarm-running-modal"},U=n((()=>(0,s._)("div",{class:"icon blink"},[(0,s._)("i",{class:"fas fa-stopwatch"})],-1))),M={class:"title"},N={class:"buttons"},A={class:"label"},Z=n((()=>(0,s._)("i",{class:"fas fa-pause"},null,-1))),O={class:"label"},W=n((()=>(0,s._)("i",{class:"fas fa-times"},null,-1)));function T(e,a,l,n,I,T){const G=(0,s.up)("EntityIcon"),j=(0,s.up)("ToggleSwitch"),L=(0,s.up)("AlarmEditor"),P=(0,s.up)("Modal"),B=(0,s.up)("ConfirmDialog");return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",{class:(0,t.C_)(["head",{collapsed:e.collapsed}])},[(0,s._)("div",d,[(0,s.Wm)(G,{entity:e.value,loading:e.loading,error:e.error},null,8,["entity","loading","error"])]),(0,s._)("div",u,[(0,s._)("div",{class:"name",textContent:(0,t.zw)(e.value.name)},null,8,c)]),(0,s._)("div",{class:"value-and-toggler col-8",onClick:a[1]||(a[1]=(0,i.iM)((a=>e.collapsed=!e.collapsed),["stop"]))},[e.value.enabled?T.isRunning?((0,s.wg)(),(0,s.iD)("div",v,"Running")):T.isSnoozed?((0,s.wg)(),(0,s.iD)("div",m,"Snoozed")):T.nextRun?((0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("div",{class:"date",textContent:(0,t.zw)(T.nextRun.toDateString())},null,8,p),(0,s._)("div",{class:"time",textContent:(0,t.zw)(T.nextRun.toLocaleTimeString())},null,8,f)])):(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",r,"Disabled")),(0,s._)("div",{class:"collapse-toggler",onClick:a[0]||(a[0]=(0,i.iM)((a=>e.collapsed=!e.collapsed),["stop"]))},[(0,s._)("i",{class:(0,t.C_)(["fas",{"fa-chevron-down":e.collapsed,"fa-chevron-up":!e.collapsed}])},null,2)])])],2),e.collapsed?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",{key:0,class:"body children",onClick:a[6]||(a[6]=(0,i.iM)(((...e)=>T.prevent&&T.prevent(...e)),["stop"]))},[(0,s._)("div",g,[(0,s._)("label",{for:T.enableInputId,class:"label"},[_,(0,s._)("div",k,[(0,s.Wm)(j,{id:T.enableInputId,value:e.value.enabled,onInput:T.setEnabled},null,8,["id","value","onInput"])])],8,b)]),T.isRunning||T.isSnoozed?((0,s.wg)(),(0,s.iD)("div",w,[T.isRunning?((0,s.wg)(),(0,s.iD)("label",y,[(0,s._)("div",C,[(0,s._)("button",{class:"btn btn-default",onClick:a[2]||(a[2]=(...e)=>T.snooze&&T.snooze(...e))},[D,(0,s.Uk)("   Snooze ")])])])):(0,s.kq)("",!0),(0,s._)("label",{class:(0,t.C_)(["label",{"col-6":T.isRunning,"col-12":!T.isRunning}])},[(0,s._)("div",x,[(0,s._)("button",{class:"btn btn-default",onClick:a[3]||(a[3]=(...e)=>T.dismiss&&T.dismiss(...e))},[z,(0,s.Uk)("   Dismiss ")])])],2)])):(0,s.kq)("",!0),T.hasEdit?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"child remove",onClick:a[4]||(a[4]=(...a)=>e.$refs.removeDialog.show&&e.$refs.removeDialog.show(...a))},$)):(0,s.kq)("",!0),T.hasEdit?((0,s.wg)(),(0,s.iD)("div",R,[(0,s._)("div",{class:(0,t.C_)(["head",{collapsed:e.editCollapsed}]),onClick:a[5]||(a[5]=(0,i.iM)((a=>e.editCollapsed=!e.editCollapsed),["stop"]))},[S,(0,s._)("div",E,[(0,s._)("i",{class:(0,t.C_)(["fas",{"fa-chevron-down":e.editCollapsed,"fa-chevron-up":!e.editCollapsed}])},null,2)])],2),e.editCollapsed?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(L,{key:0,value:e.value},null,8,["value"]))])):(0,s.kq)("",!0)])),(0,s.Wm)(P,{title:"Alarm Running",ref:"runningModal",visible:T.isRunning},{default:(0,s.w5)((()=>[(0,s._)("div",q,[U,(0,s._)("div",M,[(0,s._)("h3",null,[(0,s._)("b",null,(0,t.zw)(e.value.name),1),(0,s.Uk)(" is running")])]),(0,s._)("div",N,[(0,s._)("label",A,[(0,s._)("button",{class:"btn btn-default",onClick:a[7]||(a[7]=(...e)=>T.snooze&&T.snooze(...e))},[Z,(0,s.Uk)("   Snooze ")])]),(0,s._)("label",O,[(0,s._)("button",{class:"btn btn-default",onClick:a[8]||(a[8]=(...e)=>T.dismiss&&T.dismiss(...e))},[W,(0,s.Uk)("   Dismiss ")])])])])])),_:1},8,["visible"]),(0,s.Wm)(B,{ref:"removeDialog",onInput:T.remove},{default:(0,s.w5)((()=>[(0,s.Uk)(" Are you sure you want to remove alarm "),(0,s._)("b",null,(0,t.zw)(e.value.name),1),(0,s.Uk)("? ")])),_:1},8,["onInput"])])}var G=l(9381),j=l(7833),L=l(847),P=l(4967),B=l(5166),F=l(7514),H={mixins:[L["default"]],emits:["loading"],components:{AlarmEditor:G["default"],ConfirmDialog:j.Z,EntityIcon:P["default"],Modal:B.Z,ToggleSwitch:F.Z},data:function(){return{collapsed:!0,editCollapsed:!0}},computed:{hasEdit(){return!this.value.static},isCollapsed(){return this.collapsed},isRunning(){return"RUNNING"===this.value.state},isSnoozed(){return"SNOOZED"===this.value.state},nextRun(){return this.value.next_run&&this.value.enabled?new Date(1e3*this.value.next_run):null},enableInputId(){return`alarm-input-${this.value.name}`}},methods:{async setEnabled(){this.$emit("loading",!0);try{await this.request("alarm.set_enabled",{name:this.value.external_id,enabled:!this.value.enabled}),await this.refresh()}finally{this.$emit("loading",!1)}},async snooze(){this.$emit("loading",!0);try{await this.request("alarm.snooze"),await this.refresh()}finally{this.$emit("loading",!1)}},async dismiss(){this.$emit("loading",!0);try{await this.request("alarm.dismiss"),await this.refresh()}finally{this.$emit("loading",!1)}},async refresh(){this.$emit("loading",!0);try{await this.request("alarm.status")}finally{this.$emit("loading",!1)}},async remove(){this.$emit("loading",!0);try{await this.request("alarm.delete",{name:this.value.name})}finally{this.$emit("loading",!1)}},prevent(e){e.stopPropagation()}},mounted(){this.$watch((()=>this.value),((e,a)=>{if(e?.state!==a?.state){const a={image:{icon:"stopwatch"}};switch(e?.state){case"RUNNING":a.text=`Alarm ${e.name} is running`;break;case"SNOOZED":a.text=`Alarm ${e.name} has been snoozed`;break;case"DISMISSED":a.text=`Alarm ${e.name} has been dismissed`;break}a.text&&this.notify(a)}}))}},J=l(3744);const K=(0,J.Z)(H,[["render",T],["__scopeId","data-v-f6d939d8"]]);var Q=K}}]);
//# sourceMappingURL=472.bf7d503c.js.map
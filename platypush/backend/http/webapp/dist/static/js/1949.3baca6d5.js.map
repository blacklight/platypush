{"version":3,"file":"static/js/1949.3baca6d5.js","mappings":"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","sources":["webpack://platypush/./src/components/elements/FloatingButton.vue","webpack://platypush/./src/components/elements/FloatingButton.vue?d72c","webpack://platypush/./src/components/panels/Alarm/Index.vue","webpack://platypush/./src/components/panels/Alarm/Index.vue?d928"],"sourcesContent":["<template>\n  <div class=\"floating-btn\" :class=\"className\">\n    <button type=\"button\" class=\"btn btn-primary\" :title=\"title\" @click=\"$emit('click', $event)\">\n      <Icon :class=\"iconClass\" :url=\"iconUrl\" />\n    </button>\n  </div>\n</template>\n\n<script>\nimport Icon from \"@/components/elements/Icon\";\n\nexport default {\n  name: \"FloatingButton\",\n  components: {Icon},\n  emits: [\"click\"],\n\n  props: {\n    iconClass: {\n      type: String,\n    },\n    iconUrl: {\n      type: String,\n    },\n    class: {\n      type: String,\n    },\n    title: {\n      type: String,\n    },\n  },\n\n  computed: {\n    className() {\n      return this.class\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.floating-btn {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  margin: auto 1em 1em auto;\n\n  button {\n    background: $tile-bg !important;\n    color: $tile-fg !important;\n    width: 4em;\n    height: 4em;\n    border-radius: 2em;\n    border: none !important;\n    padding: 0;\n    box-shadow: $border-shadow-bottom-right;\n\n    &:hover {\n      background: $tile-hover-bg !important;\n    }\n  }\n\n  :deep(button) {\n    .icon-container {\n      width: 4em;\n\n      .icon {\n        margin: auto;\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./FloatingButton.vue?vue&type=template&id=f812ef1c&scoped=true\"\nimport script from \"./FloatingButton.vue?vue&type=script&lang=js\"\nexport * from \"./FloatingButton.vue?vue&type=script&lang=js\"\n\nimport \"./FloatingButton.vue?vue&type=style&index=0&id=f812ef1c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f812ef1c\"]])\n\nexport default __exports__","<template>\n  <Loading v-if=\"loading\" />\n\n  <NoItems v-else-if=\"!Object.keys(alarms).length\">\n    No alarms configured\n  </NoItems>\n\n  <div class=\"alarms-container\" v-else>\n    <div class=\"alarms items\">\n      <div class=\"item\" v-for=\"alarm in alarms\" :key=\"alarm.external_id\">\n        <Entity :value=\"alarm\" @show-modal=\"selectedAlarm = alarm.external_id\" />\n      </div>\n    </div>\n  </div>\n\n  <EntityModal\n    :entity=\"alarms[selectedAlarm]\"\n    :visible=\"modalVisible\"\n    :config-values=\"{}\"\n    @close=\"selectedAlarm = null\"\n    v-if=\"modalVisible\" />\n\n  <Modal title=\"Add Alarm\" :visible=\"addAlarmModalVisible\" @close=\"addAlarmModalVisible = false\">\n    <AlarmEditor :value=\"newAlarm\" new-alarm @input=\"addAlarm\" v-if=\"addAlarmModalVisible\" />\n  </Modal>\n\n  <FloatingButton icon-class=\"fa fa-stopwatch\" text=\"Add Alarm\"\n                  @click=\"addAlarmModalVisible = true\" />\n</template>\n\n<script>\nimport AlarmEditor from \"@/components/panels/Entities/Alarm/AlarmEditor\";\nimport Loading from \"@/components/Loading\";\nimport EntityModal from \"@/components/panels/Entities/Modal\";\nimport Entity from \"@/components/panels/Entities/Entity\";\nimport FloatingButton from \"@/components/elements/FloatingButton\";\nimport Modal from \"@/components/Modal\";\nimport NoItems from \"@/components/elements/NoItems\";\nimport Utils from \"@/Utils\";\n\nexport default {\n  components: {\n    AlarmEditor,\n    Entity,\n    EntityModal,\n    FloatingButton,\n    Loading,\n    Modal,\n    NoItems,\n  },\n\n  mixins: [Utils],\n  props: {\n    pluginName: {\n      type: String,\n    },\n\n    config: {\n      type: Object,\n      default: () => {},\n    },\n  },\n\n  data() {\n    return {\n      loading: false,\n      addAlarmModalVisible: false,\n      alarms: {},\n      selectedAlarm: null,\n      newAlarm: {\n        condition_type: 'cron',\n        when: '* * * * *',\n        audio_volume: this.$root.config?.alarm?.audio_volume ?? 100,\n        media_repeat: true,\n      },\n    }\n  },\n\n  computed: {\n    modalVisible() {\n      return this.alarms[this.selectedAlarm] != null\n    },\n  },\n\n  methods: {\n    addAlarm(alarm) {\n      if (alarm.external_id == null)\n        return\n\n      alarm.name = alarm?.meta?.name_override || alarm.name\n      alarm.meta = {\n        ...alarm.meta,\n        icon: {\n          'class': (alarm.meta?.icon?.['class'] || 'fas fa-stopwatch'),\n        },\n      }\n\n      this.alarms[alarm.external_id] = alarm\n      this.addAlarmModalVisible = false\n    },\n\n    async refresh() {\n      this.$emit('loading', true)\n      try {\n        await this.request('alarm.status');\n        (await this.request('entities.get', {plugins: [this.pluginName]})).forEach(\n          entity => this.addAlarm(entity)\n        )\n      } finally {\n        this.$emit('loading', false)\n      }\n    },\n\n    async onEntityUpdate(msg) {\n      const entity = msg?.entity\n      if (entity?.plugin !== this.pluginName)\n        return\n\n      this.addAlarm(entity)\n    },\n\n    async onEntityDelete(msg) {\n      const entity = msg?.entity\n      if (entity?.plugin !== this.pluginName)\n        return\n\n      if (this.selectedAlarm === entity.external_id)\n        this.selectedAlarm = null\n\n      if (this.alarms[entity.external_id])\n        delete this.alarms[entity.external_id]\n    },\n  },\n\n  mounted() {\n    this.refresh()\n\n    this.subscribe(\n      this.onEntityUpdate,\n      'on-alarm-entity-update',\n      'platypush.message.event.entities.EntityUpdateEvent'\n    )\n\n    this.subscribe(\n      this.onEntityDelete,\n      'on-alarm-entity-delete',\n      'platypush.message.event.entities.EntityDeleteEvent'\n    )\n  },\n\n  unmounted() {\n    this.unsubscribe('on-alarm-entity-update')\n    this.unsubscribe('on-alarm-entity-delete')\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.alarms-container {\n  display: flex;\n  height: 100%;\n  background: $default-bg-6;\n  flex-grow: 1;\n  overflow-y: auto;\n  justify-content: center;\n\n  .alarms {\n    @include until($tablet) {\n      width: 100%;\n    }\n\n    @include from($tablet) {\n      width: calc(100% - 2em);\n      margin-top: 1em;\n      border-radius: 1em;\n    }\n\n    max-width: 800px;\n    background: $default-bg-2;\n    display: flex;\n    flex-direction: column;\n    margin-bottom: auto;\n    box-shadow: $border-shadow-bottom-right;\n\n    :deep(.item) {\n      .entity-container {\n        &:first-child {\n          border-top-left-radius: 1em;\n          border-top-right-radius: 1em;\n        }\n\n        &:last-child {\n          border-bottom-left-radius: 1em;\n          border-bottom-right-radius: 1em;\n        }\n      }\n    }\n  }\n}\n\n:deep(.modal) {\n  .content .body {\n    padding: 0;\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=52431f4a&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=52431f4a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-52431f4a\"]])\n\nexport default __exports__"],"names":["_createElementBlock","class","_normalizeClass","$options","className","_createElementVNode","type","title","$props","onClick","_cache","$event","_ctx","$emit","_createVNode","_component_Icon","iconClass","url","iconUrl","name","components","Icon","emits","props","String","computed","this","__exports__","render","$data","loading","_createBlock","_component_Loading","key","Object","keys","alarms","length","_hoisted_1","_hoisted_2","_Fragment","_renderList","alarm","external_id","_component_Entity","value","onShowModal","selectedAlarm","_component_NoItems","modalVisible","_component_EntityModal","entity","visible","onClose","_component_Modal","addAlarmModalVisible","_component_AlarmEditor","newAlarm","onInput","addAlarm","_component_FloatingButton","text","AlarmEditor","Entity","EntityModal","FloatingButton","Loading","Modal","NoItems","mixins","Utils","pluginName","config","default","data","condition_type","when","audio_volume","$root","media_repeat","methods","meta","name_override","icon","refresh","request","plugins","forEach","onEntityUpdate","msg","plugin","onEntityDelete","mounted","subscribe","unmounted","unsubscribe"],"sourceRoot":""}
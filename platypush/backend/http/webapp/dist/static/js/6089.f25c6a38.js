"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[6089],{9002:function(e,t,a){a.d(t,{o:function(){return s}});class s{constructor(e){if(this.ranges={hue:[0,360],sat:[0,100],bri:[0,100],ct:[154,500]},e)for(const t of Object.keys(this.ranges))e[t]&&(this.ranges[t]=e[t])}normalize(e,t,a){return a[0]+(e-t[0])*(a[1]-a[0])/(t[1]-t[0])}hslToRgb(e,t,a){[e,t,a]=[this.normalize(e,this.ranges.hue,[0,360]),this.normalize(t,this.ranges.sat,[0,100]),this.normalize(a,this.ranges.bri,[0,100])],a/=100;const s=t*Math.min(a,1-a)/100,l=t=>{const l=(t+e/30)%12,n=a-s*Math.max(Math.min(l-3,9-l,1),-1);return Math.round(255*n)};return[l(0),l(8),l(4)]}rgbToHsl(e,t,a){e/=255,t/=255,a/=255;const s=Math.max(e,t,a),l=Math.min(e,t,a);let n,r,i=(s+l)/2;if(s===l)n=r=0;else{const o=s-l;switch(r=i>.5?o/(2-s-l):o/(s+l),s){case e:n=(t-a)/o+(t<a?6:0);break;case t:n=(a-e)/o+2;break;case a:n=(e-t)/o+4;break}n/=6}return[parseInt(this.normalize(n,[0,1],this.ranges.hue)),parseInt(this.normalize(r,[0,1],this.ranges.sat)),parseInt(this.normalize(i,[0,1],this.ranges.bri))]}xyToRgb(e,t,a){null==a&&(a=this.ranges.bri[1]);const s=1-e-t,l=(a/(this.ranges.bri[1]-1)).toFixed(2),n=l/t*e,r=l/t*s;let i=1.656492*n-.354851*l-.255038*r,o=.707196*-n+1.655397*l+.036152*r,u=.051713*n-.121364*l+1.01153*r;return i>u&&i>o&&i>1?(o/=i,u/=i,i=1):o>u&&o>i&&o>1?(i/=o,u/=o,o=1):u>i&&u>o&&u>1&&(i/=u,o/=u,u=1),i=i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055,o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,u=u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055,i=Math.round(255*i),o=Math.round(255*o),u=Math.round(255*u),isNaN(i)&&(i=0),isNaN(o)&&(o=0),isNaN(u)&&(u=0),[i,o,u].map((e=>Math.min(Math.max(0,e),255)))}rgbToXY(e,t,a){e>1&&(e/=255),t>1&&(t/=255),a>1&&(a/=255),e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92;const s=.664511*e+.154324*t+.162028*a,l=.283881*e+.668433*t+.047685*a,n=88e-6*e+.07231*t+.986039*a;let r=parseFloat((s/(s+l+n)).toFixed(4)),i=parseFloat((l/(s+l+n)).toFixed(4));return isNaN(r)&&(r=0),isNaN(i)&&(i=0),[r,i]}rgbToBri(e,t,a){return Math.min(2*this.rgbToHsl(e,t,a)[2],this.ranges.bri[1])}getRGB(e){return null!=e.red&&null!=e.green&&null!=e.blue?[e.red,e.green,e.blue]:null!=e.r&&null!=e.g&&null!=e.b?[e.r,e.g,e.b]:e.rgb?e.rgb:void 0}getXY(e){return null!=e.x&&null!=e.y?[e.x,e.y]:e.xy?e.xy:void 0}toRGB(e){const t=this.getRGB(e);if(t)return t;const a=this.getXY(e);return a&&e.bri?this.xyToRgb(...a,e.bri):e.hue&&e.sat&&e.bri?this.hslToRgb(e.hue,e.sat,e.bri):(console.debug("Could not determine color space"),void console.debug(e))}toXY(e){const t=this.getXY(e);if(t&&e.bri)return[t[0],t[1],e.bri];const a=this.getRGB(e);if(a)return this.rgbToXY(...a);if(e.hue&&e.sat&&e.bri){const t=this.hslToRgb(e.hue,e.sat,e.bri);return this.rgbToXY(...t)}console.debug("Could not determine color space"),console.debug(e)}toHSL(e){if(e.hue&&e.sat&&e.bri)return[e.hue,e.sat,e.bri];const t=this.getRGB(e);if(t)return this.rgbToHsl(...t);const a=this.getXY(e);if(a&&e.bri){const t=this.xyToRgb(...a,e.bri);return this.rgbToHsl(...t)}console.debug("Could not determine color space"),console.debug(e)}hexToRgb(e){return[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)))}rgbToHex(e){return"#"+e.map((e=>{let t=e.toString(16);return t.length<2&&(t="0"+t),t})).join("")}}},1808:function(e,t,a){a.d(t,{A:function(){return p}});var s=a(641),l=a(33),n=a(3751);const r={class:"slider-wrapper"},i=["textContent"],o=["textContent"],u={class:"slider-container"},h=["min","max","step","disabled","value"],c=["textContent"];function g(e,t,a,g,d,v){return(0,s.uX)(),(0,s.CE)("label",r,[a.withRange?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,l.C4)(["range-labels",{"with-label":a.withLabel}])},[a.withRange?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"label left",textContent:(0,l.v_)(a.range[0])},null,8,i)):(0,s.Q3)("",!0),a.withRange?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"label right",textContent:(0,l.v_)(a.range[1])},null,8,o)):(0,s.Q3)("",!0)],2)):(0,s.Q3)("",!0),(0,s.Lk)("span",u,[(0,s.Lk)("input",{class:(0,l.C4)(["slider",{"with-label":a.withLabel}]),type:"range",min:a.range[0],max:a.range[1],step:a.step,disabled:a.disabled,value:a.value,ref:"range",onInput:t[0]||(t[0]=(0,n.D$)((t=>e.$emit("input",t)),["stop"])),onChange:t[1]||(t[1]=(0,n.D$)((t=>e.$emit("change",t)),["stop"]))},null,42,h),a.withLabel?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"label",textContent:(0,l.v_)(a.value),ref:"label"},null,8,c)):(0,s.Q3)("",!0)])])}var d={emits:["input","change"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:()=>[0,100]},step:{type:Number,default:1},withLabel:{type:Boolean,default:!1},withRange:{type:Boolean,default:!1}}},v=a(6262);const b=(0,v.A)(d,[["render",g],["__scopeId","data-v-d90e850c"]]);var p=b},11:function(e,t,a){a.d(t,{A:function(){return g}});var s=a(641),l=a(33),n=a(3751);const r=["checked","id"],i={class:"label"};function o(e,t,a,o,u,h){return(0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(["power-switch",{disabled:a.disabled}]),onClick:t[0]||(t[0]=(0,n.D$)(((...e)=>h.onInput&&h.onInput(...e)),["stop"]))},[(0,s.Lk)("input",{type:"checkbox",checked:a.value,id:a.id},null,8,r),(0,s.Lk)("label",null,[t[1]||(t[1]=(0,s.Lk)("div",{class:"switch"},[(0,s.Lk)("div",{class:"dot"})],-1)),(0,s.Lk)("span",i,[(0,s.RG)(e.$slots,"default",{},void 0,!0)])])],2)}var u={name:"ToggleSwitch",emits:["input"],props:{id:{type:String},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput(e){if(this.disabled)return!1;this.$emit("input",e)}}},h=a(6262);const c=(0,h.A)(u,[["render",o],["__scopeId","data-v-eff375b6"]]);var g=c},8470:function(e,t,a){a.r(t),a.d(t,{default:function(){return M}});var s=a(641),l=a(33),n=a(3751);const r={class:"entity light-container"},i={class:"icon"},o={class:"label"},u=["textContent"],h={class:"value-container"},c={key:0,class:"row"},g={class:"input"},d=["value"],v={key:1,class:"row"},b={class:"input"},p={key:2,class:"row"},m={class:"input"},C={key:3,class:"row"},f={class:"input"};function k(e,t,a,k,y,x){const L=(0,s.g2)("EntityIcon"),w=(0,s.g2)("ToggleSwitch"),_=(0,s.g2)("Slider");return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("div",{class:(0,l.C4)(["head",{collapsed:e.collapsed}])},[(0,s.Lk)("div",i,[(0,s.bF)(L,{entity:e.value,icon:x.icon,hasColorFill:!0,loading:e.loading,error:e.error},null,8,["entity","icon","loading","error"])]),(0,s.Lk)("div",o,[(0,s.Lk)("div",{class:"name",textContent:(0,l.v_)(e.value.name)},null,8,u)]),(0,s.Lk)("div",h,[(0,s.bF)(w,{value:e.value.on,onInput:x.toggle,onClick:t[0]||(t[0]=(0,n.D$)((()=>{}),["stop"])),disabled:e.loading||e.value.is_read_only},null,8,["value","onInput","disabled"]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(0,n.D$)((t=>e.collapsed=!e.collapsed),["stop"]))},[(0,s.Lk)("i",{class:(0,l.C4)(["fas",{"fa-angle-up":!e.collapsed,"fa-angle-down":e.collapsed}])},null,2)])])],2),e.collapsed?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:"body",onClick:t[6]||(t[6]=(0,n.D$)(((...e)=>x.prevent&&x.prevent(...e)),["stop"]))},[x.cssColor?((0,s.uX)(),(0,s.CE)("div",c,[t[7]||(t[7]=(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-palette"})],-1)),(0,s.Lk)("div",g,[(0,s.Lk)("input",{type:"color",value:x.cssColor,onChange:t[2]||(t[2]=e=>x.setLight({color:e.target.value}))},null,40,d)])])):(0,s.Q3)("",!0),e.value.brightness?((0,s.uX)(),(0,s.CE)("div",v,[t[8]||(t[8]=(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-sun"})],-1)),(0,s.Lk)("div",b,[(0,s.bF)(_,{range:[e.value.brightness_min,e.value.brightness_max],value:e.value.brightness,onChange:t[3]||(t[3]=e=>x.setLight({brightness:e.target.value}))},null,8,["range","value"])])])):(0,s.Q3)("",!0),e.value.saturation?((0,s.uX)(),(0,s.CE)("div",p,[t[9]||(t[9]=(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-droplet"})],-1)),(0,s.Lk)("div",m,[(0,s.bF)(_,{range:[e.value.saturation_min,e.value.saturation_max],value:e.value.saturation,onChange:t[4]||(t[4]=e=>x.setLight({saturation:e.target.value}))},null,8,["range","value"])])])):(0,s.Q3)("",!0),e.value.temperature?((0,s.uX)(),(0,s.CE)("div",C,[t[10]||(t[10]=(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-temperature-half"})],-1)),(0,s.Lk)("div",f,[(0,s.bF)(_,{range:[e.value.temperature_min,e.value.temperature_max],value:e.value.temperature,onChange:t[5]||(t[5]=e=>x.setLight({temperature:e.target.value}))},null,8,["range","value"])])])):(0,s.Q3)("",!0)]))])}var y=a(1808),x=a(11),L=a(4897),w=a(1029),_=a(9002),T={name:"Light",components:{ToggleSwitch:x.A,Slider:y.A,EntityIcon:w["default"]},mixins:[L["default"]],data(){return{colorConverter:null}},computed:{rgbColor(){return this.value.meta?.icon?.color?this.value.meta.icon.color:this.value.red&&this.value.green&&this.value.blue?["red","green","blue"].map((e=>this.value[e])):this.colorConverter&&(null!=this.value.hue||null!=this.value.x&&null!=this.value.y)?this.value.x&&this.value.y?this.colorConverter.xyToRgb(this.value.x,this.value.y,this.value.brightness):this.colorConverter.hslToRgb(this.value.hue,this.value.saturation,this.value.brightness):void 0},cssColor(){const e=this.rgbColor;return e?this.colorConverter.rgbToHex(e):null},icon(){const e={...this.value.meta?.icon||{}};return!e.color&&this.cssColor&&(e.color=this.cssColor),e}},methods:{prevent(e){return e.stopPropagation(),!1},async toggle(e){e.stopPropagation(),this.$emit("loading",!0);try{await this.request("entities.execute",{id:this.value.id,action:"toggle"})}finally{this.$emit("loading",!1)}},async setLight(e){if(e.color){const t=this.colorConverter.hexToRgb(e.color);null!=this.value.x&&null!=this.value.y?e.xy=this.colorConverter.rgbToXY(...t):null!=this.value.hue?[e.hue,e.saturation,e.brightness]=this.colorConverter.rgbToHsl(...t):null!=this.value.red&&null!=this.value.green&&null!=this.value.blue?[e.red,e.green,e.blue]=[t.red,t.green,t.blue]:(console.warn("Unrecognized color format"),console.warn(e.color)),delete e.color}this.execute({type:"request",action:this.value.plugin+".set_lights",args:{lights:[this.value.external_id],...e}})}},mounted(){const e={};this.value.hue&&(e.hue=[this.value.hue_min,this.value.hue_max]),this.value.saturation&&(e.sat=[this.value.saturation_min,this.value.saturation_max]),this.value.brightness&&(e.bri=[this.value.brightness_min,this.value.brightness_max]),this.value.temperature&&(e.ct=[this.value.temperature_min,this.value.temperature_max]),this.colorConverter=new _.o(e)},unmounted(){this.colorConverter&&delete this.colorConverter}},X=a(6262);const R=(0,X.A)(T,[["render",k],["__scopeId","data-v-6d7f09ba"]]);var M=R}}]);
//# sourceMappingURL=6089.f25c6a38.js.map
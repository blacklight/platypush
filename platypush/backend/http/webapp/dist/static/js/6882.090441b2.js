"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[6882],{4212:function(e,t,i){i.d(t,{N:function(){return s}});class s{constructor(e){if(this.ranges={hue:[0,360],sat:[0,100],bri:[0,100],ct:[154,500]},e)for(const t of Object.keys(this.ranges))e[t]&&(this.ranges[t]=e[t])}normalize(e,t,i){return i[0]+(e-t[0])*(i[1]-i[0])/(t[1]-t[0])}hslToRgb(e,t,i){[e,t,i]=[this.normalize(e,this.ranges.hue,[0,360]),this.normalize(t,this.ranges.sat,[0,100]),this.normalize(i,this.ranges.bri,[0,100])],i/=100;const s=t*Math.min(i,1-i)/100,a=t=>{const a=(t+e/30)%12,n=i-s*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*n)};return[a(0),a(8),a(4)]}rgbToHsl(e,t,i){e/=255,t/=255,i/=255;const s=Math.max(e,t,i),a=Math.min(e,t,i);let n,l,o=(s+a)/2;if(s===a)n=l=0;else{const r=s-a;switch(l=o>.5?r/(2-s-a):r/(s+a),s){case e:n=(t-i)/r+(t<i?6:0);break;case t:n=(i-e)/r+2;break;case i:n=(e-t)/r+4;break}n/=6}return[parseInt(this.normalize(n,[0,1],this.ranges.hue)),parseInt(this.normalize(l,[0,1],this.ranges.sat)),parseInt(this.normalize(o,[0,1],this.ranges.bri))]}xyToRgb(e,t,i){null==i&&(i=this.ranges.bri[1]);const s=1-e-t,a=(i/(this.ranges.bri[1]-1)).toFixed(2),n=a/t*e,l=a/t*s;let o=1.656492*n-.354851*a-.255038*l,r=.707196*-n+1.655397*a+.036152*l,d=.051713*n-.121364*a+1.01153*l;return o>d&&o>r&&o>1?(r/=o,d/=o,o=1):r>d&&r>o&&r>1?(o/=r,d/=r,r=1):d>o&&d>r&&d>1&&(o/=d,r/=d,d=1),o=o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055,r=r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055,d=d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055,o=Math.round(255*o),r=Math.round(255*r),d=Math.round(255*d),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(d)&&(d=0),[o,r,d].map((e=>Math.min(Math.max(0,e),255)))}rgbToXY(e,t,i){e>1&&(e/=255),t>1&&(t/=255),i>1&&(i/=255),e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;const s=.664511*e+.154324*t+.162028*i,a=.283881*e+.668433*t+.047685*i,n=88e-6*e+.07231*t+.986039*i;let l=parseFloat((s/(s+a+n)).toFixed(4)),o=parseFloat((a/(s+a+n)).toFixed(4));return isNaN(l)&&(l=0),isNaN(o)&&(o=0),[l,o]}rgbToBri(e,t,i){return Math.min(2*this.rgbToHsl(e,t,i)[2],this.ranges.bri[1])}getRGB(e){return null!=e.red&&null!=e.green&&null!=e.blue?[e.red,e.green,e.blue]:null!=e.r&&null!=e.g&&null!=e.b?[e.r,e.g,e.b]:e.rgb?e.rgb:void 0}getXY(e){return null!=e.x&&null!=e.y?[e.x,e.y]:e.xy?e.xy:void 0}toRGB(e){const t=this.getRGB(e);if(t)return t;const i=this.getXY(e);return i&&e.bri?this.xyToRgb(...i,e.bri):e.hue&&e.sat&&e.bri?this.hslToRgb(e.hue,e.sat,e.bri):(console.debug("Could not determine color space"),void console.debug(e))}toXY(e){const t=this.getXY(e);if(t&&e.bri)return[t[0],t[1],e.bri];const i=this.getRGB(e);if(i)return this.rgbToXY(...i);if(e.hue&&e.sat&&e.bri){const t=this.hslToRgb(e.hue,e.sat,e.bri);return this.rgbToXY(...t)}console.debug("Could not determine color space"),console.debug(e)}toHSL(e){if(e.hue&&e.sat&&e.bri)return[e.hue,e.sat,e.bri];const t=this.getRGB(e);if(t)return this.rgbToHsl(...t);const i=this.getXY(e);if(i&&e.bri){const t=this.xyToRgb(...i,e.bri);return this.rgbToHsl(...t)}console.debug("Could not determine color space"),console.debug(e)}hexToRgb(e){return[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)))}rgbToHex(e){return"#"+e.map((e=>{let t=e.toString(16);return t.length<2&&(t="0"+t),t})).join("")}}},4904:function(e,t,i){i.d(t,{Z:function(){return w}});var s=i(6252),a=i(9963),n=i(3577);const l={class:"dropdown-container"},o=["title"],r=["textContent"],d={class:"body-container hidden",ref:"dropdownContainer"};function c(e,t,i,c,u,p){const v=(0,s.up)("DropdownBody");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("button",{title:i.title,ref:"button",onClick:t[0]||(t[0]=(0,a.iM)((e=>p.toggle(e)),["stop"]))},[i.iconClass?((0,s.wg)(),(0,s.iD)("i",{key:0,class:(0,n.C_)(["icon",i.iconClass])},null,2)):(0,s.kq)("",!0),i.text?((0,s.wg)(),(0,s.iD)("span",{key:1,class:"text",textContent:(0,n.zw)(i.text)},null,8,r)):(0,s.kq)("",!0)],8,o),(0,s._)("div",d,[(0,s.Wm)(v,{id:i.id,keepOpenOnItemClick:i.keepOpenOnItemClick,ref:"dropdown",onClick:p.onClick},{default:(0,s.w5)((()=>[(0,s.WI)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","onClick"])],512)])}const u=["id"];function p(e,t,i,a,n,l){return(0,s.wg)(),(0,s.iD)("div",{class:"dropdown",id:i.id,onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,s.WI)(e.$slots,"default",{},void 0,!0)],8,u)}var v={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1}}},h=i(3744);const m=(0,h.Z)(v,[["render",p],["__scopeId","data-v-14579c63"]]);var g=m,b=i(5250),f={components:{DropdownBody:g},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1}},data(){return{visible:!1}},computed:{buttonStyle(){return this.$refs.button?getComputedStyle(this.$refs.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),b.$.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$refs.dropdownContainer.classList.remove("hidden"),this.$nextTick((()=>{const e=this.$refs.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},i={left:t.left,top:t.top+this.buttonHeight},s=this.getDropdownWidth(),a=this.getDropdownHeight();i.left+s>(window.innerWidth+window.scrollX)/2&&(i.left-=s-this.buttonWidth),i.top+a>(window.innerHeight+window.scrollY)/2&&(i.top-=a+this.buttonHeight-10);const n=this.$refs.dropdown.$el;n.classList.add("fade-in"),n.style.top=`${i.top}px`,n.style.left=`${i.left}px`,b.$.emit("dropdown-open",this.$refs.dropdown),this.$refs.dropdownContainer.classList.add("hidden")}))},toggle(e){e.stopPropagation(),this.$emit("click"),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}};const y=(0,h.Z)(f,[["render",c],["__scopeId","data-v-f096e0a0"]]);var w=y},7597:function(e,t,i){i.d(t,{Z:function(){return h}});var s=i(6252),a=i(3577);const n=["title"],l={key:0,class:"col-2 icon"},o=["textContent"];function r(e,t,i,r,d,c){const u=(0,s.up)("Icon");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["row item",{...c.itemClass_,disabled:i.disabled}]),title:i.hoverText,onClick:t[0]||(t[0]=(...e)=>c.clicked&&c.clicked(...e))},[i.iconClass?.length||i.iconUrl?.length?((0,s.wg)(),(0,s.iD)("div",l,[(0,s.Wm)(u,{class:(0,a.C_)(i.iconClass),url:i.iconUrl},null,8,["class","url"])])):(0,s.kq)("",!0),(0,s._)("div",{class:(0,a.C_)(["text",{"col-10":null!=i.iconClass}]),textContent:(0,a.zw)(i.text)},null,10,o)],10,n)}var d=i(657),c=i(5250),u={components:{Icon:d.Z},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||c.$.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},p=i(3744);const v=(0,p.Z)(u,[["render",r],["__scopeId","data-v-2babe09c"]]);var h=v},657:function(e,t,i){i.d(t,{Z:function(){return u}});var s=i(6252),a=i(3577);const n={class:"icon-container"},l=["src","alt"];function o(e,t,i,o,r,d){return(0,s.wg)(),(0,s.iD)("div",n,[i.url?.length?((0,s.wg)(),(0,s.iD)("img",{key:0,class:"icon",src:i.url,alt:i.alt},null,8,l)):d.className?.length?((0,s.wg)(),(0,s.iD)("i",{key:1,class:(0,a.C_)(["icon",d.className]),style:(0,a.j5)({color:i.color})},null,6)):(0,s.kq)("",!0)])}var r={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=i(3744);const c=(0,d.Z)(r,[["render",o],["__scopeId","data-v-706a3bd1"]]);var u=c},8140:function(e,t,i){i.d(t,{Z:function(){return g}});var s=i(6252),a=i(3577),n=i(9963);const l={class:"slider-wrapper"},o=["textContent"],r=["textContent"],d={class:"slider-container"},c=["min","max","step","disabled","value"],u=["textContent"];function p(e,t,i,p,v,h){return(0,s.wg)(),(0,s.iD)("label",l,[i.withRange?((0,s.wg)(),(0,s.iD)("span",{key:0,class:(0,a.C_)(["range-labels",{"with-label":i.withLabel}])},[i.withRange?((0,s.wg)(),(0,s.iD)("span",{key:0,class:"label left",textContent:(0,a.zw)(i.range[0])},null,8,o)):(0,s.kq)("",!0),i.withRange?((0,s.wg)(),(0,s.iD)("span",{key:1,class:"label right",textContent:(0,a.zw)(i.range[1])},null,8,r)):(0,s.kq)("",!0)],2)):(0,s.kq)("",!0),(0,s._)("span",d,[(0,s._)("input",{class:(0,a.C_)(["slider",{"with-label":i.withLabel}]),type:"range",min:i.range[0],max:i.range[1],step:i.step,disabled:i.disabled,value:i.value,ref:"range",onInput:t[0]||(t[0]=(0,n.iM)((t=>e.$emit("input",t)),["stop"])),onChange:t[1]||(t[1]=(0,n.iM)((t=>e.$emit("change",t)),["stop"]))},null,42,c),i.withLabel?((0,s.wg)(),(0,s.iD)("span",{key:0,class:"label",textContent:(0,a.zw)(i.value),ref:"label"},null,8,u)):(0,s.kq)("",!0)])])}var v={emits:["input","change"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:()=>[0,100]},step:{type:Number,default:1},withLabel:{type:Boolean,default:!1},withRange:{type:Boolean,default:!1}}},h=i(3744);const m=(0,h.Z)(v,[["render",p],["__scopeId","data-v-d90e850c"]]);var g=m},7514:function(e,t,i){i.d(t,{Z:function(){return h}});var s=i(6252),a=i(3577),n=i(9963);const l=e=>((0,s.dD)("data-v-eff375b6"),e=e(),(0,s.Cn)(),e),o=["checked","id"],r=l((()=>(0,s._)("div",{class:"switch"},[(0,s._)("div",{class:"dot"})],-1))),d={class:"label"};function c(e,t,i,l,c,u){return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["power-switch",{disabled:i.disabled}]),onClick:t[0]||(t[0]=(0,n.iM)(((...e)=>u.onInput&&u.onInput(...e)),["stop"]))},[(0,s._)("input",{type:"checkbox",checked:i.value,id:i.id},null,8,o),(0,s._)("label",null,[r,(0,s._)("span",d,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])])],2)}var u={name:"ToggleSwitch",emits:["input"],props:{id:{type:String},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput(e){if(this.disabled)return!1;this.$emit("input",e)}}},p=i(3744);const v=(0,p.Z)(u,[["render",c],["__scopeId","data-v-eff375b6"]]);var h=v},6882:function(e,t,i){i.r(t),i.d(t,{default:function(){return pi}});var s=i(6252),a=i(3577);const n={class:"zigbee-container"},l={key:0,class:"info-body"},o={class:"row"},r=(0,s._)("div",{class:"param-name"},"State",-1),d=["textContent"],c={class:"row"},u=(0,s._)("div",{class:"param-name"},"Permit Join",-1),p=["textContent"],v={key:0,class:"row"},h=(0,s._)("div",{class:"param-name"},"Network Channel",-1),m=["textContent"],g={class:"row"},b=(0,s._)("div",{class:"param-name"},"Zigbee2MQTT Version",-1),f=["textContent"],y={key:1,class:"row"},w=(0,s._)("div",{class:"param-name"},"MQTT Server",-1),_=["textContent"],k={key:2,class:"row"},C=(0,s._)("div",{class:"param-name"},"Serial Port",-1),x=["textContent"],q={key:3,class:"row"},D=(0,s._)("div",{class:"param-name"},"Firmware Type",-1),z=["textContent"],I={key:4,class:"row"},M=(0,s._)("div",{class:"param-name"},"Firmware Version",-1),Z={class:"param-value"},$={key:5,class:"row"},S=(0,s._)("div",{class:"param-name"},"Firmware Revision",-1),R=["textContent"],G={class:"view-options"},N={class:"view-selector col-s-8 col-m-9 col-l-10"},T=["value"],E=["textContent","selected","value"],O={class:"buttons"},V=["disabled"],j=(0,s._)("i",{class:"fa fa-plus"},null,-1),A=[j],L=["disabled"],B=(0,s._)("i",{class:"fa fa-sync-alt"},null,-1),F=[B],H={class:"view-container"},U={key:0,class:"view devices"},Y={key:0,class:"no-items"},W={key:0,class:"loading"},P={key:1,class:"empty"},X={key:1,class:"view groups"},K={key:0,class:"no-items"},J={key:0,class:"loading"},Q={key:1,class:"empty"};function ee(e,t,i,j,B,ee){const te=(0,s.up)("Loading"),ie=(0,s.up)("Modal"),se=(0,s.up)("DropdownItem"),ae=(0,s.up)("Dropdown"),ne=(0,s.up)("Device"),le=(0,s.up)("Group");return(0,s.wg)(),(0,s.iD)("div",n,[B.loading?((0,s.wg)(),(0,s.j4)(te,{key:0})):(0,s.kq)("",!0),(0,s.Wm)(ie,{title:"Network Info",ref:"infoModal"},{default:(0,s.w5)((()=>[B.status.info?((0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",o,[r,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.state)},null,8,d)]),(0,s._)("div",c,[u,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.permit_join)},null,8,p)]),B.status.info.network?((0,s.wg)(),(0,s.iD)("div",v,[h,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.network.channel)},null,8,m)])):(0,s.kq)("",!0),(0,s._)("div",g,[b,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.version)},null,8,f)]),B.status.info.config?.mqtt?((0,s.wg)(),(0,s.iD)("div",y,[w,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.config.mqtt.server)},null,8,_)])):(0,s.kq)("",!0),B.status.info.config?.serial?((0,s.wg)(),(0,s.iD)("div",k,[C,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.config.serial.port)},null,8,x)])):(0,s.kq)("",!0),B.status.info.coordinator?.type?((0,s.wg)(),(0,s.iD)("div",q,[D,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.coordinator.type)},null,8,z)])):(0,s.kq)("",!0),B.status.info.coordinator?.meta?((0,s.wg)(),(0,s.iD)("div",I,[M,(0,s._)("div",Z,(0,a.zw)(B.status.info.coordinator.meta.maintrel)+"."+(0,a.zw)(B.status.info.coordinator.meta.majorrel)+"."+(0,a.zw)(B.status.info.coordinator.meta.minorrel),1)])):(0,s.kq)("",!0),B.status.info.coordinator?.meta?((0,s.wg)(),(0,s.iD)("div",$,[S,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(B.status.info.coordinator.meta.revision)},null,8,R)])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])),_:1},512),(0,s._)("div",G,[(0,s._)("div",N,[(0,s._)("label",null,[(0,s._)("select",{value:B.selected.view,onChange:t[0]||(t[0]=e=>this.selected.view=e.target.value)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.views,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{textContent:(0,a.zw)((t[0].toUpperCase()+t.slice(1)).replace("_"," ")),key:t,selected:e,value:t},null,8,E)))),128))],40,T)])]),(0,s._)("div",O,["groups"===B.selected.view?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-default",title:"Add Group",disabled:B.loading,onClick:t[1]||(t[1]=(...e)=>ee.addGroup&&ee.addGroup(...e))},A,8,V)):(0,s.kq)("",!0),(0,s.Wm)(ae,{ref:"networkCommandsDropdown","icon-class":"fa fa-cog",title:"Network commands"},{default:(0,s.w5)((()=>[(0,s.Wm)(se,{text:"Network Info",disabled:B.loading,onInput:t[2]||(t[2]=t=>e.$refs.infoModal.show())},null,8,["disabled"]),B.status.info?.permit_join?((0,s.wg)(),(0,s.j4)(se,{key:1,text:"Disable Join",disabled:B.loading,onInput:t[4]||(t[4]=e=>ee.permitJoin(!1))},null,8,["disabled"])):((0,s.wg)(),(0,s.j4)(se,{key:0,text:"Permit Join",disabled:B.loading,onInput:t[3]||(t[3]=e=>ee.permitJoin(!0))},null,8,["disabled"])),(0,s.Wm)(se,{text:"Factory Reset",disabled:B.loading,onInput:ee.factoryReset},null,8,["disabled","onInput"])])),_:1},512),(0,s._)("button",{class:"btn btn-default",title:"Refresh network",disabled:B.loading,onClick:t[5]||(t[5]=(...e)=>ee.refresh&&ee.refresh(...e))},F,8,L)])]),(0,s._)("div",H,["devices"===B.selected.view?((0,s.wg)(),(0,s.iD)("div",U,[Object.keys(B.devices).length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Y,[B.loading?((0,s.wg)(),(0,s.iD)("div",W,"Loading devices...")):((0,s.wg)(),(0,s.iD)("div",P,"No devices found on the network"))])),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.devices,((e,t)=>((0,s.wg)(),(0,s.j4)(ne,{key:t,device:e,groups:B.groups,selected:B.selected.deviceId===t,onSelect:e=>B.selected.deviceId=B.selected.deviceId===t?null:t,onRename:ee.refreshDevices,onRemove:ee.refreshDevices,onGroupsEdit:ee.refreshGroups},null,8,["device","groups","selected","onSelect","onRename","onRemove","onGroupsEdit"])))),128))])):"groups"===B.selected.view?((0,s.wg)(),(0,s.iD)("div",X,[Object.keys(B.groups).length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",K,[B.loading?((0,s.wg)(),(0,s.iD)("div",J,"Loading groups...")):((0,s.wg)(),(0,s.iD)("div",Q,"No groups available on the network"))])),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.groups,((e,t)=>((0,s.wg)(),(0,s.j4)(le,{key:t,group:e,devices:B.devices,selected:B.selected.groupId===t,onSelect:e=>B.selected.groupId=B.selected.groupId===t?null:t,onRename:ee.refreshGroups,onRemove:ee.refreshGroups,onEdit:ee.refreshGroups},null,8,["group","devices","selected","onSelect","onRename","onRemove","onEdit"])))),128))])):(0,s.kq)("",!0)])])}var te=i(4904),ie=i(7597),se=i(6791),ae=i(8637),ne=i(9963);const le=e=>((0,s.dD)("data-v-6437b841"),e=e(),(0,s.Cn)(),e),oe={class:"groups"},re=["value","checked"],de=["textContent"],ce=le((()=>(0,s._)("div",{class:"footer buttons"},[(0,s._)("button",{type:"submit"},"Save")],-1))),ue=["textContent"],pe={key:1,class:"params"},ve={class:"row"},he=le((()=>(0,s._)("div",{class:"param-name"},"Name",-1))),me={class:"param-value"},ge=["value"],be={class:"buttons"},fe=le((()=>(0,s._)("i",{class:"fas fa-times"},null,-1))),ye=[fe],we=le((()=>(0,s._)("button",{type:"submit",class:"btn btn-default"},[(0,s._)("i",{class:"fa fa-check"})],-1))),_e=["textContent"],ke={class:"buttons"},Ce=le((()=>(0,s._)("i",{class:"fa fa-edit"},null,-1))),xe=[Ce],qe={class:"row"},De=le((()=>(0,s._)("div",{class:"param-name"},"IEEE Address",-1))),ze=["textContent"],Ie={key:0,class:"row"},Me=le((()=>(0,s._)("div",{class:"param-name"},"Network Address",-1))),Ze=["textContent"],$e={class:"row"},Se=le((()=>(0,s._)("div",{class:"param-name"},"Type",-1))),Re=["textContent"],Ge={key:1,class:"row"},Ne=le((()=>(0,s._)("div",{class:"param-name"},"Vendor",-1))),Te={class:"param-value"},Ee={key:2,class:"row"},Oe=le((()=>(0,s._)("div",{class:"param-name"},"Model",-1))),Ve={class:"param-value"},je={key:3,class:"row"},Ae=le((()=>(0,s._)("div",{class:"param-name"},"Model ID",-1))),Le={class:"param-value"},Be={key:4,class:"row"},Fe=le((()=>(0,s._)("div",{class:"param-name"},"Description",-1))),He={class:"param-value"},Ue={key:5,class:"row"},Ye=le((()=>(0,s._)("div",{class:"param-name"},"Software Build ID",-1))),We={class:"param-value"},Pe={key:6,class:"row"},Xe=le((()=>(0,s._)("div",{class:"param-name"},"Date Code",-1))),Ke={class:"param-value"},Je={key:7,class:"row"},Qe=le((()=>(0,s._)("div",{class:"param-name"},"Power Source",-1))),et={class:"param-value"},tt={key:8,class:"section values"},it=le((()=>(0,s._)("div",{class:"header"},[(0,s._)("div",{class:"title"},"Values")],-1))),st={class:"body"},at={class:"param-name"},nt={key:0,class:"text"},lt=["textContent"],ot=["textContent"],rt={class:"param-value"},dt={key:2},ct=["value","disabled","onChange"],ut={key:3},pt=["value","onChange"],vt={key:0},ht=["value","textContent","selected","disabled"],mt={key:4},gt=["onChange","value"],bt={key:5},ft=["disabled","value","onChange"],yt={class:"section actions"},wt=le((()=>(0,s._)("div",{class:"header"},[(0,s._)("div",{class:"title"},"Actions")],-1))),_t={class:"body"},kt=le((()=>(0,s._)("div",{class:"param-name"},"Manage groups",-1))),Ct=le((()=>(0,s._)("div",{class:"param-value"},[(0,s._)("i",{class:"fa fa-network-wired"})],-1))),xt=[kt,Ct],qt={key:0,class:"param-name"},Dt={key:1,class:"param-name"},zt=le((()=>(0,s._)("div",{class:"param-value"},[(0,s._)("i",{class:"fa fa-sync-alt"})],-1))),It=le((()=>(0,s._)("div",{class:"param-name"},"Remove Device",-1))),Mt=le((()=>(0,s._)("div",{class:"param-value"},[(0,s._)("i",{class:"fa fa-trash"})],-1))),Zt=[It,Mt],$t=le((()=>(0,s._)("div",{class:"param-name"},"Force Remove Device",-1))),St=le((()=>(0,s._)("div",{class:"param-value"},[(0,s._)("i",{class:"fa fa-trash"})],-1))),Rt=[$t,St];function Gt(e,t,i,n,l,o){const r=(0,s.up)("Loading"),d=(0,s.up)("Modal"),c=(0,s.up)("ToggleSwitch"),u=(0,s.up)("Slider");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["item device",{selected:i.selected}])},[l.loading?((0,s.wg)(),(0,s.j4)(r,{key:0})):(0,s.kq)("",!0),(0,s.Wm)(d,{class:"groups-modal",ref:"groupsModal",title:"Device groups"},{default:(0,s.w5)((()=>[l.loading?((0,s.wg)(),(0,s.j4)(r,{key:0})):(0,s.kq)("",!0),(0,s._)("form",{class:"content",onSubmit:t[0]||(t[0]=(0,ne.iM)(((...e)=>o.manageGroups&&o.manageGroups(...e)),["prevent"]))},[(0,s._)("div",oe,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.groups,((e,t)=>((0,s.wg)(),(0,s.iD)("label",{class:"row group",key:t},[(0,s._)("input",{type:"checkbox",value:t,checked:o.associatedGroups.has(parseInt(e.id))},null,8,re),(0,s._)("span",{class:"name",textContent:(0,a.zw)(e.friendly_name?.length?e.friendly_name:`[Group #${e.id}]`)},null,8,de)])))),128))]),ce],32)])),_:1},512),(0,s._)("div",{class:(0,a.C_)(["row name header vertical-center",{selected:i.selected}]),textContent:(0,a.zw)(i.device.friendly_name||i.device.ieee_address),onClick:t[1]||(t[1]=t=>e.$emit("select"))},null,10,ue),i.selected?((0,s.wg)(),(0,s.iD)("div",pe,[(0,s._)("div",ve,[he,(0,s._)("div",me,[(0,s._)("div",{class:(0,a.C_)(["name-edit",{hidden:!l.editName}])},[(0,s._)("form",{onSubmit:t[3]||(t[3]=(0,ne.iM)(((...e)=>o.rename&&o.rename(...e)),["prevent"]))},[(0,s._)("label",null,[(0,s._)("input",{type:"text",name:"name",ref:"name",value:i.device.friendly_name},null,8,ge)]),(0,s._)("span",be,[(0,s._)("button",{type:"button",class:"btn btn-default",onClick:t[2]||(t[2]=e=>l.editName=!1)},ye),we])],32)],2),(0,s._)("div",{class:(0,a.C_)(["name-edit",{hidden:l.editName}])},[(0,s._)("span",{textContent:(0,a.zw)(i.device.friendly_name)},null,8,_e),(0,s._)("span",ke,[(0,s._)("button",{type:"button",class:"btn btn-default",onClick:t[4]||(t[4]=e=>l.editName=!0)},xe)])],2)])]),(0,s._)("div",qe,[De,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(i.device.ieee_address)},null,8,ze)]),i.device.network_address?((0,s.wg)(),(0,s.iD)("div",Ie,[Me,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(i.device.network_address)},null,8,Ze)])):(0,s.kq)("",!0),(0,s._)("div",$e,[Se,(0,s._)("div",{class:"param-value",textContent:(0,a.zw)(i.device.type)},null,8,Re)]),i.device.definition?.vendor?((0,s.wg)(),(0,s.iD)("div",Ge,[Ne,(0,s._)("div",Te,(0,a.zw)(i.device.definition.vendor),1)])):(0,s.kq)("",!0),i.device.definition?.model?((0,s.wg)(),(0,s.iD)("div",Ee,[Oe,(0,s._)("div",Ve,(0,a.zw)(i.device.definition.model),1)])):(0,s.kq)("",!0),i.device.model_id?((0,s.wg)(),(0,s.iD)("div",je,[Ae,(0,s._)("div",Le,(0,a.zw)(i.device.model_id),1)])):(0,s.kq)("",!0),i.device.definition?.description?((0,s.wg)(),(0,s.iD)("div",Be,[Fe,(0,s._)("div",He,(0,a.zw)(i.device.definition.description),1)])):(0,s.kq)("",!0),i.device.software_build_id?((0,s.wg)(),(0,s.iD)("div",Ue,[Ye,(0,s._)("div",We,(0,a.zw)(i.device.software_build_id),1)])):(0,s.kq)("",!0),i.device.definition?.date_code?((0,s.wg)(),(0,s.iD)("div",Pe,[Xe,(0,s._)("div",Ke,(0,a.zw)(i.device.definition.date_code),1)])):(0,s.kq)("",!0),i.device.power_source?((0,s.wg)(),(0,s.iD)("div",Je,[Qe,(0,s._)("div",et,(0,a.zw)(i.device.power_source),1)])):(0,s.kq)("",!0),Object.keys(o.displayedValues).length?((0,s.wg)(),(0,s.iD)("div",tt,[it,(0,s._)("div",st,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.displayedValues,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"row value",key:t},[(0,s._)("div",at,[(0,s.Uk)((0,a.zw)(e.description)+" ",1),null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,s.wg)(),(0,s.iD)("span",nt,"Color")):(0,s.kq)("",!0),e.property?((0,s.wg)(),(0,s.iD)("span",{key:1,class:"name",textContent:(0,a.zw)(e.property)},null,8,lt)):(0,s.kq)("",!0),e.unit?((0,s.wg)(),(0,s.iD)("span",{key:2,class:"unit",textContent:(0,a.zw)(e.unit)},null,8,ot)):(0,s.kq)("",!0)]),(0,s._)("div",rt,["binary"===e.type?((0,s.wg)(),(0,s.j4)(c,{key:0,value:null!=e.value_on?e.value===e.value_on:!!e.value,disabled:!e.writable,onInput:t=>o.setValue(e,t)},null,8,["value","disabled","onInput"])):"numeric"===e.type&&null!=e.value_min&&null!=e.value_max?((0,s.wg)(),(0,s.j4)(u,{key:1,"with-label":!0,range:[e.value_min,e.value_max],value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,8,["range","value","disabled","onChange"])):"numeric"!==e.type||null!=e.value_min&&null!=e.value_max?"enum"===e.type?((0,s.wg)(),(0,s.iD)("label",ut,[(0,s._)("select",{value:e.readable&&null!=e.value?e.value:"",onChange:t=>o.setValue(e,t)},[e.readable?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("option",vt)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.values,(t=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t,textContent:(0,a.zw)(t),selected:e.readable&&e.value===t,disabled:!e.writable},null,8,ht)))),128))],40,pt)])):null!=o.rgbColor&&null!=e.value?.x&&null!=e.value?.y||null!=e.value?.hue&&null!=e.value?.saturation?((0,s.wg)(),(0,s.iD)("label",mt,[(0,s._)("input",{type:"color",onChange:(0,ne.iM)((t=>o.setValue(e,t)),["stop"]),value:"#"+o.rgbColor.map((e=>(e=Number(e).toString(16),1===e.length?"0"+e:e))).join("")},null,40,gt)])):((0,s.wg)(),(0,s.iD)("label",bt,[(0,s._)("input",{type:"text",disabled:!e.writable,value:e.value,onChange:t=>o.setValue(e,t)},null,40,ft)])):((0,s.wg)(),(0,s.iD)("label",dt,[(0,s._)("input",{type:"number","with-label":!0,value:e.value,disabled:!e.writable,onChange:t=>o.setValue(e,t)},null,40,ct)]))])])))),128))])])):(0,s.kq)("",!0),(0,s._)("div",yt,[wt,(0,s._)("div",_t,[(0,s._)("div",{class:"row",onClick:t[5]||(t[5]=t=>e.$refs.groupsModal.show())},xt),(0,s._)("div",{class:"row",onClick:t[6]||(t[6]=e=>l.otaUpdatesAvailable?o.installOtaUpdates():o.checkOtaUpdates())},[l.otaUpdatesAvailable?((0,s.wg)(),(0,s.iD)("div",Dt,"Install updates")):((0,s.wg)(),(0,s.iD)("div",qt,"Check for updates")),zt]),(0,s._)("div",{class:"row",onClick:t[7]||(t[7]=e=>o.remove(!1))},Zt),(0,s._)("div",{class:"row error",onClick:t[8]||(t[8]=e=>o.remove(!0))},Rt)])])])):(0,s.kq)("",!0)],2)}var Nt=i(8140),Tt=i(7514),Et=i(4212),Ot=i(5166),Vt={name:"Device",components:{Modal:Ot.Z,ToggleSwitch:Tt.Z,Slider:Nt.Z,Loading:se.Z},mixins:[ae.Z],emits:["select","rename","remove","groups-edit"],props:{device:{type:Object,required:!0},groups:{type:Object,default:()=>{}},selected:{type:Boolean,default:!1}},data(){return{editName:!1,loading:!1,status:{},otaUpdatesAvailable:!1}},computed:{values(){if(!this.device.definition?.exposes)return{};const e=e=>{const t=(e,i)=>{if(e.features){e.property&&(i[e.property]=i[e.property]||{},i=i[e.property]);for(const s of e.features)t(s,i)}else e.property&&(i[e.property]=e)},i={};for(const s of e)t(s,i);return i};return e(this.device.definition.exposes)},displayedValues(){const e={},t=(e,[i,s])=>(i in this.status&&(s={...s,value:this.status[i]}),null!=s.access&&(s.readable=!!(1&s.access),s.writable=!!(2&s.access),delete s.access),e[i]=s,Object.entries(s).filter((e=>e[1]instanceof Object)).reduce(t,e[i]),e);return Object.entries(this.values).reduce(t,e),e},rgbColor(){if(!this.displayedValues.color)return;const e=this.displayedValues.color?.value;if(e){if(null!=e.x&&null!=e.y){const t=new Et.N({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return t.xyToRgb(e.x,e.y,this.displayedValues.brightness.value)}if(null!=e.hue&&(null!=e.saturation||null!=e.sat)){const t=null!=e.saturation?"saturation":"sat",i=new Et.N({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[t]?.value_min||0,this.displayedValues.color[t].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]});return i.hslToRgb(e.hue,e[t],this.displayedValues.brightness.value)}return null}},associatedGroups(){return new Set(Object.values(this.groups).filter((e=>new Set((e.members||[]).map((e=>e.ieee_address))).has(this.device.ieee_address))).map((e=>parseInt(e.id))))}},methods:{async refresh(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.device_get",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}},async rename(){const e=(this.$refs.name.value||"").trim();if(e.length&&e!==this.device.friendly_name){this.loading=!0;try{await this.request("zigbee.mqtt.device_rename",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,name:e}),this.$emit("rename",{name:this.device.friendly_name,newName:e})}finally{this.editName=!1,this.loading=!1}}},async remove(e){if(confirm("Are you really sure that you want to remove this device from the network?")){e=!!e,this.loading=!0;try{await this.request("zigbee.mqtt.device_remove",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address,force:e}),this.$emit("remove",{device:this.device.friendly_name||this.device.ieee_address})}finally{this.loading=!1}}},async setValue(e,t){const i={device:this.device.friendly_name||this.device.ieee_address,property:e.property,value:null};switch(e.type){case"binary":e.value_toggle?i.value=e.value_toggle:e.value_on&&e.value_off?i.value=e.value===e.value_on?e.value_off:e.value_on:i.value=!e.value;break;case"numeric":i.value=parseFloat(t.target.value);break;case"enum":t.target.value?.length&&(i.value=t.target.value);break;default:if(null!=e.x&&null!=e.y||null!=e.hue&&(null!=e.saturation||null!=e.sat)){i.property="color";const s=t.target.value.slice(1).split(/([0-9a-fA-F]{2})/).filter(((e,t)=>t%2)).map((e=>parseInt(e,16)));if(null!=e.x&&null!=e.y){const e=new Et.N({bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),t=e.rgbToXY(...s);i.value={x:t[0],y:t[1]}}else{const e=null!=this.displayedValues.color.saturation?"saturation":"sat",t=new Et.N({hue:[this.displayedValues.color.hue?.value_min||0,this.displayedValues.color.hue.value_max||65535],sat:[this.displayedValues.color[e]?.value_min||0,this.displayedValues.color[e].value_max||255],bri:[this.displayedValues.brightness?.value_min||0,this.displayedValues.brightness?.value_max||255]}),a=t.rgbToHsl(...s);i.value={hue:a[0]},i.value[e]=a[1]}}break}if(null!=i.value){this.loading=!0;try{await this.request("zigbee.mqtt.device_set",i),await this.refresh()}finally{this.loading=!1}}},async manageGroups(e){const t=[...e.target.querySelectorAll("input[type=checkbox]")].reduce(((e,t)=>{const i=parseInt(t.value);return t.checked&&!this.associatedGroups.has(i)?e.add.add(i):!t.checked&&this.associatedGroups.has(i)&&e.remove.add(i),e}),{add:new Set,remove:new Set}),i=async e=>{await Promise.all([...t[e]].map((async t=>{await this.request(`zigbee.mqtt.group_${e}_device`,{group:this.groups[t].friendly_name,device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})})))};this.loading=!0;try{await Promise.all(Object.keys(t).map(i)),this.$emit("groups-edit",t)}finally{this.loading=!1}},async checkOtaUpdates(){this.loading=!0;try{this.otaUpdatesAvailable=(await this.request("zigbee.mqtt.device_check_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})).update_available,this.otaUpdatesAvailable?this.notify({text:"A firmware update is available for the device",image:{iconClass:"fa fa-sync-alt"}}):this.notify({text:"The device is up to date",image:{iconClass:"fa fa-check"}})}finally{this.loading=!1}},async installOtaUpdates(){this.loading=!0;try{await this.request("zigbee.mqtt.device_install_ota_updates",{device:this.device.friendly_name?.length?this.device.friendly_name:this.device.ieee_address})}finally{this.loading=!1}}},mounted(){this.$watch((()=>this.selected),(e=>{e&&this.refresh()})),this.$watch((()=>this.status.update_available),(e=>{this.otaUpdatesAvailable=e})),this.subscribe((e=>{e.device!==this.device.friendly_name&&e.device!==this.device.ieee_address||(this.status={...this.status,...e.properties})}),`on-property-change-${this.device.ieee_address}`,"platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePropertySetEvent")},unmounted(){this.unsubscribe(`on-property-change-${this.device.ieee_address}`)}},jt=i(3744);const At=(0,jt.Z)(Vt,[["render",Gt],["__scopeId","data-v-6437b841"]]);var Lt=At;const Bt=e=>((0,s.dD)("data-v-7667f7ba"),e=e(),(0,s.Cn)(),e),Ft=["textContent"],Ht={key:1,class:"params"},Ut={class:"section devices"},Yt=Bt((()=>(0,s._)("div",{class:"header"},[(0,s._)("div",{class:"title"},"Devices")],-1))),Wt={class:"body"},Pt=["checked","value","onChange"],Xt=["textContent"],Kt={class:"section actions"},Jt=Bt((()=>(0,s._)("div",{class:"header"},[(0,s._)("div",{class:"title"},"Actions")],-1))),Qt={class:"body"},ei=Bt((()=>(0,s._)("div",{class:"col-10"},"Rename Group",-1))),ti=Bt((()=>(0,s._)("div",{class:"buttons col-2 pull-right"},[(0,s._)("i",{class:"fa fa-edit"})],-1))),ii=[ei,ti],si=Bt((()=>(0,s._)("div",{class:"col-10"},"Remove Group",-1))),ai=Bt((()=>(0,s._)("div",{class:"buttons col-2 pull-right"},[(0,s._)("i",{class:"fa fa-trash"})],-1))),ni=[si,ai];function li(e,t,i,n,l,o){const r=(0,s.up)("Loading");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["item group",{selected:i.selected}])},[l.loading?((0,s.wg)(),(0,s.j4)(r,{key:0})):(0,s.kq)("",!0),(0,s._)("div",{class:(0,a.C_)(["row name header vertical-center",{selected:i.selected}]),textContent:(0,a.zw)(i.group.friendly_name),onClick:t[0]||(t[0]=t=>e.$emit("select"))},null,10,Ft),i.selected?((0,s.wg)(),(0,s.iD)("div",Ht,[(0,s._)("div",Ut,[Yt,(0,s._)("div",Wt,[(0,s._)("form",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.devices,((e,t)=>((0,s.wg)(),(0,s.iD)("label",{class:"row",key:t},[(0,s._)("input",{type:"checkbox",checked:o.members.has(e.ieee_address),value:e.ieee_address,onChange:t=>o.toggleDevice(e.ieee_address)},null,40,Pt),(0,s._)("span",{class:"label",textContent:(0,a.zw)(e.friendly_name?.length?e.friendly_name:e.ieee_address)},null,8,Xt)])))),128))])])]),(0,s._)("div",Kt,[Jt,(0,s._)("div",Qt,[(0,s._)("div",{class:"row",onClick:t[1]||(t[1]=(...e)=>o.rename&&o.rename(...e))},ii),(0,s._)("div",{class:"row",onClick:t[2]||(t[2]=(...e)=>o.remove&&o.remove(...e))},ni)])])])):(0,s.kq)("",!0)],2)}var oi={name:"Group",emits:["select","remove","edit"],mixins:[ae.Z],components:{Loading:se.Z},props:{group:{type:Object,required:!0},devices:{type:Object,default:()=>({})},selected:{type:Boolean,default:!1}},data(){return{loading:!1,values:{}}},computed:{devicesByAddress(){return Object.entries(this.devices).reduce(((e,t)=>{const i=t[1];return e[i.ieee_address]=i,e}),{})},members(){return new Set((this.group.members||[]).map((e=>e.ieee_address)))}},methods:{async remove(){if(confirm("Are you sure that you want to remove this group?")){this.loading=!0;try{await this.request("zigbee.mqtt.group_remove",{name:this.group.friendly_name}),this.$emit("remove",{name:this.group.friendly_name})}finally{this.loading=!1}}},async rename(){let e=prompt("New group name",this.group.friendly_name);if(e?.length){e=e.trim(),this.loading=!0;try{await this.request("zigbee.mqtt.group_rename",{group:this.group.friendly_name||this.group.id,name:e}),this.$emit("rename",{name:this.group.friendly_name,newName:e})}finally{this.loading=!1}}},async toggleDevice(e){const t=this.devicesByAddress[e],i=t.friendly_name?.length?t.friendly_name:e,s=this.members.has(e)?"remove":"add";this.loading=!0;try{await this.request(`zigbee.mqtt.group_${s}_device`,{group:this.group.friendly_name,device:i}),this.$emit("edit",{device:i,method:s})}finally{this.loading=!1}}}};const ri=(0,jt.Z)(oi,[["render",li],["__scopeId","data-v-7667f7ba"]]);var di=ri,ci={name:"ZigbeeMqtt",components:{Modal:Ot.Z,Dropdown:te.Z,DropdownItem:ie.Z,Loading:se.Z,Device:Lt,Group:di},mixins:[ae.Z],data(){return{devices:{},groups:{},status:{},loading:!1,selected:{view:"devices",deviceId:void 0,groupId:void 0},views:{devices:!0,groups:!0},modal:{group:{visible:!1}}}},methods:{async refreshDevices(){this.loading=!0;try{this.devices=(await this.request("zigbee.mqtt.devices")).reduce(((e,t)=>(t.friendly_name in this.devices&&(t={values:this.devices[t.friendly_name].values||{},...this.devices[t.friendly_name]}),e[t.friendly_name]=t,e)),{})}finally{this.loading=!1}},async refreshGroups(){this.loading=!0;try{this.groups=(await this.request("zigbee.mqtt.groups")).reduce(((e,t)=>(e[t.id]=t,e)),{})}finally{this.loading=!1}},async refreshInfo(){this.loading=!0;try{this.status=await this.request("zigbee.mqtt.info")}finally{this.loading=!1}},refresh(){this.refreshDevices(),this.refreshGroups(),this.refreshInfo()},updateProperties(e,t){this.devices[e].values=t},async addGroup(){const e=prompt("Group name");if(e&&e.length){this.loading=!0;try{await this.request("zigbee.mqtt.group_add",{name:e})}finally{this.loading=!1}await this.refreshGroups()}},async permitJoin(e){const t={permit:!!e};if(e){let e=prompt("Join allow period in seconds (0 or empty for no time limits)","60");t.seconds=e.length?parseInt(e):null}this.loading=!0;try{await this.request("zigbee.mqtt.permit_join",t),setTimeout(this.refreshInfo,1e3)}finally{this.loading=!1}},async factoryReset(){if(confirm("Are you SURE that you want to do a device factory reset?")||confirm("Are you REALLY sure? ALL network information and custom firmware will be lost!!")){this.loading=!0;try{await this.request("zigbee.mqtt.factory_reset")}finally{this.loading=!1}}},async addToGroup(e,t){this.loading=!0,await this.request("zigbee.mqtt.group_add_device",{device:e,group:t}),this.loading=!1;const i=this;setTimeout((()=>{i.refresh(),i.refreshGroups()}),100)}},created(){this.subscribe((()=>{this.notify({text:"WARNING: The controller is offline",error:!0})}),"on-zigbee-offline","platypush.message.event.zigbee.mqtt.ZigbeeMqttOfflineEvent"),this.subscribe((()=>{this.notify({text:"The controller is now online",iconClass:"fas fa-check"})}),"on-zigbee-online","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the device",error:!0})}),"on-zigbee-device-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to add the group",error:!0})}),"on-zigbee-group-add-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove group",error:!0})}),"on-zigbee-group-remove-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedFailedEvent"),this.subscribe((()=>{this.notify({text:"Failed to remove the devices from group",error:!0})}),"on-zigbee-remove-all-failed","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllFailedEvent"),this.subscribe((e=>{this.notify({text:e.error||"[Unknown error]",error:!0})}),"on-zigbee-error","platypush.message.event.zigbee.mqtt.ZigbeeMqttErrorEvent"),this.subscribe(this.refresh,"on-zigbee-device-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttOnlineEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDevicePairingEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceConnectedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBannedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceWhitelistedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceRenamedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceBindEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttDeviceUnbindEvent"),this.subscribe(this.refreshGroups,"on-zigbee-group-update","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupAddedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemovedEvent","platypush.message.event.zigbee.mqtt.ZigbeeMqttGroupRemoveAllEvent")},mounted(){this.refresh()},unmounted(){this.unsubscribe("on-zigbee-error"),this.unsubscribe("on-zigbee-remove-all-failed"),this.unsubscribe("on-zigbee-group-remove-failed"),this.unsubscribe("on-zigbee-group-add-failed"),this.unsubscribe("on-zigbee-device-remove-failed"),this.unsubscribe("on-zigbee-online"),this.unsubscribe("on-zigbee-offline"),this.unsubscribe("on-zigbee-device-update"),this.unsubscribe("on-zigbee-group-update")}};const ui=(0,jt.Z)(ci,[["render",ee]]);var pi=ui}}]);
//# sourceMappingURL=6882.090441b2.js.map
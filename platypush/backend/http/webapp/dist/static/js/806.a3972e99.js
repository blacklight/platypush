"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[806,2545],{9265:function(e,t,n){n.d(t,{A:function(){return y}});var o=n(641),s=n(3751),a=n(33);const l={class:"dropdown-container"},r=["title"],i=["textContent"];function d(e,t,n,d,c,u){const p=(0,o.g2)("DropdownBody");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("button",{title:n.title,ref:"button",onClick:t[0]||(t[0]=(0,s.D$)((e=>u.toggle(e)),["stop"]))},[n.iconClass?((0,o.uX)(),(0,o.CE)("i",{key:0,class:(0,a.C4)(["icon",n.iconClass])},null,2)):(0,o.Q3)("",!0),n.text?((0,o.uX)(),(0,o.CE)("span",{key:1,class:"text",textContent:(0,a.v_)(n.text)},null,8,i)):(0,o.Q3)("",!0)],8,r),(0,o.Lk)("div",{class:(0,a.C4)(["body-container",{hidden:!c.visible}]),ref:"dropdownContainer"},[(0,o.bF)(p,{id:n.id,keepOpenOnItemClick:n.keepOpenOnItemClick,style:(0,a.Tr)(n.style),ref:"dropdown",onClick:u.onClick},{default:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","style","onClick"])],2)])}var c=n(4200),u=n(2537),p={components:{DropdownBody:c.A},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}},data(){return{visible:!1}},computed:{button(){const e=this.$refs.button?.$el;return e?e.querySelector("button"):this.$refs.button},buttonStyle(){return this.button?getComputedStyle(this.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),u.j.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$nextTick(this.adjustDropdownPos)},adjustDropdownPos(){const e=this.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},n={left:t.left,top:t.top+this.buttonHeight},o=this.getDropdownWidth(),s=this.getDropdownHeight();if(n.left+o>(window.innerWidth+window.scrollX)/2&&(n.left-=o-this.buttonWidth),n.top+s>(window.innerHeight+window.scrollY)/2){let e=n.top-(s+this.buttonHeight-10);e<0&&(e=0),n.top=e}const a=this.$refs.dropdown.$el;a.classList.add("fade-in"),a.style.top=`${n.top}px`,a.style.left=`${n.left}px`,u.j.emit("dropdown-open",this.$refs.dropdown)},toggle(e){e?.stopPropagation(),this.$emit("click",e),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}},k=n(6262);const h=(0,k.A)(p,[["render",d],["__scopeId","data-v-3f1ad726"]]);var y=h},4200:function(e,t,n){n.d(t,{A:function(){return c}});var o=n(641),s=n(33);const a=["id"];function l(e,t,n,l,r,i){return(0,o.uX)(),(0,o.CE)("div",{class:"dropdown",id:n.id,style:(0,s.Tr)(n.style),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,o.RG)(e.$slots,"default",{},void 0,!0)],12,a)}var r={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}}},i=n(6262);const d=(0,i.A)(r,[["render",l],["__scopeId","data-v-24c5aa28"]]);var c=d},9612:function(e,t,n){n.d(t,{A:function(){return h}});var o=n(641),s=n(33);const a=["title"],l={key:0,class:"col-2 icon"},r=["textContent"];function i(e,t,n,i,d,c){const u=(0,o.g2)("Icon");return(0,o.uX)(),(0,o.CE)("div",{class:(0,s.C4)(["row item",{...c.itemClass_,disabled:n.disabled}]),title:n.hoverText,onClick:t[0]||(t[0]=(...e)=>c.clicked&&c.clicked(...e))},[n.iconClass?.length||n.iconUrl?.length?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.bF)(u,{class:(0,s.C4)(n.iconClass),url:n.iconUrl},null,8,["class","url"])])):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:(0,s.C4)(["text",{"col-10":null!=n.iconClass}]),textContent:(0,s.v_)(n.text)},null,10,r)],10,a)}var d=n(3778),c=n(2537),u={components:{Icon:d.A},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||c.j.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},p=n(6262);const k=(0,p.A)(u,[["render",i],["__scopeId","data-v-2babe09c"]]);var h=k},3778:function(e,t,n){n.d(t,{A:function(){return u}});var o=n(641),s=n(33);const a={class:"icon-container"},l=["src","alt"];function r(e,t,n,r,i,d){return(0,o.uX)(),(0,o.CE)("div",a,[n.url?.length?((0,o.uX)(),(0,o.CE)("img",{key:0,class:"icon",src:n.url,alt:n.alt},null,8,l)):d.className?.length?((0,o.uX)(),(0,o.CE)("i",{key:1,class:(0,s.C4)(["icon",d.className]),style:(0,s.Tr)({color:n.color})},null,6)):(0,o.Q3)("",!0)])}var i={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=n(6262);const c=(0,d.A)(i,[["render",r],["__scopeId","data-v-706a3bd1"]]);var u=c},6561:function(e,t,n){n.d(t,{A:function(){return c}});var o=n(641),s=n(33);const a={class:"no-items-container"};function l(e,t,n,l,r,i){return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",{class:(0,s.C4)(["no-items fade-in",{shadow:n.withShadow}])},[(0,o.RG)(e.$slots,"default",{},void 0,!0)],2)])}var r={name:"NoItems",props:{withShadow:{type:Boolean,default:!0}}},i=n(6262);const d=(0,i.A)(r,[["render",l],["__scopeId","data-v-4856c4d7"]]);var c=d},5054:function(e,t,n){n.d(t,{A:function(){return u}});var o=n(641),s=n(33);const a={key:0,class:"icon"};function l(e,t,n,l,r,i){const d=(0,o.g2)("Icon");return(0,o.uX)(),(0,o.CE)("div",{class:(0,s.C4)(["tab",n.selected?"selected":""]),onClick:t[0]||(t[0]=t=>e.$emit("input"))},[n.iconClass?.length||n.iconUrl?.length?((0,o.uX)(),(0,o.CE)("span",a,[(0,o.bF)(d,{class:(0,s.C4)(n.iconClass),url:n.iconUrl},null,8,["class","url"])])):(0,o.Q3)("",!0),t[1]||(t[1]=(0,o.eW)(" Â  ")),(0,o.RG)(e.$slots,"default",{},void 0,!0)],2)}var r=n(3778),i={name:"Tab",components:{Icon:r.A},emits:["input"],props:{selected:{type:Boolean,default:!1},iconClass:{type:String},iconUrl:{type:String}}},d=n(6262);const c=(0,d.A)(i,[["render",l],["__scopeId","data-v-f3217d34"]]);var u=c},3556:function(e,t,n){n.d(t,{A:function(){return d}});var o=n(641);const s={class:"tabs"};function a(e,t,n,a,l,r){return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.RG)(e.$slots,"default",{},void 0,!0)])}var l={name:"Tabs"},r=n(6262);const i=(0,r.A)(l,[["render",a],["__scopeId","data-v-f4300bb0"]]);var d=i},806:function(e,t,n){n.r(t),n.d(t,{default:function(){return de}});var o=n(641);const s={class:"tokens-container"},a={key:1,class:"main"},l={class:"header"},r={class:"tabs-container"},i={class:"body"};function d(e,t,n,d,c,u){const p=(0,o.g2)("Loading"),k=(0,o.g2)("Tab"),h=(0,o.g2)("Tabs"),y=(0,o.g2)("JwtToken"),f=(0,o.g2)("ApiToken");return(0,o.uX)(),(0,o.CE)("div",s,[c.loading?((0,o.uX)(),(0,o.Wv)(p,{key:0})):((0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",l,[(0,o.Lk)("div",r,[(0,o.bF)(h,null,{default:(0,o.k6)((()=>[(0,o.bF)(k,{selected:"api"===c.tokenType,onInput:t[0]||(t[0]=e=>c.tokenType="api")},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" API Tokens ")]))),_:1},8,["selected"]),(0,o.bF)(k,{selected:"jwt"===c.tokenType,onInput:t[1]||(t[1]=e=>c.tokenType="jwt")},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" JWT Tokens ")]))),_:1},8,["selected"])])),_:1})])]),(0,o.Lk)("div",i,["jwt"===c.tokenType?((0,o.uX)(),(0,o.Wv)(y,{key:0,"current-user":n.currentUser},null,8,["current-user"])):((0,o.uX)(),(0,o.Wv)(f,{key:1,"current-user":n.currentUser},null,8,["current-user"]))])]))])}var c=n(33),u=n(3751);const p={class:"token-container"},k={class:"token-container"},h=["textContent"],y={class:"form-container"},f={type:"password",name:"password",ref:"password",placeholder:"Password"},g={class:"body"},m={class:"buttons"};function v(e,t,n,s,a,l){const r=(0,o.g2)("Loading"),i=(0,o.g2)("Modal"),d=(0,o.g2)("TokensList"),v=(0,o.g2)("Description");return(0,o.uX)(),(0,o.CE)("div",p,[a.loading?((0,o.uX)(),(0,o.Wv)(r,{key:0})):(0,o.Q3)("",!0),(0,o.bF)(i,{ref:"tokenModal"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",k,[t[7]||(t[7]=(0,o.Lk)("label",null,[(0,o.eW)(" This is your generated token. Treat it carefully and do not share it with untrusted parties."),(0,o.Lk)("br"),(0,o.eW)(" Also, make sure to save it - it WILL NOT be displayed again. ")],-1)),(0,o.Lk)("textarea",{class:"token",textContent:(0,c.v_)(a.token),onFocus:t[0]||(t[0]=t=>e.copyToClipboard(t.target.value))},null,40,h)])])),_:1},512),(0,o.bF)(i,{title:"Generate an API token",ref:"tokenParamsModal",onOpen:t[2]||(t[2]=t=>e.$nextTick((()=>e.$refs.password.focus()))),onClose:t[3]||(t[3]=t=>e.$refs.generateTokenForm.reset())},{default:(0,o.k6)((()=>[(0,o.Lk)("div",y,[t[13]||(t[13]=(0,o.Lk)("p",null,"Confirm your credentials in order to generate a new API token.",-1)),(0,o.Lk)("form",{onSubmit:t[1]||(t[1]=(0,u.D$)(((...e)=>l.generateToken&&l.generateToken(...e)),["prevent"])),ref:"generateTokenForm"},[(0,o.Lk)("label",null,[t[8]||(t[8]=(0,o.Lk)("span",null,"Confirm password",-1)),(0,o.Lk)("span",null,[(0,o.Lk)("input",f,null,512)])]),t[9]||(t[9]=(0,o.Lk)("label",null,[(0,o.Lk)("span",null,[(0,o.eW)(" A friendly name used to identify this token - such as "),(0,o.Lk)("code",null,"My App"),(0,o.eW)(" or "),(0,o.Lk)("code",null,"My Site"),(0,o.eW)(". ")]),(0,o.Lk)("span",null,[(0,o.Lk)("input",{type:"text",name:"name",placeholder:"Token name"})])],-1)),t[10]||(t[10]=(0,o.Lk)("label",null,[(0,o.Lk)("span",null,"Token validity in days"),(0,o.Lk)("span",null,[(0,o.Lk)("input",{type:"text",name:"validityDays",placeholder:"Validity in days"})])],-1)),t[11]||(t[11]=(0,o.Lk)("span",{class:"note"},[(0,o.eW)(" Decimal values are also supported - e.g. "),(0,o.Lk)("i",null,"0.5"),(0,o.eW)(" means half a day (12 hours). An empty or zero value means that the token has no expiry date. ")],-1)),t[12]||(t[12]=(0,o.Lk)("label",null,[(0,o.Lk)("input",{type:"submit",class:"btn btn-primary",value:"Generate API Token"})],-1))],544)])])),_:1},512),(0,o.bF)(i,{title:"API Tokens",ref:"tokensModal",onClose:t[4]||(t[4]=e=>a.showTokens=!1)},{default:(0,o.k6)((()=>[a.showTokens?((0,o.uX)(),(0,o.Wv)(d,{key:0})):(0,o.Q3)("",!0)])),_:1},512),(0,o.Lk)("div",g,[(0,o.Lk)("div",m,[(0,o.Lk)("label",null,[(0,o.Lk)("button",{class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$refs.tokenParamsModal.show())}," Generate API Token ")]),(0,o.Lk)("label",null,[(0,o.Lk)("button",{class:"btn btn-default",onClick:t[6]||(t[6]=e=>a.showTokens=!0)}," Manage Tokens ")])]),t[18]||(t[18]=(0,o.Lk)("p",null,[(0,o.Lk)("b",null,"API tokens"),(0,o.eW)(" are randomly generated tokens that are stored encrypted on the server, and can be used to authenticate with the Platypush API. ")],-1)),(0,o.Lk)("p",null,[t[14]||(t[14]=(0,o.eW)(" When compared to the ")),t[15]||(t[15]=(0,o.Lk)("a",{href:"/#settings?page=tokens&type=jwt"},"JWT tokens",-1)),t[16]||(t[16]=(0,o.eW)(", API tokens have the following advantages: ")),t[17]||(t[17]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"They can be revoked at any time by the user who generated them, while JWT tokens can only be revoked by changing the user's password."),(0,o.Lk)("li",null,"Their payload is random and not generated from the user's password, so even if an attacker gains access to the server's encryption keys, they cannot impersonate the user."),(0,o.Lk)("li",null,"They can be generated with a friendly name that can be used to identify the token.")],-1)),(0,o.bF)(v)])])])}var b=n(4335);function w(e,t){return(0,o.uX)(),(0,o.CE)("p",null,t[0]||(t[0]=[(0,o.Fv)(" You can use your token to authenticate calls to the <code>/execute</code> endpoint or the Websocket routes.<br><br> You can include the token in your requests in any of the following ways: <ul><li> Specify it on the <code>Authorization: Bearer &lt;token&gt;</code> header (replace <code>&lt;token&gt;</code> with your token). </li><li> Specify it on the <code>X-Token &lt;token&gt;</code> header (replace <code>&lt;token&gt;</code> with your token). </li><li> Specify it as a URL parameter: <code>http://site:8008/execute?token=...</code>. </li><li> Specify it on the body of your JSON request: <code>{&quot;type&quot;:&quot;request&quot;, &quot;action&quot;, &quot;...&quot;, &quot;token&quot;:&quot;...&quot;}</code>. </li></ul>",7)]))}var L=n(6262);const C={},T=(0,L.A)(C,[["render",w]]);var A=T,W=n(9828),_=n(2002),x=n(9513);const I={class:"tokens-list-container"},$={key:2,class:"main"},D={class:"tokens-list"},S={class:"info"},X={class:"name"},E={class:"created-at"},F={class:"expires-at"},P={class:"actions"};function O(e,t,n,s,a,l){const r=(0,o.g2)("ConfirmDialog"),i=(0,o.g2)("Loading"),d=(0,o.g2)("NoItems"),u=(0,o.g2)("DropdownItem"),p=(0,o.g2)("Dropdown");return(0,o.uX)(),(0,o.CE)("div",I,[(0,o.bF)(r,{ref:"tokenDeleteConfirm",onInput:l.deleteToken,onClose:t[0]||(t[0]=e=>a.tokenToDelete=null)},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.Lk)("p",null,"Are you sure you want to delete this token?",-1),(0,o.Lk)("b",null," Any application that uses this token will no longer be able to authenticate with the Platypush API. This action cannot be undone. ",-1)]))),_:1},8,["onInput"]),a.loading?((0,o.uX)(),(0,o.Wv)(i,{key:0})):l.tokens?.length?((0,o.uX)(),(0,o.CE)("div",$,[(0,o.Lk)("div",D,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.tokens,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"token",key:e.id},[(0,o.Lk)("div",S,[(0,o.Lk)("div",X,[(0,o.Lk)("b",null,(0,c.v_)(e.name),1)]),(0,o.Lk)("div",E,[t[3]||(t[3]=(0,o.eW)(" Created at: ")),(0,o.Lk)("b",null,(0,c.v_)(e.created_at),1)]),(0,o.Lk)("div",F,[t[4]||(t[4]=(0,o.eW)(" Expires at: ")),(0,o.Lk)("b",null,(0,c.v_)(e.expires_at),1)])]),(0,o.Lk)("div",P,[(0,o.bF)(p,{title:"Actions","icon-class":"fa fa-ellipsis-h"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{text:"Delete","icon-class":"fa fa-trash",onInput:t=>a.tokenToDelete=e},null,8,["onInput"])])),_:2},1024)])])))),128))])])):((0,o.uX)(),(0,o.Wv)(d,{key:1,"with-shadow":!1},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.Lk)("p",null,"No tokens have been generated yet.",-1)]))),_:1}))])}var U=n(3538),q=n(9265),M=n(9612),j=n(6561),J={name:"Token",mixins:[_.A],components:{ConfirmDialog:U.A,Dropdown:q.A,DropdownItem:M.A,Loading:W.A,NoItems:j.A},data(){return{loading:!1,tokens_:[],tokenToDelete:null}},computed:{tokens(){return this.tokens_.map((e=>({...e,created_at:e.created_at?this.formatDateTime(e.created_at,!1,!1):"N/A",expires_at:e.expires_at?this.formatDateTime(e.expires_at,!1,!1):"never"})))}},methods:{async refresh(){this.loading=!0;try{this.tokens_=(await b.A.get("/tokens")).data?.tokens}catch(e){console.error(e.toString()),this.notify({text:e.response?.data?.message||e.response?.data?.error||e.toString(),error:!0})}finally{this.loading=!1}},async deleteToken(){if(this.tokenToDelete){this.loading=!0;try{await b.A.delete("/tokens",{data:{token_id:this.tokenToDelete.id}}),await this.refresh()}catch(e){console.error(e.toString()),this.notify({text:e.response?.data?.message||e.response?.data?.error||e.toString(),error:!0})}finally{this.loading=!1}}}},watch:{$route(){this.refresh()},tokenToDelete(e){e?this.$refs.tokenDeleteConfirm.open():this.$refs.tokenDeleteConfirm.close()}},mounted(){this.refresh()}};const N=(0,L.A)(J,[["render",O]]);var G=N,H={name:"Token",mixins:[_.A],components:{Description:A,Loading:W.A,Modal:x.A,TokensList:G},props:{currentUser:{type:Object,required:!0}},data(){return{loading:!1,showTokens:!1,token:null}},methods:{async generateToken(e){const t=this.currentUser.username,n=e.target.password.value,o=e.target.name.value;let s=e.target.validityDays?.length?parseInt(e.target.validityDays.value):0;s||(s=null),this.loading=!0;try{this.token=(await b.A.post("/auth?type=token",{username:t,password:n,name:o,expiry_days:s})).data.token,this.token?.length&&this.$refs.tokenModal.show()}catch(a){console.error(a.toString()),this.notify({text:a.toString(),error:!0})}finally{this.loading=!1}}},watch:{showTokens(e){e?this.$refs.tokensModal.show():this.$refs.tokensModal.close()}}};const B=(0,L.A)(H,[["render",v]]);var Q=B;const R={class:"token-container"},K={class:"token-container"},Y=["textContent"],z={class:"form-container"},V={type:"password",name:"password",ref:"password",placeholder:"Password"},Z={class:"body"},ee={class:"generate-btn-container"};function te(e,t,n,s,a,l){const r=(0,o.g2)("Loading"),i=(0,o.g2)("Modal"),d=(0,o.g2)("Description");return(0,o.uX)(),(0,o.CE)("div",R,[a.loading?((0,o.uX)(),(0,o.Wv)(r,{key:0})):(0,o.Q3)("",!0),(0,o.bF)(i,{ref:"tokenModal"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",K,[t[5]||(t[5]=(0,o.Lk)("label",null,[(0,o.eW)(" This is your generated token. Treat it carefully and do not share it with untrusted parties."),(0,o.Lk)("br"),(0,o.eW)(" Also, make sure to save it - it WILL NOT be displayed again. ")],-1)),(0,o.Lk)("textarea",{class:"token",textContent:(0,c.v_)(a.token),onFocus:t[0]||(t[0]=t=>e.copyToClipboard(t.target.value))},null,40,Y)])])),_:1},512),(0,o.bF)(i,{title:"Generate a JWT token",ref:"tokenParamsModal",onOpen:t[2]||(t[2]=t=>e.$nextTick((()=>e.$refs.password.focus()))),onClose:t[3]||(t[3]=t=>e.$refs.generateTokenForm.reset())},{default:(0,o.k6)((()=>[(0,o.Lk)("div",z,[t[10]||(t[10]=(0,o.Lk)("p",null,"Confirm your credentials in order to generate a new JWT token.",-1)),(0,o.Lk)("form",{onSubmit:t[1]||(t[1]=(0,u.D$)(((...e)=>l.generateToken&&l.generateToken(...e)),["prevent"])),ref:"generateTokenForm"},[(0,o.Lk)("label",null,[t[6]||(t[6]=(0,o.Lk)("span",null,"Confirm password",-1)),(0,o.Lk)("span",null,[(0,o.Lk)("input",V,null,512)])]),t[7]||(t[7]=(0,o.Lk)("label",null,[(0,o.Lk)("span",null,"Token validity in days"),(0,o.Lk)("span",null,[(0,o.Lk)("input",{type:"text",name:"validityDays",placeholder:"Validity in days"})])],-1)),t[8]||(t[8]=(0,o.Lk)("span",{class:"note"},[(0,o.eW)(" Decimal values are also supported - e.g. "),(0,o.Lk)("i",null,"0.5"),(0,o.eW)(" means half a day (12 hours). An empty or zero value means that the token has no expiry date. ")],-1)),t[9]||(t[9]=(0,o.Lk)("label",null,[(0,o.Lk)("input",{type:"submit",class:"btn btn-primary",value:"Generate JWT Token"})],-1))],544)])])),_:1},512),(0,o.Lk)("div",Z,[(0,o.Lk)("label",ee,[(0,o.Lk)("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=t=>e.$refs.tokenParamsModal.show())}," Generate JWT Token ")]),t[20]||(t[20]=(0,o.Lk)("p",null,[(0,o.Lk)("b",null,"JWT tokens"),(0,o.eW)(" are bearer-only, and they contain encrypted authentication information. ")],-1)),t[21]||(t[21]=(0,o.Lk)("p",null," They can be used as permanent or time-based tokens to authenticate with the Platypush API. ",-1)),(0,o.Lk)("p",null,[t[11]||(t[11]=(0,o.eW)(" When compared to the standard ")),t[12]||(t[12]=(0,o.Lk)("a",{href:"/#settings?page=tokens&type=api"},"API tokens",-1)),t[13]||(t[13]=(0,o.eW)(", JWT tokens have the following pros: ")),t[14]||(t[14]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"They are not stored on the server, so compromising the server does not necessarily compromise the tokens too.")],-1)),t[15]||(t[15]=(0,o.eW)(" And the following cons: ")),t[16]||(t[16]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"They are not revocable - once generated, they can be used indefinitely until they expire."),(0,o.Lk)("li",null,"The only way to revoke a JWT token is to change the user's password. However, if a user changes their password, all the JWT tokens generated with the old password will be invalidated."),(0,o.Lk)("li",null,"Their payload is the encrypted representation of the user's credentials, but without any OTP information, so an attacker gains access to the user's credentials and the server's encryption keys they can impersonate the user indefinitely bypassing 2FA.")],-1)),t[17]||(t[17]=(0,o.eW)(" For these reasons, it is recommended to use generic API tokens over JWT tokens for most use cases.")),t[18]||(t[18]=(0,o.Lk)("br",null,null,-1)),t[19]||(t[19]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(d)])])])}var ne={name:"Token",components:{Description:A,Loading:W.A,Modal:x.A},mixins:[_.A],props:{currentUser:{type:Object,required:!0}},data(){return{loading:!1,token:null}},methods:{async generateToken(e){const t=this.currentUser.username,n=e.target.password.value;let o=e.target.validityDays?.length?parseInt(e.target.validityDays.value):0;o||(o=null),this.loading=!0;try{this.token=(await b.A.post("/auth?type=jwt",{username:t,password:n,expiry_days:o})).data.token,this.token?.length&&this.$refs.tokenModal.show()}catch(s){console.error(s.toString()),this.notify({text:s.toString(),error:!0})}finally{this.loading=!1}}}};const oe=(0,L.A)(ne,[["render",te]]);var se=oe,ae=n(5054),le=n(3556),re={mixins:[_.A],components:{ApiToken:Q,JwtToken:se,Loading:W.A,Tab:ae.A,Tabs:le.A},props:{currentUser:{type:Object,required:!0}},data(){return{loading:!1,token:null,tokenType:null}},methods:{refresh(){const e=this.getUrlArgs();this.$nextTick((()=>{this.tokenType=e.type?.length?e.type:"api"}))}},watch:{tokenType(e){this.setUrlArgs({type:e})},$route(){this.refresh()}},mounted(){this.refresh()},unmounted(){this.setUrlArgs({type:null})}};const ie=(0,L.A)(re,[["render",d],["__scopeId","data-v-8b92029c"]]);var de=ie}}]);
//# sourceMappingURL=806.a3972e99.js.map
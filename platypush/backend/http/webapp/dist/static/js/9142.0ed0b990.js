"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[9142],{226:function(e,t,s){s.d(t,{A:function(){return r}});s(4114);var n=s(2002),a={name:"Utils",mixins:[n.A],computed:{audioExtensions(){return new Set(["3gp","aa","aac","aax","act","aiff","amr","ape","au","awb","dct","dss","dvf","flac","gsm","iklax","ivs","m4a","m4b","m4p","mmf","mp3","mpc","msv","nmf","nsf","ogg,","opus","ra,","raw","sln","tta","vox","wav","wma","wv","webm","8svx"])},videoExtensions(){return new Set(["webm","mkv","flv","flv","vob","ogv","ogg","drc","gif","gifv","mng","avi","mts","m2ts","mov","qt","wmv","yuv","rm","rmvb","asf","amv","mp4","m4p","m4v","mpg","mp2","mpeg","mpe","mpv","mpg","mpeg","m2v","m4v","svi","3gp","3g2","mxf","roq","nsv","flv","f4v","f4p","f4a","f4b"])},mediaExtensions(){return new Set([...this.videoExtensions,...this.audioExtensions])}},methods:{convertTime(e){e=parseFloat(e);const t={};t.h=""+parseInt(e/3600),t.m=""+parseInt(e/60-60*t.h),t.s=""+parseInt(e-(3600*t.h+60*t.m));for(const n of["m","s"])parseInt(t[n])<10&&(t[n]="0"+t[n]);const s=[];return parseInt(t.h)&&s.push(t.h),s.push(t.m,t.s),s.join(":")},async startStreaming(e,t,s=!1){let n=e,a=null;e instanceof Object?(n=e.url,a=e.subtitles):e={url:n};const l=await this.request(`${t}.start_streaming`,{media:n,subtitles:a,download:s});return{...e,...l}},async stopStreaming(e,t){await this.request(`${t}.stop_streaming`,{media_id:e})}}};const l=a;var r=l},9265:function(e,t,s){s.d(t,{A:function(){return h}});var n=s(641),a=s(3751),l=s(33);const r={class:"dropdown-container"},o=["title"],i=["textContent"];function d(e,t,s,d,c,u){const p=(0,n.g2)("DropdownBody");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("button",{title:s.title,ref:"button",onClick:t[0]||(t[0]=(0,a.D$)((e=>u.toggle(e)),["stop"]))},[s.iconClass?((0,n.uX)(),(0,n.CE)("i",{key:0,class:(0,l.C4)(["icon",s.iconClass])},null,2)):(0,n.Q3)("",!0),s.text?((0,n.uX)(),(0,n.CE)("span",{key:1,class:"text",textContent:(0,l.v_)(s.text)},null,8,i)):(0,n.Q3)("",!0)],8,o),(0,n.Lk)("div",{class:(0,l.C4)(["body-container",{hidden:!c.visible}]),ref:"dropdownContainer"},[(0,n.bF)(p,{id:s.id,keepOpenOnItemClick:s.keepOpenOnItemClick,style:(0,l.Tr)(s.style),ref:"dropdown",onClick:u.onClick},{default:(0,n.k6)((()=>[(0,n.RG)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","style","onClick"])],2)])}var c=s(4200),u=s(2537),p={components:{DropdownBody:c.A},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}},data(){return{visible:!1}},computed:{button(){const e=this.$refs.button?.$el;return e?e.querySelector("button"):this.$refs.button},buttonStyle(){return this.button?getComputedStyle(this.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),u.j.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$nextTick(this.adjustDropdownPos)},adjustDropdownPos(){const e=this.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},s={left:t.left,top:t.top+this.buttonHeight},n=this.getDropdownWidth(),a=this.getDropdownHeight();if(s.left+n>(window.innerWidth+window.scrollX)/2&&(s.left-=n-this.buttonWidth),s.top+a>(window.innerHeight+window.scrollY)/2){let e=s.top-(a+this.buttonHeight-10);e<0&&(e=0),s.top=e}const l=this.$refs.dropdown.$el;l.classList.add("fade-in"),l.style.top=`${s.top}px`,l.style.left=`${s.left}px`,u.j.emit("dropdown-open",this.$refs.dropdown)},toggle(e){e?.stopPropagation(),this.$emit("click",e),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}},v=s(6262);const f=(0,v.A)(p,[["render",d],["__scopeId","data-v-3f1ad726"]]);var h=f},4200:function(e,t,s){s.d(t,{A:function(){return c}});var n=s(641),a=s(33);const l=["id"];function r(e,t,s,r,o,i){return(0,n.uX)(),(0,n.CE)("div",{class:"dropdown",id:s.id,style:(0,a.Tr)(s.style),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,n.RG)(e.$slots,"default",{},void 0,!0)],12,l)}var o={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1},style:{type:Object,default:()=>({})}}},i=s(6262);const d=(0,i.A)(o,[["render",r],["__scopeId","data-v-24c5aa28"]]);var c=d},9612:function(e,t,s){s.d(t,{A:function(){return f}});var n=s(641),a=s(33);const l=["title"],r={key:0,class:"col-2 icon"},o=["textContent"];function i(e,t,s,i,d,c){const u=(0,n.g2)("Icon");return(0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["row item",{...c.itemClass_,disabled:s.disabled}]),title:s.hoverText,onClick:t[0]||(t[0]=(...e)=>c.clicked&&c.clicked(...e))},[s.iconClass?.length||s.iconUrl?.length?((0,n.uX)(),(0,n.CE)("div",r,[(0,n.bF)(u,{class:(0,a.C4)(s.iconClass),url:s.iconUrl},null,8,["class","url"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,a.C4)(["text",{"col-10":null!=s.iconClass}]),textContent:(0,a.v_)(s.text)},null,10,o)],10,l)}var d=s(3778),c=s(2537),u={components:{Icon:d.A},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||c.j.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},p=s(6262);const v=(0,p.A)(u,[["render",i],["__scopeId","data-v-2babe09c"]]);var f=v},3778:function(e,t,s){s.d(t,{A:function(){return u}});var n=s(641),a=s(33);const l={class:"icon-container"},r=["src","alt"];function o(e,t,s,o,i,d){return(0,n.uX)(),(0,n.CE)("div",l,[s.url?.length?((0,n.uX)(),(0,n.CE)("img",{key:0,class:"icon",src:s.url,alt:s.alt},null,8,r)):d.className?.length?((0,n.uX)(),(0,n.CE)("i",{key:1,class:(0,a.C4)(["icon",d.className]),style:(0,a.Tr)({color:s.color})},null,6)):(0,n.Q3)("",!0)])}var i={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=s(6262);const c=(0,d.A)(i,[["render",o],["__scopeId","data-v-706a3bd1"]]);var u=c},9142:function(e,t,s){s.d(t,{A:function(){return st}});var n=s(641),a=s(33);const l={class:"torrent-container"},r={class:"nav-container"};function o(e,t,s,o,i,d){const c=(0,n.g2)("Info"),u=(0,n.g2)("Modal"),p=(0,n.g2)("Header"),v=(0,n.g2)("Transfers"),f=(0,n.g2)("Results"),h=(0,n.g2)("Nav");return(0,n.uX)(),(0,n.CE)("div",l,[d.infoItem?((0,n.uX)(),(0,n.Wv)(u,{key:0,title:"Torrent info",visible:null!==d.infoItem,onClose:t[0]||(t[0]=e=>i.infoIndex=null)},{default:(0,n.k6)((()=>[(0,n.bF)(c,{torrent:d.infoItem},null,8,["torrent"])])),_:1},8,["visible"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,a.C4)(["header-container",{"with-nav":!i.navCollapsed}])},[(0,n.bF)(p,{"with-nav":!i.navCollapsed,"selected-view":i.selectedView,loading:i.loading,onSearch:t[1]||(t[1]=e=>d.search(e)),onTorrentAdd:t[2]||(t[2]=e=>d.download(e)),onToggle:t[3]||(t[3]=e=>i.navCollapsed=!i.navCollapsed)},null,8,["with-nav","selected-view","loading"])],2),(0,n.Lk)("main",null,[(0,n.Lk)("div",{class:(0,a.C4)(["view-container",{"with-nav":!i.navCollapsed}])},["transfers"===i.selectedView?((0,n.uX)(),(0,n.Wv)(v,{key:0,transfers:i.transfers,onPause:t[4]||(t[4]=e=>d.pause(e)),onResume:t[5]||(t[5]=e=>d.resume(e)),onRemove:t[6]||(t[6]=e=>d.remove(e))},null,8,["transfers"])):"search"===i.selectedView?((0,n.uX)(),(0,n.Wv)(f,{key:1,results:i.results,onDownload:t[7]||(t[7]=e=>d.download(e)),onInfo:t[8]||(t[8]=e=>i.infoIndex=e),onNextPage:t[9]||(t[9]=e=>d.search(i.query,i.page+1))},null,8,["results"])):(0,n.Q3)("",!0)],2),(0,n.Lk)("div",r,[i.navCollapsed?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(h,{key:0,"selected-view":i.selectedView,onToggle:t[10]||(t[10]=e=>i.navCollapsed=!i.navCollapsed),onInput:t[11]||(t[11]=e=>i.selectedView=e)},null,8,["selected-view"]))])])])}const i=e=>((0,n.Qi)("data-v-8eed74b0"),e=e(),(0,n.jt)(),e),d={class:"info"},c={class:"row"},u=i((()=>(0,n.Lk)("div",{class:"label"},"Title",-1))),p={class:"value"},v={class:"row"},f=i((()=>(0,n.Lk)("div",{class:"label"},"URL",-1))),h={class:"value"},m=i((()=>(0,n.Lk)("i",{class:"fas fa-up-right-from-square"},null,-1))),k=[m],g=i((()=>(0,n.Lk)("i",{class:"fas fa-clipboard"},null,-1))),y=[g],C={class:"row"},w=i((()=>(0,n.Lk)("div",{class:"label"},"Size",-1))),b={class:"value"},L={class:"row"},I=i((()=>(0,n.Lk)("div",{class:"label"},"Seeders",-1))),x={class:"value"},_={class:"row"},E=i((()=>(0,n.Lk)("div",{class:"label"},"Leechers",-1))),T={class:"value"},S={class:"row"},$=i((()=>(0,n.Lk)("div",{class:"label"},"Uploaded",-1))),X={class:"value"},A={key:0,class:"row"},Q=i((()=>(0,n.Lk)("div",{class:"label"},"Description",-1))),D={class:"value"},F={key:1,class:"row"},N=i((()=>(0,n.Lk)("div",{class:"label"},"Year",-1))),U={class:"value"};function R(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("div",d,[(0,n.Lk)("div",c,[u,(0,n.Lk)("div",p,(0,a.v_)(s.torrent.title),1)]),(0,n.Lk)("div",v,[f,(0,n.Lk)("div",h,[(0,n.Lk)("button",{title:"Open",onClick:t[0]||(t[0]=e=>o.openInNewTab(s.torrent.url))},k),(0,n.Lk)("button",{title:"Copy",onClick:t[1]||(t[1]=t=>e.copyToClipboard(s.torrent.url))},y)])]),(0,n.Lk)("div",C,[w,(0,n.Lk)("div",b,(0,a.v_)(e.convertSize(s.torrent.size)),1)]),(0,n.Lk)("div",L,[I,(0,n.Lk)("div",x,(0,a.v_)(s.torrent.seeds),1)]),(0,n.Lk)("div",_,[E,(0,n.Lk)("div",T,(0,a.v_)(s.torrent.peers),1)]),(0,n.Lk)("div",S,[$,(0,n.Lk)("div",X,(0,a.v_)(e.formatDate(s.torrent.created_at,!0)),1)]),s.torrent.description?((0,n.uX)(),(0,n.CE)("div",A,[Q,(0,n.Lk)("div",D,(0,a.v_)(s.torrent.description),1)])):(0,n.Q3)("",!0),s.torrent.year?((0,n.uX)(),(0,n.CE)("div",F,[N,(0,n.Lk)("div",U,(0,a.v_)(s.torrent.year),1)])):(0,n.Q3)("",!0)])}var O=s(2002),q={mixins:[O.A],props:{torrent:{type:Object,default:()=>({})}},methods:{openInNewTab(e){window.open(e,"_blank")}}},V=s(6262);const j=(0,V.A)(q,[["render",R],["__scopeId","data-v-8eed74b0"]]);var P=j,H=s(3751);const W=e=>((0,n.Qi)("data-v-0ae4cd8d"),e=e(),(0,n.jt)(),e),z={class:"row"},B={class:"search-box"},K=["disabled","placeholder"],M=["placeholder","value"],Y={class:"button-container"},G={key:0,type:"submit",title:"Loading",disabled:""},J={key:1,type:"submit",title:"Add torrent URL"},Z=W((()=>(0,n.Lk)("i",{class:"fa fa-download"},null,-1))),ee=[Z],te={key:2,type:"submit",title:"Search"},se=W((()=>(0,n.Lk)("i",{class:"fa fa-search"},null,-1))),ne=[se],ae={key:0,class:"right side col-1"},le=W((()=>(0,n.Lk)("i",{class:"fa fa-bars"},null,-1))),re=[le];function oe(e,t,s,l,r,o){const i=(0,n.g2)("Loading");return(0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["header",{"with-nav":s.withNav}])},[(0,n.Lk)("div",z,[(0,n.Lk)("div",{class:(0,a.C4)(["left side",o.leftSideClasses])},[(0,n.Lk)("form",{onSubmit:t[1]||(t[1]=(0,H.D$)(((...e)=>o.submit&&o.submit(...e)),["prevent"]))},[(0,n.Lk)("label",B,["transfers"===s.selectedView?(0,n.bo)(((0,n.uX)(),(0,n.CE)("input",{key:0,type:"search",disabled:s.loading,placeholder:o.placeholder,"onUpdate:modelValue":t[0]||(t[0]=e=>r.torrentURL=e)},null,8,K)),[[H.Jo,r.torrentURL]]):"search"===s.selectedView?((0,n.uX)(),(0,n.CE)("input",{key:1,type:"search",placeholder:o.placeholder,value:s.query,ref:"search"},null,8,M)):(0,n.Q3)("",!0)]),(0,n.Lk)("span",Y,[s.loading?((0,n.uX)(),(0,n.CE)("button",G,[(0,n.bF)(i)])):"transfers"===s.selectedView?((0,n.uX)(),(0,n.CE)("button",J,ee)):"search"===s.selectedView?((0,n.uX)(),(0,n.CE)("button",te,ne)):(0,n.Q3)("",!0)])],32)],2),s.withNav?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",ae,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=t=>e.$emit("toggle")),title:"Toggle navigation"},re)]))])],2)}var ie=s(9828),de={name:"Header",emits:["torrent-add","search","toggle"],components:{Loading:ie.A},props:{query:{type:String,default:""},loading:{type:Boolean,default:!1},withNav:{type:Boolean,default:!1},selectedView:{type:String,default:"transfers"}},data(){return{torrentURL:""}},computed:{placeholder(){return"transfers"===this.selectedView?"Add torrent URL":"Search torrents"},leftSideClasses(){return this.withNav?{"col-11":!0}:{"col-12":!0}}},methods:{submit(){const e=this.$refs?.search?.value?.trim();"transfers"===this.selectedView&&this.torrentURL?.length?this.$emit("torrent-add",this.torrentURL):"search"===this.selectedView&&e?.length&&this.$emit("search",e)}}};const ce=(0,V.A)(de,[["render",oe],["__scopeId","data-v-0ae4cd8d"]]);var ue=ce,pe=s(9513);const ve=e=>((0,n.Qi)("data-v-5185ff00"),e=e(),(0,n.jt)(),e),fe=ve((()=>(0,n.Lk)("i",{class:"fa fa-bars"},null,-1))),he=[fe],me=["title","onClick"];function ke(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("nav",null,[(0,n.Lk)("button",{class:"menu-button",onClick:t[0]||(t[0]=t=>e.$emit("toggle"))},he),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.views,((t,l)=>((0,n.uX)(),(0,n.CE)("li",{key:l,title:t.displayName,class:(0,a.C4)({selected:l===s.selectedView}),onClick:t=>e.$emit("input",l)},[(0,n.Lk)("i",{class:(0,a.C4)(t.iconClass)},null,2)],10,me)))),128))])}var ge={emits:["input","toggle"],props:{selectedView:{type:String},collapsed:{type:Boolean,default:!1},views:{type:Object,default:()=>({search:{displayName:"Search",iconClass:"fa fa-search"},transfers:{displayName:"Transfers",iconClass:"fa fa-download"}})}}};const ye=(0,V.A)(ge,[["render",ke],["__scopeId","data-v-5185ff00"]]);var Ce=ye;const we=e=>((0,n.Qi)("data-v-52a230bc"),e=e(),(0,n.jt)(),e),be={class:"results-container"},Le={key:0,class:"no-content"},Ie={class:"info"},xe={class:"title"},_e={class:"additional-info"},Ee={class:"info-pill size"},Te=we((()=>(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-hdd"})],-1))),Se=we((()=>(0,n.Lk)("span",{class:"separator"},null,-1))),$e={class:"value"},Xe=we((()=>(0,n.Lk)("span",{class:"separator"}," | ",-1))),Ae={class:"info-pill seeds"},Qe=we((()=>(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-users"})],-1))),De=we((()=>(0,n.Lk)("span",{class:"separator"},null,-1))),Fe={class:"value"},Ne=we((()=>(0,n.Lk)("span",{class:"separator"}," | ",-1))),Ue={class:"info-pill created-at"},Re=we((()=>(0,n.Lk)("span",{class:"label"},[(0,n.Lk)("i",{class:"fa fa-calendar"})],-1))),Oe=we((()=>(0,n.Lk)("span",{class:"separator"},null,-1))),qe={class:"value"},Ve=we((()=>(0,n.Lk)("span",{class:"separator"}," | ",-1))),je={class:"actions"},Pe=["onClick"],He=we((()=>(0,n.Lk)("i",{class:"fa fa-info-circle"},null,-1))),We=[He],ze=["onClick"],Be=we((()=>(0,n.Lk)("i",{class:"fa fa-download"},null,-1))),Ke=[Be];function Me(e,t,s,l,r,o){return(0,n.uX)(),(0,n.CE)("div",be,[s.results?.length?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"results",ref:"body",onScroll:t[0]||(t[0]=(...e)=>o.onScroll&&o.onScroll(...e))},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.results,((t,s)=>((0,n.uX)(),(0,n.CE)("div",{class:"result",key:s},[(0,n.Lk)("div",Ie,[(0,n.Lk)("div",xe,(0,a.v_)(t.title),1),(0,n.Lk)("div",_e,[(0,n.Lk)("span",Ee,[Te,Se,(0,n.Lk)("span",$e,(0,a.v_)(e.convertSize(t.size)),1)]),Xe,(0,n.Lk)("span",Ae,[Qe,De,(0,n.Lk)("span",Fe,(0,a.v_)(t.seeds),1)]),Ne,(0,n.Lk)("span",Ue,[Re,Oe,(0,n.Lk)("span",qe,(0,a.v_)(e.formatDate(t.created_at,!0)),1)]),Ve])]),(0,n.Lk)("div",je,[(0,n.Lk)("button",{title:"Torrent info",onClick:t=>e.$emit("info",s)},We,8,Pe),(0,n.Lk)("button",{title:"Download",onClick:s=>e.$emit("download",t.url)},Ke,8,ze)])])))),128))],544)):((0,n.uX)(),(0,n.CE)("div",Le,"No results"))])}var Ye={emits:["download","info","next-page"],mixins:[O.A],props:{results:{type:Array,default:()=>[]},page:{type:Number,default:1}},data(){return{scrollTimeout:null}},methods:{onScroll(){const e=this.$refs.body.scrollTop,t=parseFloat(getComputedStyle(this.$refs.body).height),s=this.$refs.body.scrollHeight;if(e>=s-t-5){if(this.scrollTimeout||!this.results.length)return;this.scrollTimeout=setTimeout((()=>{this.scrollTimeout=null}),250),this.$emit("next-page",this.page+1)}}}};const Ge=(0,V.A)(Ye,[["render",Me],["__scopeId","data-v-52a230bc"]]);var Je=Ge,Ze=s(5007),et={mixins:[O.A],components:{Info:P,Header:ue,Modal:pe.A,Nav:Ce,Results:Je,Transfers:Ze.A},props:{pluginName:{type:String,required:!0}},data(){return{loading:!1,transfers:{},results:[],selectedView:"transfers",navCollapsed:!1,query:"",page:1,infoIndex:null}},computed:{infoItem(){return null===this.infoIndex?null:this.results[this.infoIndex]}},methods:{torrentId(e){return e?.hash&&e.hash.length?e.hash:e.url},onTorrentUpdate(e){this.transfers[this.torrentId(e)]=e},onTorrentQueued(e){this.onTorrentUpdate(e),this.notify({text:"Torrent queued for download",image:{icon:"hourglass-start"}})},onTorrentStart(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download started: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentResume(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download resumed: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentPause(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download paused: <b>${e.name}</b>`,image:{icon:"pause"}})},onTorrentCompleted(e){this.onTorrentUpdate(e),this.transfers[this.torrentId(e)].finish_date=(new Date).toISOString(),this.transfers[this.torrentId(e)].progress=100,this.notify({html:`Torrent download completed: <b>${e.name}</b>`,image:{icon:"check"}})},onTorrentRemove(e){const t=this.torrentId(e);t in this.transfers&&delete this.transfers[t]},async search(e,t=1){this.loading=!0,this.query=e;let s=[];try{s=await this.request(`${this.pluginName}.search`,{query:e,page:t})}finally{this.loading=!1}this.results=1===t?s:this.results.concat(s),s.length>0&&(this.page=t)},async download(e){await this.request(`${this.pluginName}.download`,{torrent:e})},async pause(e){await this.request(`${this.pluginName}.pause`,{torrent:e.url}),await this.refresh()},async resume(e){await this.request(`${this.pluginName}.resume`,{torrent:e.url}),await this.refresh()},async remove(e){await this.request(`${this.pluginName}.remove`,{torrent:e.url}),await this.refresh()},async refresh(){this.loading=!0;try{this.transfers=Object.values(await this.request(`${this.pluginName}.status`)||{}).reduce(((e,t)=>(e[this.torrentId(t)]=t,e)),{})}finally{this.loading=!1}}},mounted(){this.refresh(),this.selectedView=this.transfers.length?"transfers":"search",this.subscribe(this.onTorrentUpdate,"on-torrent-update","platypush.message.event.torrent.TorrentDownloadStartEvent","platypush.message.event.torrent.TorrentDownloadProgressEvent","platypush.message.event.torrent.TorrentSeedingStartEvent","platypush.message.event.torrent.TorrentStateChangeEvent"),this.subscribe(this.onTorrentQueued,"on-torrent-queued","platypush.message.event.torrent.TorrentQueuedEvent"),this.subscribe(this.onTorrentStart,"on-torrent-queued","platypush.message.event.torrent.TorrentDownloadedMetadataEvent"),this.subscribe(this.onTorrentResume,"on-torrent-resume","platypush.message.event.torrent.TorrentResumedEvent"),this.subscribe(this.onTorrentPause,"on-torrent-pause","platypush.message.event.torrent.TorrentPausedEvent"),this.subscribe(this.onTorrentStop,"on-torrent-stop","platypush.message.event.torrent.TorrentDownloadStopEvent"),this.subscribe(this.onTorrentCompleted,"on-torrent-completed","platypush.message.event.torrent.TorrentDownloadCompletedEvent"),this.subscribe(this.onTorrentRemove,"on-torrent-remove","platypush.message.event.torrent.TorrentRemovedEvent");const e=document.querySelector('.search-box input[type="search"]');e&&this.$nextTick((()=>e.focus()))},destroy(){this.unsubscribe("on-torrent-update"),this.unsubscribe("on-torrent-remove")}};const tt=(0,V.A)(et,[["render",o],["__scopeId","data-v-250eee36"]]);var st=tt},5007:function(e,t,s){s.d(t,{A:function(){return me}});var n=s(641),a=s(33);const l=e=>((0,n.Qi)("data-v-65e233cd"),e=e(),(0,n.jt)(),e),r={key:1,class:"torrent-transfers fade-in"},o={key:0,class:"no-content"},i=["onClick"],d={class:"col-8 left side"},c=["textContent"],u={class:"col-2 right side"},p=["textContent"],v={class:"col-2 right side"},f={key:0,class:"modal-body torrent-info"},h={key:0,class:"row"},m=l((()=>(0,n.Lk)("div",{class:"attr"},"Name",-1))),k=["textContent"],g={key:1,class:"row"},y=l((()=>(0,n.Lk)("div",{class:"attr"},"State",-1))),C=["textContent"],w={class:"row"},b=l((()=>(0,n.Lk)("div",{class:"attr"},"Progress",-1))),L=["textContent"],I={class:"row"},x=l((()=>(0,n.Lk)("div",{class:"attr"},"DL rate",-1))),_=["textContent"],E={class:"row"},T=l((()=>(0,n.Lk)("div",{class:"attr"},"UL rate",-1))),S=["textContent"],$={class:"row"},X=l((()=>(0,n.Lk)("div",{class:"attr"},"Size",-1))),A=["textContent"],Q={key:2,class:"row"},D=l((()=>(0,n.Lk)("div",{class:"attr"},"Remaining",-1))),F=["textContent"],N={class:"row"},U=l((()=>(0,n.Lk)("div",{class:"attr"},"URL",-1))),R={class:"value nowrap"},O=["href","textContent"],q={class:"row"},V=l((()=>(0,n.Lk)("div",{class:"attr"},"Peers",-1))),j=["textContent"],P={key:3,class:"row"},H=l((()=>(0,n.Lk)("div",{class:"attr"},"Started",-1))),W=["textContent"],z={key:4,class:"row"},B=l((()=>(0,n.Lk)("div",{class:"attr"},"Finished",-1))),K=["textContent"],M={key:5,class:"row"},Y=l((()=>(0,n.Lk)("div",{class:"attr"},"Save path",-1))),G=["textContent"],J={key:6,class:"row"},Z=l((()=>(0,n.Lk)("div",{class:"attr"},"Files",-1))),ee={class:"value files-container"},te=["href","textContent"],se={key:0,class:"modal-body torrent-files"},ne={class:"col-1 icon"},ae={key:1,class:"fa fa-file"},le=["textContent"];function re(e,t,s,l,re,oe){const ie=(0,n.g2)("Loading"),de=(0,n.g2)("DropdownItem"),ce=(0,n.g2)("Dropdown"),ue=(0,n.g2)("Modal");return re.loading?((0,n.uX)(),(0,n.Wv)(ie,{key:0})):((0,n.uX)(),(0,n.CE)("div",r,[Object.keys(s.transfers).length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",o,"No torrent transfers in progress")),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.transfers,((s,l)=>((0,n.uX)(),(0,n.CE)("div",{class:(0,a.C4)(["row item",{selected:re.selectedItem===l}]),key:l,onClick:e=>re.selectedItem=l},[(0,n.Lk)("div",d,[(0,n.Lk)("i",{class:(0,a.C4)(["icon fa",{"fa-check":null!=s.finish_date,"fa-play":!s.finish_date&&"downloading"===s.state&&!s.paused,"fa-pause":!s.finish_date&&"downloading"===s.state&&s.paused,"fa-stop":!s.finish_date&&"stopped"===s.state}])},null,2),(0,n.Lk)("div",{class:"title",textContent:(0,a.v_)(s.name||s.hash||s.url)},null,8,c)]),(0,n.Lk)("div",u,[(0,n.Lk)("span",{textContent:(0,a.v_)(`${s.progress}%`)},null,8,p)]),(0,n.Lk)("div",v,[(0,n.bF)(ce,{title:"Actions","icon-class":"fa fa-ellipsis-h",onClick:e=>re.selectedItem=l},{default:(0,n.k6)((()=>["downloading"!==s.state||s.paused?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(de,{key:0,"icon-class":"fa fa-pause",text:"Pause transfer",onInput:t=>e.$emit("pause",s)},null,8,["onInput"])),"downloading"===s.state&&s.paused?((0,n.uX)(),(0,n.Wv)(de,{key:1,"icon-class":"fa fa-play",text:"Resume transfer",onInput:t=>e.$emit("resume",s)},null,8,["onInput"])):(0,n.Q3)("",!0),(0,n.bF)(de,{"icon-class":"fa fa-trash",text:"Remove transfer",onInput:t=>e.$emit("remove",s)},null,8,["onInput"]),(0,n.bF)(de,{"icon-class":"fa fa-folder",text:"View files",onInput:t[0]||(t[0]=t=>e.$refs.torrentFiles.isVisible=!0)}),(0,n.bF)(de,{"icon-class":"fa fa-info",text:"Torrent info",onInput:t[1]||(t[1]=t=>e.$refs.torrentInfo.isVisible=!0)})])),_:2},1032,["onClick"])])],10,i)))),128)),(0,n.bF)(ue,{ref:"torrentInfo",title:"Torrent info",width:"80%"},{default:(0,n.k6)((()=>[null!=re.selectedItem&&s.transfers[re.selectedItem]?((0,n.uX)(),(0,n.CE)("div",f,[s.transfers[re.selectedItem].name?((0,n.uX)(),(0,n.CE)("div",h,[m,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[re.selectedItem].name)},null,8,k)])):(0,n.Q3)("",!0),s.transfers[re.selectedItem].state?((0,n.uX)(),(0,n.CE)("div",g,[y,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[re.selectedItem].state)},null,8,C)])):(0,n.Q3)("",!0),(0,n.Lk)("div",w,[b,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${s.transfers[re.selectedItem].progress||0}%`)},null,8,L)]),(0,n.Lk)("div",I,[x,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${e.convertSize(s.transfers[re.selectedItem].download_rate||0)}/s`)},null,8,_)]),(0,n.Lk)("div",E,[T,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(`${e.convertSize(s.transfers[re.selectedItem].upload_rate||0)}/s`)},null,8,S)]),(0,n.Lk)("div",$,[X,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.convertSize(s.transfers[re.selectedItem].size||0))},null,8,A)]),s.transfers[re.selectedItem].remaining_bytes?((0,n.uX)(),(0,n.CE)("div",Q,[D,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.convertSize(s.transfers[re.selectedItem].remaining_bytes))},null,8,F)])):(0,n.Q3)("",!0),(0,n.Lk)("div",N,[U,(0,n.Lk)("div",R,[(0,n.Lk)("a",{href:s.transfers[re.selectedItem].url,target:"_blank",textContent:(0,a.v_)(s.transfers[re.selectedItem].url)},null,8,O)])]),(0,n.Lk)("div",q,[V,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[re.selectedItem].peers||0)},null,8,j)]),s.transfers[re.selectedItem].start_date?((0,n.uX)(),(0,n.CE)("div",P,[H,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.formatDateTime(s.transfers[re.selectedItem].start_date))},null,8,W)])):(0,n.Q3)("",!0),s.transfers[re.selectedItem].finish_date?((0,n.uX)(),(0,n.CE)("div",z,[B,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(e.formatDateTime(s.transfers[re.selectedItem].finish_date))},null,8,K)])):(0,n.Q3)("",!0),s.transfers[re.selectedItem].save_path?((0,n.uX)(),(0,n.CE)("div",M,[Y,(0,n.Lk)("div",{class:"value",textContent:(0,a.v_)(s.transfers[re.selectedItem].save_path)},null,8,G)])):(0,n.Q3)("",!0),s.transfers[re.selectedItem].files?((0,n.uX)(),(0,n.CE)("div",J,[Z,(0,n.Lk)("div",ee,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.transfers[re.selectedItem].files,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"file",key:t},[(0,n.Lk)("a",{href:`/file?path=${encodeURIComponent(e)}`,target:"_blank",textContent:(0,a.v_)(e)},null,8,te)])))),128))])])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)])),_:1},512),(0,n.bF)(ue,{ref:"torrentFiles",title:"Torrent files",width:"80%"},{default:(0,n.k6)((()=>[null!=re.selectedItem&&s.transfers[re.selectedItem]?((0,n.uX)(),(0,n.CE)("div",se,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(oe.relativeFiles,((t,l)=>((0,n.uX)(),(0,n.CE)("div",{class:"row",key:t},[(0,n.Lk)("div",ne,[s.isMedia&&e.mediaExtensions.has(t.split(".").pop())?((0,n.uX)(),(0,n.Wv)(ce,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(de,{"icon-class":"fa fa-play",text:"Play",onInput:t=>e.$emit("play",{url:`file://${s.transfers[re.selectedItem].files[l]}`,type:"file"})},null,8,["onInput"])])),_:2},1024)):((0,n.uX)(),(0,n.CE)("i",ae))]),(0,n.Lk)("div",{class:"col-11 name",textContent:(0,a.v_)(t)},null,8,le)])))),128))])):(0,n.Q3)("",!0)])),_:1},512)]))}var oe=s(9828),ie=s(2002),de=s(226),ce=s(9513),ue=s(9265),pe=s(9612),ve={emits:["pause","play","play-with-captions","refresh","remove","resume"],components:{Dropdown:ue.A,DropdownItem:pe.A,Loading:oe.A,Modal:ce.A},mixins:[ie.A,de.A],props:{isMedia:{type:Boolean,default:!1},transfers:{type:Object,default:()=>({})}},data(){return{loading:!1,selectedItem:null}},computed:{relativeFiles(){return null!=this.selectedItem&&this.transfers[this.selectedItem]?.files?.length?this.transfers[this.selectedItem].files.map((e=>e.split("/").pop())):[]}}},fe=s(6262);const he=(0,fe.A)(ve,[["render",re],["__scopeId","data-v-65e233cd"]]);var me=he}}]);
//# sourceMappingURL=9142.0ed0b990.js.map
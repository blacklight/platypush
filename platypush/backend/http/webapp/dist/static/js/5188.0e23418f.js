"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[5188],{5188:function(t,e,n){n.r(e),n.d(e,{default:function(){return Y}});var i=n(641),a=n(33);const o={class:"weather"},r={key:1},s=["src","alt","width","height"],h={key:2,class:"temperature"},l=["textContent"];function c(t,e,n,c,u,d){const p=(0,i.g2)("Loading"),g=(0,i.g2)("skycons");return(0,i.uX)(),(0,i.CE)("div",o,[t.loading?((0,i.uX)(),(0,i.Wv)(p,{key:0})):((0,i.uX)(),(0,i.CE)("h1",r,[d._showIcon&&t.weatherIcon&&"weather.darksky"===t.weatherPlugin?((0,i.uX)(),(0,i.Wv)(g,{key:0,condition:t.weatherIcon,paused:!n.animate,size:n.iconSize,color:n.iconColor},null,8,["condition","paused","size","color"])):d._showIcon&&t.weatherIcon&&"weather.openweathermap"===t.weatherPlugin?((0,i.uX)(),(0,i.CE)("img",{key:1,src:`/icons/openweathermap/${n.iconColor||"dark"}/${t.weatherIcon}.png`,alt:t.weather?.summary,width:1.5*n.iconSize,height:1.5*n.iconSize,class:"owm-icon"},null,8,s)):(0,i.Q3)("",!0),d._showTemperature&&t.weather?((0,i.uX)(),(0,i.CE)("span",h,(0,a.v_)(Math.round(parseFloat(t.weather.temperature))+"Â°"),1)):(0,i.Q3)("",!0)])),d._showSummary&&t.weather&&t.weather.summary?((0,i.uX)(),(0,i.CE)("div",{key:2,class:"summary",textContent:(0,a.v_)(t.weather.summary)},null,8,l)):(0,i.Q3)("",!0)])}var u=n(2002);const d=["width","height","data-condition"];function p(t,e,n,a,o,r){return(0,i.uX)(),(0,i.CE)("canvas",{width:t.width,height:t.height,"data-condition":t.condition},null,8,d)}let g,m;{const t=n.g.requestAnimationFrame||n.g.webkitRequestAnimationFrame||n.g.mozRequestAnimationFrame||n.g.oRequestAnimationFrame||n.g.msRequestAnimationFrame,e=n.g.cancelAnimationFrame||n.g.webkitCancelAnimationFrame||n.g.mozCancelAnimationFrame||n.g.oCancelAnimationFrame||n.g.msCancelAnimationFrame;t&&e?(g=function(e){var n={value:null};function i(){n.value=t(i),e()}return i(),n},m=function(t){e(t.value)}):(g=setInterval,m=clearInterval)}let w=500,f=.08,v=2*Math.PI,y=2/Math.sqrt(2);function C(t,e,n,i){t.beginPath(),t.arc(e,n,i,0,v,!1),t.fill()}function M(t,e,n,i,a){t.beginPath(),t.moveTo(e,n),t.lineTo(i,a),t.stroke()}function k(t,e,n,i,a,o,r,s){var h=Math.cos(e*v),l=Math.sin(e*v);s-=r,C(t,n-l*a,i+h*o+.5*s,r+(1-.5*h)*s)}function b(t,e,n,i,a,o,r,s){var h;for(h=5;h--;)k(t,e+h/5,n,i,a,o,r,s)}function I(t,e,n,i,a,o,r){e/=3e4;var s=.21*a,h=.12*a,l=.24*a,c=.28*a;t.fillStyle=r,b(t,e,n,i,s,h,l,c),t.globalCompositeOperation="destination-out",b(t,e,n,i,s,h,l-o,c-o),t.globalCompositeOperation="source-over"}function S(t,e,n,i,a,o,r){e/=12e4;var s,h,l,c,u=.25*a-.5*o,d=.32*a+.5*o,p=.5*a-.5*o;for(t.strokeStyle=r,t.lineWidth=o,t.lineCap="round",t.lineJoin="round",t.beginPath(),t.arc(n,i,u,0,v,!1),t.stroke(),s=8;s--;)h=(e+s/8)*v,l=Math.cos(h),c=Math.sin(h),M(t,n+l*d,i+c*d,n+l*p,i+c*p)}function P(t,e,n,i,a,o,r){e/=15e3;var s=.29*a-.5*o,h=.05*a,l=Math.cos(e*v),c=l*v/-16;t.strokeStyle=r,t.lineWidth=o,t.lineCap="round",t.lineJoin="round",n+=l*h,t.beginPath(),t.arc(n,i,s,c+v/8,c+7*v/8,!1),t.arc(n+Math.cos(c)*s*y,i+Math.sin(c)*s*y,s,c+5*v/8,c+3*v/8,!0),t.closePath(),t.stroke()}function _(t,e,n,i,a,o,r){e/=1350;var s,h,l,c,u=.16*a,d=11*v/12,p=7*v/12;for(t.fillStyle=r,s=4;s--;)h=(e+s/4)%1,l=n+(s-1.5)/1.5*(1===s||2===s?-1:1)*u,c=i+h*h*a,t.beginPath(),t.moveTo(l,c-1.5*o),t.arc(l,c,.75*o,d,p,!1),t.fill()}function A(t,e,n,i,a,o,r){e/=750;var s,h,l,c,u=.1875*a;for(t.strokeStyle=r,t.lineWidth=.5*o,t.lineCap="round",t.lineJoin="round",s=4;s--;)h=(e+s/4)%1,l=Math.floor(n+(s-1.5)/1.5*(1===s||2===s?-1:1)*u)+.5,c=i+h*a,M(t,l,c-1.5*o,l,c+1.5*o)}function T(t,e,n,i,a,o,r){e/=3e3;var s,h,l,c,u=.16*a,d=.75*o,p=e*v*.7,g=Math.cos(p)*d,m=Math.sin(p)*d,w=p+v/3,f=Math.cos(w)*d,y=Math.sin(w)*d,C=p+2*v/3,k=Math.cos(C)*d,b=Math.sin(C)*d;for(t.strokeStyle=r,t.lineWidth=.5*o,t.lineCap="round",t.lineJoin="round",s=4;s--;)h=(e+s/4)%1,l=n+Math.sin((h+s/4)*v)*u,c=i+h*a,M(t,l-g,c-m,l+g,c+m),M(t,l-f,c-y,l+f,c+y),M(t,l-k,c-b,l+k,c+b)}function W(t,e,n,i,a,o,r){e/=3e4;var s=.21*a,h=.06*a,l=.21*a,c=.28*a;t.fillStyle=r,b(t,e,n,i,s,h,l,c),t.globalCompositeOperation="destination-out",b(t,e,n,i,s,h,l-o,c-o),t.globalCompositeOperation="source-over"}var F=[[-.75,-.18,-.7219,-.1527,-.6971,-.1225,-.6739,-.091,-.6516,-.0588,-.6298,-.0262,-.6083,.0065,-.5868,.0396,-.5643,.0731,-.5372,.1041,-.5033,.1259,-.4662,.1406,-.4275,.1493,-.3881,.153,-.3487,.1526,-.3095,.1488,-.2708,.1421,-.2319,.1342,-.1943,.1217,-.16,.1025,-.129,.0785,-.1012,.0509,-.0764,.0206,-.0547,-.012,-.0378,-.0472,-.0324,-.0857,-.0389,-.1241,-.0546,-.1599,-.0814,-.1876,-.1193,-.1964,-.1582,-.1935,-.1931,-.1769,-.2157,-.1453,-.229,-.1085,-.2327,-.0697,-.224,-.0317,-.2064,.0033,-.1853,.0362,-.1613,.0672,-.135,.0961,-.1051,.1213,-.0706,.1397,-.0332,.1512,.0053,.158,.0442,.1624,.0833,.1636,.1224,.1615,.1613,.1565,.1999,.15,.2378,.1402,.2749,.1279,.3118,.1147,.3487,.1015,.3858,.0892,.4236,.0787,.4621,.0715,.5012,.0702,.5398,.0766,.5768,.089,.6123,.1055,.6466,.1244,.6805,.144,.7147,.163,.75,.18],[-.75,0,-.7033,.0195,-.6569,.0399,-.6104,.06,-.5634,.0789,-.5155,.0954,-.4667,.1089,-.4174,.1206,-.3676,.1299,-.3174,.1365,-.2669,.1398,-.2162,.1391,-.1658,.1347,-.1157,.1271,-.0661,.1169,-.017,.1046,.0316,.0903,.0791,.0728,.1259,.0534,.1723,.0331,.2188,.0129,.2656,-.0064,.3122,-.0263,.3586,-.0466,.4052,-.0665,.4525,-.0847,.5007,-.1002,.5497,-.113,.5991,-.124,.6491,-.1325,.6994,-.138,.75,-.14]],q=[{start:.36,end:.11},{start:.56,end:.16}];function z(t,e,n,i,a,o,r){var s=a/8,h=s/3,l=2*h,c=e%1*v,u=Math.cos(c),d=Math.sin(c);t.fillStyle=r,t.strokeStyle=r,t.lineWidth=o,t.lineCap="round",t.lineJoin="round",t.beginPath(),t.arc(n,i,s,c,c+Math.PI,!1),t.arc(n-h*u,i-h*d,l,c+Math.PI,c,!1),t.arc(n+l*u,i+l*d,h,c+Math.PI,c,!0),t.globalCompositeOperation="destination-out",t.fill(),t.globalCompositeOperation="source-over",t.stroke()}function E(t,e,n,i,a,o,r,s,h){e/=2500;var l,c,u,d,p=F[r],g=(e+r-q[r].start)%s,m=(e+r-q[r].end)%s,w=(e+r)%s;if(t.strokeStyle=h,t.lineWidth=o,t.lineCap="round",t.lineJoin="round",g<1){if(t.beginPath(),g*=p.length/2-1,l=Math.floor(g),g-=l,l*=2,l+=2,t.moveTo(n+(p[l-2]*(1-g)+p[l]*g)*a,i+(p[l-1]*(1-g)+p[l+1]*g)*a),m<1){for(m*=p.length/2-1,c=Math.floor(m),m-=c,c*=2,c+=2,d=l;d!==c;d+=2)t.lineTo(n+p[d]*a,i+p[d+1]*a);t.lineTo(n+(p[c-2]*(1-m)+p[c]*m)*a,i+(p[c-1]*(1-m)+p[c+1]*m)*a)}else for(d=l;d!==p.length;d+=2)t.lineTo(n+p[d]*a,i+p[d+1]*a);t.stroke()}else if(m<1){for(t.beginPath(),m*=p.length/2-1,c=Math.floor(m),m-=c,c*=2,c+=2,t.moveTo(n+p[0]*a,i+p[1]*a),d=2;d!==c;d+=2)t.lineTo(n+p[d]*a,i+p[d+1]*a);t.lineTo(n+(p[c-2]*(1-m)+p[c]*m)*a,i+(p[c-1]*(1-m)+p[c+1]*m)*a),t.stroke()}w<1&&(w*=p.length/2-1,u=Math.floor(w),w-=u,u*=2,u+=2,z(t,e,n+(p[u-2]*(1-w)+p[u]*w)*a,i+(p[u-1]*(1-w)+p[u+1]*w)*a,a,o,h))}class N{constructor(t){this.list=[],this.interval=null,this.color=t&&t.color?t.color:"black",this.resizeClear=!(!t||!t.resizeClear),this.speed=Number(t&&t.speed)||1,this.speed<0&&(this.speed=1)}static CLEAR_DAY(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);S(t,e,.5*i,.5*a,o,o*f,n)}static CLEAR_NIGHT(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);P(t,e,.5*i,.5*a,o,o*f,n)}static PARTLY_CLOUDY_DAY(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);S(t,e,.625*i,.375*a,.75*o,o*f,n),I(t,e,.375*i,.625*a,.75*o,o*f,n)}static PARTLY_CLOUDY_NIGHT(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);P(t,e,.667*i,.375*a,.75*o,o*f,n),I(t,e,.375*i,.625*a,.75*o,o*f,n)}static CLOUDY(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);I(t,e,.5*i,.5*a,o,o*f,n)}static RAIN(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);_(t,e,.5*i,.37*a,.9*o,o*f,n),I(t,e,.5*i,.37*a,.9*o,o*f,n)}static SLEET(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);A(t,e,.5*i,.37*a,.9*o,o*f,n),I(t,e,.5*i,.37*a,.9*o,o*f,n)}static SNOW(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);T(t,e,.5*i,.37*a,.9*o,o*f,n),I(t,e,.5*i,.37*a,.9*o,o*f,n)}static WIND(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a);E(t,e,.5*i,.5*a,o,o*f,0,2,n),E(t,e,.5*i,.5*a,o,o*f,1,2,n)}static FOG(t,e,n){const i=t.canvas.width,a=t.canvas.height,o=Math.min(i,a),r=o*f;W(t,e,.5*i,.32*a,.75*o,r,n),e/=5e3;const s=Math.cos(e*v)*o*.02,h=Math.cos((e+.25)*v)*o*.02,l=Math.cos((e+.5)*v)*o*.02,c=Math.cos((e+.75)*v)*o*.02,u=.936*a,d=Math.floor(u-.5*r)+.5,p=Math.floor(u-2.5*r)+.5;t.strokeStyle=n,t.lineWidth=r,t.lineCap="round",t.lineJoin="round",M(t,s+.2*i+.5*r,d,h+.8*i-.5*r,d),M(t,l+.2*i+.5*r,p,c+.8*i-.5*r,p)}#t=t=>("string"===typeof t&&(t=N[t.toUpperCase().replace(/-/g,"_")]||null),t);add(t,e){if("string"===typeof t&&(t=document.getElementById(t)),null===t||void 0===t)return;if(e=this.#t(e),"function"!==typeof e)return;const n={element:t,context:t.getContext("2d"),drawing:e};this.list.push(n),this.draw(n,w)}set(t,e){"string"===typeof t&&(t=document.getElementById(t));for(let n=this.list.length;n--;)if(this.list[n].element===t)return this.list[n].drawing=this.#t(e),void this.draw(this.list[n],w);this.add(t,e)}remove(t){"string"===typeof t&&(t=document.getElementById(t));for(let e=this.list.length;e--;)if(this.list[e].element===t)return void this.list.splice(e,1)}draw(t,e){const n=t.context.canvas;this.resizeClear?n.width=n.width:t.context.clearRect(0,0,n.width,n.height),t.drawing(t.context,e,this.color)}play(){this.pause(),this.interval=g((()=>{const t=Date.now()*this.speed;for(let e=this.list.length;e--;)this.draw(this.list[e],t)}),1e3/60)}pause(){this.interval&&(m(this.interval),this.interval=null)}}function O(t){const e={};return e.paused=!t.interval,e.play=()=>{t.play(),e.paused=!1},e.pause=()=>{t.pause(),e.paused=!0},e}var D=(0,i.pM)({props:{condition:{type:String,required:!0},size:{type:[Number,String],default:64},color:{type:String,default:"black"},paused:{type:Boolean,default:!1},speed:{type:[Number,String],default:1}},computed:{width(){return""+this.size},height(){return""+this.size},icon(){return this.condition.toUpperCase().replace(/[\s.-]/g,"_")}},mounted(){const t=new N({color:this.color,speed:this.speed});t.set(this.$el,N[this.icon]),this.paused||t.play(),this.$emit("load",O(t))}}),L=n(6262);const R=(0,L.A)(D,[["render",p]]);var x=R,X=x,$=n(9828),B={name:"Weather",mixins:[u.A],components:{Loading:$.A,Skycons:X},props:{animate:{required:!1,default:!0},iconSize:{type:Number,required:!1,default:50},iconColor:{type:String,required:!1},showIcon:{required:!1,default:!0},showSummary:{required:!1,default:!0},showTemperature:{required:!1,default:!0},refreshSeconds:{type:Number,required:!1,default:900}},data:function(){return{weather:void 0,weatherIcon:void 0,weatherPlugin:void 0,loading:!1,weatherPlugins:["weather.openweathermap","weather.darksky"]}},computed:{_showSummary(){return this.parseBoolean(this.showSummary)},_showIcon(){return this.parseBoolean(this.showIcon)},_showTemperature(){return this.parseBoolean(this.showTemperature)}},methods:{async refresh(){this.loading=!0;try{const t=await this.request(`${this.weatherPlugin}.get_current_weather`);this.onWeatherChange(t)}finally{this.loading=!1}},onWeatherChange(t){this.weather&&t&&this.weatherPlugins.includes(t.plugin_name)||(this.weather={}),this.weather={...this.weather,...t},this.weatherIcon=this.weather.icon},initWeatherPlugin(){for(const t of this.weatherPlugins)if(this.$root.config[t]){this.weatherPlugin=t,console.debug(`Initialized weather UI - plugin: ${t}`);break}this.weatherPlugin||console.warn(`No weather plugins configured. Compatible plugins: ${this.weatherPlugins}`)}},mounted:function(){this.initWeatherPlugin(),this.refresh(),this.subscribe(this.onWeatherChange,null,"platypush.message.event.weather.NewWeatherConditionEvent"),setInterval(this.refresh,parseInt((1e3*this.refreshSeconds).toFixed(0)))}};const J=(0,L.A)(B,[["render",c],["__scopeId","data-v-e45afcf6"]]);var Y=J}}]);
//# sourceMappingURL=5188.0e23418f.js.map
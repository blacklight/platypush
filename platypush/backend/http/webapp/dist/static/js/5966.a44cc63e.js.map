{"version":3,"file":"static/js/5966.a44cc63e.js","mappings":"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","sources":["webpack://platypush/./src/components/panels/Media/Providers/Jellyfin/views/Media/Index.vue","webpack://platypush/./src/components/panels/Media/Providers/Jellyfin/views/Media/Index.vue?0661"],"sourcesContent":["<template>\n  <div class=\"videos index\">\n    <Loading v-if=\"isLoading\" />\n\n    <div class=\"wrapper music-wrapper\" v-else-if=\"collection?.collection_type === 'music'\">\n      <Music :collection=\"collection\"\n             :filter=\"filter\"\n             :loading=\"isLoading\"\n             :path=\"path\"\n             @play=\"$emit('play', $event)\"\n             @play-with-opts=\"$emit('play-with-opts', $event)\"\n             @select=\"selectedResult = $event; $emit('select', $event)\"\n             @select-collection=\"selectCollection\"\n             @view=\"$emit('view', $event)\" />\n    </div>\n\n    <NoItems :with-shadow=\"false\"\n             v-else-if=\"!items?.length\">\n      No videos found.\n    </NoItems>\n\n    <div class=\"wrapper items-wrapper\" v-else>\n      <Collections :collection=\"collection\"\n                   :filter=\"filter\"\n                   :items=\"collections\"\n                   :loading=\"isLoading\"\n                   :parent-id=\"collection?.id\"\n                   @select=\"selectCollection\"\n                   v-if=\"collections.length > 0\" />\n\n      <Results :results=\"mediaItems\"\n               :sources=\"{'jellyfin': true}\"\n               :filter=\"filter\"\n               :selected-result=\"selectedResult\"\n               @add-to-playlist=\"$emit('add-to-playlist', $event)\"\n               @download=\"$emit('download', $event)\"\n               @play=\"$emit('play', $event)\"\n               @play-with-opts=\"$emit('play-with-opts', $event)\"\n               @remove-from-playlist=\"$emit('remove-from-playlist', $event)\"\n               @select=\"selectItem\"\n               @view=\"$emit('view', $event)\"\n               v-if=\"mediaItems.length > 0\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Collections from \"@/components/panels/Media/Providers/Jellyfin/Collections\";\nimport Loading from \"@/components/Loading\";\nimport Mixin from \"@/components/panels/Media/Providers/Jellyfin/Mixin\";\nimport Music from \"../Music/Index\";\nimport NoItems from \"@/components/elements/NoItems\";\nimport Results from \"@/components/panels/Media/Results\";\n\nexport default {\n  mixins: [Mixin],\n  emits: ['select', 'select-collection'],\n  components: {\n    Collections,\n    Loading,\n    Music,\n    NoItems,\n    Results,\n  },\n\n  computed: {\n    collections() {\n      return this.sortedItems?.filter((item) => item.item_type === 'collection') ?? []\n    },\n\n    mediaItems() {\n      const items = this.sortedItems?.filter((item) => item.item_type !== 'collection') ?? []\n\n      if (this.collection && (!this.collection.collection_type || this.collection.collection_type === 'books')) {\n        return items.sort((a, b) => {\n          if (a.created_at && b.created_at)\n            return (new Date(a.created_at)) < (new Date(b.created_at))\n\n          if (a.created_at)\n            return -1\n\n          if (b.created_at)\n            return 1\n\n          let names = [a.name || a.title || '', b.name || b.title || '']\n          return names[0].localeCompare(names[1])\n        })\n      }\n\n      return items\n    },\n  },\n\n  methods: {\n    selectCollection(collection) {\n      this.$emit('select-collection', {\n        type: 'homevideos',\n        ...collection,\n      })\n    },\n\n    selectItem(index) {\n      const item = this.items[index]\n      if (item.item_type === 'book' && item.embed_url) {\n        window.open(item.embed_url, '_blank')\n        return\n      }\n\n      this.selectedResult = index\n    },\n\n    async init() {\n      const args = this.getUrlArgs()\n      let collection = args?.collection\n      if (!collection)\n        return\n\n      this.loading_ = true\n      try {\n        collection = await this.request('media.jellyfin.info', {\n          item_id: collection,\n        })\n\n        if (collection)\n          this.selectCollection(collection)\n      } finally {\n        this.loading_ = false\n      }\n    },\n\n    async refresh() {\n      // Don't fetch items if we're in the music view -\n      // we'll fetch them in the Music component\n      if (this.collection?.collection_type === 'music')\n        return\n\n      this.loading_ = true\n      try {\n        if (this.collection?.collection_type === 'tvshows') {\n          this.items = (\n            await this.request('media.jellyfin.get_collections', {\n              parent_id: this.collection.id,\n            })\n          ).map((collection) => ({\n            ...collection,\n            item_type: 'collection',\n          }))\n        } else {\n          this.items = this.collection?.id ?\n            (\n              await this.request('media.jellyfin.get_items', {\n                parent_id: this.collection.id,\n                limit: 25000,\n              })\n            ) : (await this.request('media.jellyfin.get_collections')).map((collection) => ({\n              ...collection,\n              item_type: 'collection',\n            }))\n        }\n      } finally {\n        this.loading_ = false\n      }\n    },\n  },\n\n  async mounted() {\n    this.init()\n    await this.refresh()\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/components/panels/Media/Providers/Jellyfin/common.scss\";\n\n.index {\n  position: relative;\n\n  :deep(.items-wrapper) {\n    height: 100%;\n    position: relative;\n    overflow: auto;\n\n    .index {\n      height: fit-content;\n    }\n\n    .items {\n      overflow: hidden;\n    }\n  }\n\n  .music-wrapper {\n    height: 100%;\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=46a825e6&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=46a825e6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-46a825e6\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_ctx","isLoading","_createBlock","_component_Loading","key","collection","collection_type","_hoisted_2","_createVNode","_component_Music","filter","loading","path","onPlay","_cache","$event","$emit","onPlayWithOpts","onSelect","selectedResult","onSelectCollection","$options","selectCollection","onView","items","length","_hoisted_3","collections","_component_Collections","id","mediaItems","_component_Results","results","sources","onAddToPlaylist","onDownload","onRemoveFromPlaylist","selectItem","_component_NoItems","mixins","Mixin","emits","components","Collections","Loading","Music","NoItems","Results","computed","this","sortedItems","item","item_type","sort","a","b","created_at","Date","names","name","title","localeCompare","methods","type","index","embed_url","window","open","init","args","getUrlArgs","loading_","request","item_id","refresh","parent_id","map","limit","mounted","__exports__","render"],"sourceRoot":""}
"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[7329],{2423:function(e,t,n){n.r(t),n.d(t,{default:function(){return Xn}});var a=n(641),i=n(33),s=n(3751);const o=e=>((0,a.Qi)("data-v-74ca2010"),e=e(),(0,a.jt)(),e),r={class:"actions-list"},l={key:0,class:"indent-spacers"},d=o((()=>(0,a.Lk)("div",{class:"left side"},null,-1))),c=o((()=>(0,a.Lk)("div",{class:"right side"},null,-1))),u=[d,c],p={key:0,class:"row item action add-action-container"},h={key:1,class:"add-buttons-expander"},g={key:2,class:"extra-add-buttons fade-in"},v={key:0,class:"row item action add-return-container"},m={key:1,class:"row item action add-if-container"},y={key:2,class:"row item action add-else-container"},f={key:3,class:"row item action add-for-container"},k={key:4,class:"row item action add-while-container"},b={key:5,class:"row item action add-break-container"},C={key:6,class:"row item action add-continue-container"},D={key:7,class:"row item action add-set-container"};function w(e,t,n,o,d,c){const w=(0,a.g2)("ConditionBlock"),E=(0,a.g2)("LoopBlock"),$=(0,a.g2)("SetVariablesTile"),L=(0,a.g2)("BreakTile"),x=(0,a.g2)("ContinueTile"),B=(0,a.g2)("ReturnTile"),T=(0,a.g2)("ActionsListItem"),A=(0,a.g2)("ActionTile"),O=(0,a.g2)("ListItem"),I=(0,a.g2)("AddTile");return(0,a.uX)(),(0,a.CE)("div",r,[n.indent>0?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",{class:"indent-spacer",onClick:t[0]||(t[0]=(...e)=>c.onCollapse&&c.onCollapse(...e))},u)])):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,i.C4)(["actions",{dragging:c.isDragging}])},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.visibleActions,((i,s)=>((0,a.uX)(),(0,a.CE)("div",{class:"row item action",key:s},[c.conditions[s]?((0,a.uX)(),(0,a.Wv)(w,(0,a.v6)({key:0,ref_for:!0},c.componentsData[s].props,(0,a.Tb)(c.componentsData[s].on),{collapsed:c.collapsedBlocks[s],dragging:c.isDragging,onAddElse:c.addElse}),null,16,["collapsed","dragging","onAddElse"])):c.elses[s]?((0,a.uX)(),(0,a.Wv)(w,(0,a.v6)({key:1,ref_for:!0},c.componentsData[s].props,(0,a.Tb)(c.componentsData[s].on),{collapsed:c.collapsedBlocks[s],dragging:c.isDragging,"is-else":!0}),null,16,["collapsed","dragging"])):c.loops[s]?((0,a.uX)(),(0,a.Wv)(E,(0,a.v6)({key:2,ref_for:!0},c.componentsData[s].props,(0,a.Tb)(c.componentsData[s].on),{collapsed:c.collapsedBlocks[s],dragging:c.isDragging}),null,16,["collapsed","dragging"])):c.sets[s]?((0,a.uX)(),(0,a.Wv)($,(0,a.v6)({key:3,ref_for:!0},c.componentsData[s].props,(0,a.Tb)(c.componentsData[s].on),{collapsed:c.collapsedBlocks[s],dragging:c.isDragging}),null,16,["collapsed","dragging"])):e.isBreak(i)?((0,a.uX)(),(0,a.Wv)(L,{key:4,active:c.isDragging,readOnly:n.readOnly,spacerTop:c.componentsData[s].props.spacerTop,onDelete:e=>c.deleteAction(s)},null,8,["active","readOnly","spacerTop","onDelete"])):e.isContinue(i)?((0,a.uX)(),(0,a.Wv)(x,{key:5,active:c.isDragging,readOnly:n.readOnly,spacerTop:c.componentsData[s].props.spacerTop,onDelete:e=>c.deleteAction(s)},null,8,["active","readOnly","spacerTop","onDelete"])):e.isReturn(i)?((0,a.uX)(),(0,a.Wv)(B,(0,a.v6)({key:6,ref_for:!0},c.componentsData[s].props,{value:c.returnValue,onChange:t[1]||(t[1]=e=>c.editReturn(e)),onDelete:e=>c.deleteAction(s)}),null,16,["value","onDelete"])):e.isAction(i)&&!n.collapsed?((0,a.uX)(),(0,a.Wv)(T,(0,a.v6)({key:7,ref_for:!0},c.componentsData[s].props,(0,a.Tb)(c.componentsData[s].on)),null,16)):(0,a.Q3)("",!0)])))),128)),c.visibleAddButtons.action?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.bF)(O,{active:c.isDragging,readOnly:!1,spacerBottom:!1,spacerTop:!d.newValue.length,value:d.newAction,onDrop:t[2]||(t[2]=e=>c.onDrop(0,e))},{default:(0,a.k6)((()=>[(0,a.bF)(A,{value:d.newAction,context:c.contexts[Object.keys(c.contexts).length-1],draggable:!1,onInput:c.addAction},null,8,["value","context","onInput"])])),_:1},8,["active","spacerTop","value"])])):(0,a.Q3)("",!0),c.showAddButtonsExpander?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("button",{onClick:t[3]||(t[3]=(0,s.D$)((e=>d.collapseAddButtons=!d.collapseAddButtons),["stop","prevent"]))},[(0,a.Lk)("i",{class:(0,i.C4)(["fas",d.collapseAddButtons?"fa-angle-down":"fa-angle-up"])},null,2)])])):(0,a.Q3)("",!0),c.showAddButtons?((0,a.uX)(),(0,a.CE)("div",g,[c.visibleAddButtons.return?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.bF)(I,{icon:"fas fa-angle-right",title:"Add Return",onClick:c.addReturn},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.condition?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(I,{icon:"fas fa-question",title:"Add Condition",onClick:c.addCondition},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.else?((0,a.uX)(),(0,a.CE)("div",y,[(0,a.bF)(I,{icon:"fas fa-question",title:"Add Else",onClick:t[4]||(t[4]=t=>e.$emit("add-else"))})])):(0,a.Q3)("",!0),c.visibleAddButtons.for?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(I,{icon:"fas fa-arrow-rotate-left",title:"Add For Loop",onClick:c.addForLoop},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.while?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(I,{icon:"fas fa-arrow-rotate-left",title:"Add While Loop",onClick:c.addWhileLoop},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.break?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.bF)(I,{icon:"fas fa-hand",title:"Add Break",onClick:c.addBreak},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.continue?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(I,{icon:"fas fa-rotate",title:"Add Continue",onClick:c.addContinue},null,8,["onClick"])])):(0,a.Q3)("",!0),c.visibleAddButtons.set?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.bF)(I,{icon:"fas fa-square-root-variable",title:"Set Variables",onClick:c.addSet},null,8,["onClick"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)],2)])}n(4114);function E(e,t,n,i,o,r){const l=(0,a.g2)("ActionTile"),d=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(d,(0,a.v6)({class:"action",active:n.active,dragging:o.dragging,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop,value:n.value},(0,a.Tb)(r.componentsData.on)),{default:(0,a.k6)((()=>[(0,a.bF)(l,(0,a.v6)({value:n.value,context:n.context,draggable:!n.readOnly,"read-only":n.readOnly,"with-delete":!n.readOnly},(0,a.Tb)(r.componentsData.on),{onContextmenu:t[0]||(t[0]=t=>e.$emit("contextmenu",t)),onDrag:(0,s.D$)(r.onDragStart,["stop"]),onDelete:t[1]||(t[1]=t=>e.$emit("delete",t))}),null,16,["value","context","draggable","read-only","with-delete","onDrag"])])),_:1},16,["active","dragging","spacer-bottom","spacer-top","value"])}const $=e=>((0,a.Qi)("data-v-49487886"),e=e(),(0,a.jt)(),e),L={class:"action-tile-container"},x=$((()=>(0,a.Lk)("i",{class:"icon fas fa-xmark"},null,-1))),B=[x],T={key:1,class:"action-name"},A={class:"icon"},O={class:"name"},I={key:2,class:"new-action"},S=$((()=>(0,a.Lk)("i",{class:"icon fas fa-plus"},null,-1))),V={key:3,class:"action-args"},_={class:"arg-name"},X={class:"arg-value"},W={class:"action-editor-container"};function F(e,t,n,o,r,l){const d=(0,a.g2)("ExtensionIcon"),c=(0,a.g2)("Draggable"),u=(0,a.g2)("Droppable"),p=(0,a.g2)("ActionEditor"),h=(0,a.g2)("Modal");return(0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",{class:(0,i.C4)(["action-tile",{new:l.isNew}]),ref:"tile",onClick:t[1]||(t[1]=(...t)=>e.$refs.actionEditor.show&&e.$refs.actionEditor.show(...t))},[n.withDelete&&!n.readOnly?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"action-delete",title:"Remove",onClick:t[0]||(t[0]=(0,s.D$)((t=>e.$emit("delete")),["stop"]))},B)):(0,a.Q3)("",!0),l.name?.length?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("span",A,[(0,a.bF)(d,{name:l.name.split(".")[0],size:"1.5em"},null,8,["name"])]),(0,a.Lk)("span",O,(0,i.v_)(l.name),1)])):((0,a.uX)(),(0,a.CE)("div",I,[S,(0,a.eW)("  Add Action ")])),Object.keys(n.value.args||{})?.length?((0,a.uX)(),(0,a.CE)("div",V,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.value.args,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"arg",key:t},[(0,a.Lk)("div",_,(0,i.v_)(t),1),(0,a.Lk)("div",X,(0,i.v_)(e),1)])))),128))])):(0,a.Q3)("",!0)],2),n.draggable?((0,a.uX)(),(0,a.Wv)(c,{key:0,element:r.tile,disabled:n.readOnly,value:n.value,onDrag:t[2]||(t[2]=t=>e.$emit("drag",t)),onDragend:t[3]||(t[3]=t=>e.$emit("dragend",t)),onDrop:t[4]||(t[4]=t=>e.$emit("drop",t))},null,8,["element","disabled","value"])):(0,a.Q3)("",!0),n.draggable?((0,a.uX)(),(0,a.Wv)(u,{key:1,element:r.tile,disabled:n.readOnly,onDragenter:t[5]||(t[5]=t=>e.$emit("dragenter",t)),onDragleave:t[6]||(t[6]=t=>e.$emit("dragleave",t)),onDragover:t[7]||(t[7]=t=>e.$emit("dragover",t)),onDrop:t[8]||(t[8]=t=>e.$emit("drop",t))},null,8,["element","disabled"])):(0,a.Q3)("",!0),(0,a.Lk)("div",W,[(0,a.bF)(h,{ref:"actionEditor",title:"Edit Action"},{default:(0,a.k6)((()=>[this.$refs.actionEditor?.$data?.isVisible?((0,a.uX)(),(0,a.Wv)(p,{key:0,value:n.value,context:n.context,"with-save":!n.readOnly,onInput:l.onInput},null,8,["value","context","with-save","onInput"])):(0,a.Q3)("",!0)])),_:1},512)])])}var Q=n(5928),j=n(8692),N=n(3118),H=n(2573),q=n(875),M=n(9513),R={mixins:[q.A],emits:["delete","drag","dragenter","dragleave","dragover","drop","input"],components:{ActionEditor:Q.A,Draggable:j.A,Droppable:N.A,ExtensionIcon:H.A,Modal:M.A},props:{context:{type:Object,default:()=>({})},draggable:{type:Boolean,default:!0},value:{type:Object,default:()=>({name:void 0,args:{},extraArgs:[],supportsExtraArgs:!0})},withDelete:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1}},data(){return{tile:null}},computed:{isNew(){return!this.readOnly&&!this.name?.length},name(){return this.value.name||this.value.action}},methods:{onInput(e){e&&!this.readOnly&&(this.$emit("input",{...this.value,name:e.action,args:e.args,extraArgs:e.extraArgs,supportsExtraArgs:e.supportsExtraArgs}),this.$refs.actionEditor.close())}},mounted(){this.tile=this.$refs.tile}},P=n(6262);const U=(0,P.A)(R,[["render",F],["__scopeId","data-v-49487886"]]);var z=U;const K=e=>((0,a.Qi)("data-v-7d0cf109"),e=e(),(0,a.jt)(),e),Y=K((()=>(0,a.Lk)("div",{class:"droppable-wrapper"},[(0,a.Lk)("div",{class:"droppable-container"},[(0,a.Lk)("div",{class:"droppable-frame"},[(0,a.Lk)("div",{class:"droppable"})])])],-1))),J=[Y],G={key:0,class:"spacer top"},Z={key:1,class:"spacer bottom"},ee=K((()=>(0,a.Lk)("div",{class:"droppable-wrapper"},[(0,a.Lk)("div",{class:"droppable-container"},[(0,a.Lk)("div",{class:"droppable-frame"},[(0,a.Lk)("div",{class:"droppable"})])])],-1))),te=[ee];function ne(e,t,n,s,o,r){const l=(0,a.g2)("Droppable");return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["row item list-item",r.itemClass])},[(0,a.Lk)("div",{class:(0,i.C4)(["spacer-wrapper",{hidden:!n.spacerTop}])},[(0,a.Lk)("div",{class:(0,i.C4)(["spacer top",{active:n.active}]),ref:"dropTargetTop"},J,2),(0,a.bF)(l,(0,a.v6)({element:e.$refs.dropTargetTop,disabled:n.readOnly},(0,a.Tb)(r.droppableData.top.on)),null,16,["element","disabled"])],2),n.dragging?((0,a.uX)(),(0,a.CE)("div",G)):(0,a.Q3)("",!0),(0,a.RG)(e.$slots,"default",{},void 0,!0),n.dragging?((0,a.uX)(),(0,a.CE)("div",Z)):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,i.C4)(["spacer-wrapper",{hidden:!n.spacerBottom}])},[(0,a.Lk)("div",{class:(0,i.C4)(["spacer bottom",{active:n.active}]),ref:"dropTargetBottom"},te,2),(0,a.bF)(l,(0,a.v6)({element:e.$refs.dropTargetBottom,disabled:n.readOnly},(0,a.Tb)(r.droppableData.bottom.on)),null,16,["element","disabled"])],2)],2)}var ae=n(2002),ie={mixins:[ae.A],emits:["contextmenu","dragend","dragenter","dragleave","dragover","drop"],components:{Droppable:N.A},props:{active:{type:Boolean,default:!1},className:{type:[String,Object],default:""},dragging:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!1},spacerTop:{type:Boolean,default:!0},value:{type:[String,Number,Boolean,Object,Array],required:!0}},computed:{droppableData(){return["bottom","top"].reduce(((e,t)=>(e[t]={on:{dragend:this.onDragEnd,dragenter:this.onDragEnter,dragleave:this.onDragLeave,dragover:this.onDragOver,drop:this.onDrop}},e)),{})},itemClass(){return{dragging:this.dragging,...this.className?.trim?{[this.className]:!0}:this.className||{}}}},methods:{onDragEnd(e){this.$emit("dragend",e)},onDragEnter(e){this.$emit("dragenter",e)},onDragLeave(e){this.$emit("dragleave",e)},onDragOver(e){this.$emit("dragover",e)},onDrop(e){this.$emit("drop",e)}}};const se=(0,P.A)(ie,[["render",ne],["__scopeId","data-v-7d0cf109"]]);var oe=se,re={mixins:[ae.A],emits:["contextmenu","delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ActionTile:z,ListItem:oe},props:{active:{type:Boolean,default:!1},context:{type:Object,default:()=>({})},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!1},spacerTop:{type:Boolean,default:!0},value:{type:Object,required:!0}},data(){return{dragging:!1}},computed:{componentsData(){return{on:{dragend:this.onDragEnd,dragover:this.onDragOver,drop:this.onDrop,input:this.onInput}}}},methods:{onDragStart(e){this.readOnly||(this.dragging=!0,this.$emit("drag",e))},onDragEnd(e){e.stopPropagation(),this.dragging=!1,this.$emit("dragend",e)},onDragOver(e){e.stopPropagation(),this.$emit("dragover",e)},onDrop(e){this.readOnly||(e.stopPropagation(),this.dragging=!1,this.$emit("drop",e))},onInput(e){this.$emit("input",e)}}};const le=(0,P.A)(re,[["render",E]]);var de=le;const ce={class:"add-tile-container"},ue={class:"add-tile"},pe={class:"icon"},he={class:"name"};function ge(e,t,n,s,o,r){const l=(0,a.g2)("Tile");return(0,a.uX)(),(0,a.CE)("div",ce,[(0,a.bF)(l,{class:"add",draggable:!1,"read-only":!0,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:(0,a.k6)((()=>[(0,a.Lk)("div",ue,[(0,a.Lk)("span",pe,[(0,a.Lk)("i",{class:(0,i.C4)(n.icon)},null,2)]),(0,a.Lk)("span",he,(0,i.v_)(n.title),1)])])),_:1})])}const ve=e=>((0,a.Qi)("data-v-9354cf66"),e=e(),(0,a.jt)(),e),me=ve((()=>(0,a.Lk)("i",{class:"icon fas fa-xmark"},null,-1))),ye=[me];function fe(e,t,n,o,r,l){const d=(0,a.g2)("Draggable"),c=(0,a.g2)("Droppable");return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["tile-container",n.className])},[(0,a.Lk)("div",{class:"tile",ref:"tile",onClick:t[1]||(t[1]=t=>e.$emit("click",t))},[n.withDelete?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"delete",title:"Remove",onClick:t[0]||(t[0]=(0,s.D$)((t=>e.$emit("delete")),["stop"]))},ye)):(0,a.Q3)("",!0),(0,a.RG)(e.$slots,"default",{},void 0,!0)],512),n.draggable?((0,a.uX)(),(0,a.Wv)(d,{key:0,element:r.tile,disabled:n.readOnly,value:n.value,onDrag:t[2]||(t[2]=t=>e.$emit("drag",t)),onDragend:t[3]||(t[3]=t=>e.$emit("dragend",t)),onDrop:t[4]||(t[4]=t=>e.$emit("drop",t))},null,8,["element","disabled","value"])):(0,a.Q3)("",!0),n.readOnly?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(c,{key:1,element:r.tile,onDragenter:t[5]||(t[5]=t=>e.$emit("dragenter",t)),onDragleave:t[6]||(t[6]=t=>e.$emit("dragleave",t)),onDragover:t[7]||(t[7]=t=>e.$emit("dragover",t)),onDrop:t[8]||(t[8]=t=>e.$emit("drop",t))},null,8,["element"]))],2)}var ke={emits:["click","delete","drag","dragenter","dragleave","dragover","drop"],components:{Draggable:j.A,Droppable:N.A},props:{className:{type:[String,Object],default:""},draggable:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1},value:{type:[Object,String,Number,Boolean,Array]},withDelete:{type:Boolean,default:!1}},data(){return{tile:void 0}},mounted(){this.tile=this.$refs.tile}};const be=(0,P.A)(ke,[["render",fe],["__scopeId","data-v-9354cf66"]]);var Ce=be,De={emits:["click"],components:{Tile:Ce},props:{icon:{type:String,default:"fas fa-plus"},title:{type:String,required:!0}}};const we=(0,P.A)(De,[["render",ge],["__scopeId","data-v-2ff09bb6"]]);var Ee=we;const $e=(0,a.Lk)("div",{class:"tile-name"},[(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-hand"})]),(0,a.Lk)("span",{class:"name"},[(0,a.Lk)("span",{class:"keyword"},"break")])],-1);function Le(e,t,n,i,o,r){const l=(0,a.g2)("Tile"),d=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(d,{class:"break-tile",value:"break",active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop},{default:(0,a.k6)((()=>[(0,a.bF)(l,{value:n.value,class:"keyword",draggable:!1,"read-only":n.readOnly,"with-delete":!n.readOnly,onClick:t[0]||(t[0]=(0,s.D$)((()=>{}),["stop"])),onDelete:t[1]||(t[1]=t=>e.$emit("delete"))},{default:(0,a.k6)((()=>[$e])),_:1},8,["value","read-only","with-delete"])])),_:1},8,["active","read-only","spacer-bottom","spacer-top"])}var xe={emits:["delete"],components:{ListItem:oe,Tile:Ce},props:{value:{type:String,default:"break"},active:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0}}};const Be=(0,P.A)(xe,[["render",Le]]);var Te=Be;const Ae={class:"condition-block"};function Oe(e,t,n,i,o,r){const l=(0,a.g2)("ConditionTile"),d=(0,a.g2)("EndBlockTile"),c=(0,a.g2)("ActionsBlock");return(0,a.uX)(),(0,a.CE)("div",Ae,[(0,a.bF)(c,{value:n.value,collapsed:n.collapsed,context:e.context,dragging:r.isDragging,"has-else":n.hasElse,"is-inside-loop":n.isInsideLoop,indent:n.indent,"read-only":n.readOnly,onInput:r.onActionsChange,onAddElse:t[1]||(t[1]=t=>e.$emit("add-else")),onDrag:t[2]||(t[2]=t=>e.$emit("drag",t)),onDragend:t[3]||(t[3]=t=>e.$emit("dragend",t)),onDragenter:t[4]||(t[4]=t=>e.$emit("dragenter",t)),onDragleave:t[5]||(t[5]=t=>e.$emit("dragleave",t)),onDragover:t[6]||(t[6]=t=>e.$emit("dragover",t)),onDrop:t[7]||(t[7]=t=>e.$emit("drop",t))},{before:(0,a.k6)((()=>[r.condition&&!n.isElse?((0,a.uX)(),(0,a.Wv)(l,(0,a.v6)({key:0,value:r.condition},r.conditionTileConf.props,(0,a.Tb)(r.conditionTileConf.on),{onInput:t[0]||(t[0]=(0,s.D$)((()=>{}),["prevent","stop"])),"spacer-top":n.spacerTop,"spacer-bottom":!1}),null,16,["value","spacer-top"])):n.isElse?((0,a.uX)(),(0,a.Wv)(l,(0,a.v6)({key:1,value:"else"},r.conditionTileConf.props,(0,a.Tb)(r.conditionTileConf.on),{"is-else":!0,"spacer-top":n.spacerTop,"spacer-bottom":!1}),null,16,["spacer-top"])):(0,a.Q3)("",!0)])),after:(0,a.k6)((()=>[n.isElse||!n.hasElse?((0,a.uX)(),(0,a.Wv)(d,{key:0,value:"end if",icon:"fas fa-question",active:n.active,"spacer-bottom":n.spacerBottom||o.dragging_,onDrop:r.onDrop},null,8,["active","spacer-bottom","onDrop"])):(0,a.Q3)("",!0)])),_:1},8,["value","collapsed","context","dragging","has-else","is-inside-loop","indent","read-only","onInput"])])}const Ie=e=>((0,a.Qi)("data-v-505af250"),e=e(),(0,a.jt)(),e),Se={class:"actions-list-container",ref:"actionsListContainer"},Ve=Ie((()=>(0,a.Lk)("i",{class:"fas fa-ellipsis-h"},null,-1))),_e=[Ve];function Xe(e,t,n,s,o,r){const l=(0,a.g2)("ActionsList"),d=(0,a.g2)("Droppable");return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["actions-block",{hover:o.hover}])},[(0,a.RG)(e.$slots,"before",{},void 0,!0),(0,a.Lk)("div",Se,[r.isCollapsed?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"collapse-button",onClick:t[0]||(t[0]=e=>o.collapsed_=!o.collapsed_)},_e)):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,i.C4)(["actions-list",r.actionListClasses])},[(0,a.bF)(l,{value:n.value[r.key],context:e.context,dragging:n.dragging,"has-else":n.hasElse,indent:n.indent,"is-inside-loop":n.isInsideLoop,parent:n.value,"read-only":n.readOnly,onAddElse:t[1]||(t[1]=t=>e.$emit("add-else")),onCollapse:t[2]||(t[2]=e=>o.collapsed_=!o.collapsed_),onDrag:t[3]||(t[3]=t=>e.$emit("drag",t)),onDragend:t[4]||(t[4]=t=>{e.$emit("dragend",t),o.hover=!1}),onDragenter:t[5]||(t[5]=t=>e.$emit("dragenter",t)),onDragleave:t[6]||(t[6]=t=>{e.$emit("dragleave",t),o.hover=!1}),onDragover:t[7]||(t[7]=t=>e.$emit("dragover",t)),onDrop:t[8]||(t[8]=t=>{e.$emit("drop",t),o.hover=!1}),onInput:t[9]||(t[9]=t=>{e.$emit("input",t),o.hover=!1})},null,8,["value","context","dragging","has-else","indent","is-inside-loop","parent","read-only"])],2)],512),(0,a.RG)(e.$slots,"after",{},void 0,!0),n.readOnly?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(d,{key:0,element:e.$refs.actionsListContainer,onDragenter:r.onDragEnter,onDragleave:r.onDragLeave,onDrop:t[10]||(t[10]=e=>o.hover=!1)},null,8,["element","onDragenter","onDragleave"]))],2)}var We={name:"ActionsBlock",mixins:[q.A],emits:["add-else","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ActionsList:(0,a.$V)((()=>Promise.resolve().then(n.bind(n,2423)))),Droppable:N.A},props:{value:{type:Object,required:!0},collapsed:{type:Boolean,default:!1},dragging:{type:Boolean,default:!1},indent:{type:Number,default:0},isInsideLoop:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},hasElse:{type:Boolean,default:!1}},computed:{actionListClasses(){return{hidden:this.isCollapsed,fold:this.folding,unfold:this.unfolding}},condition(){return this.getCondition(this.key)},isCollapsed(){const e=this.hover||this.folding||this.unfolding;return!e&&(!!this.collapsed_||this.collapsed)},key(){return this.getKey(this.value)}},data(){return{collapsed_:!1,folding:!1,hover:!1,hoverTimeout:null,unfolding:!1}},watch:{collapsed_(e){e?(this.folding=!0,setTimeout((()=>{this.folding=!1}),300)):(this.unfolding=!0,setTimeout((()=>{this.unfolding=!1}),300))}},methods:{onDragEnter(){this.hoverTimeout||(this.hoverTimeout=setTimeout((()=>{this.hover=!0}),500))},onDragLeave(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null),this.hover=!1}}};const Fe=(0,P.A)(We,[["render",Xe],["__scopeId","data-v-505af250"]]);var Qe=Fe;const je=e=>((0,a.Qi)("data-v-7d017735"),e=e(),(0,a.jt)(),e),Ne={key:0,class:"drag-spacer"},He={class:"tile-name"},qe=je((()=>(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-question"})],-1))),Me={class:"name"},Re=je((()=>(0,a.Lk)("span",{class:"keyword"},"if",-1))),Pe=["textContent"],Ue=je((()=>(0,a.Lk)("div",{class:"tile-name"},[(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-question"})]),(0,a.Lk)("span",{class:"name"},[(0,a.Lk)("span",{class:"keyword"},"else")])],-1))),ze={key:3,class:"condition-editor-container"},Ke=je((()=>(0,a.Lk)("div",{class:"header"}," Condition ",-1)));function Ye(e,t,n,o,r,l){const d=(0,a.g2)("Tile"),c=(0,a.g2)("ExpressionEditor"),u=(0,a.g2)("Modal"),p=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(p,(0,a.v6)({class:"condition-tile",value:n.value,active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop},(0,a.Tb)(l.dragListeners),{onInput:t[3]||(t[3]=t=>e.$emit("input",t))}),{default:(0,a.k6)((()=>[r.dragging&&!n.spacerTop?((0,a.uX)(),(0,a.CE)("div",Ne," ")):(0,a.Q3)("",!0),n.isElse?((0,a.uX)(),(0,a.Wv)(d,(0,a.v6)({key:2},l.tileConf.props,(0,a.Tb)(l.tileConf.on),{draggable:!1,"read-only":!0,onClick:t[1]||(t[1]=t=>e.$emit("click"))}),{default:(0,a.k6)((()=>[Ue])),_:1},16)):((0,a.uX)(),(0,a.Wv)(d,(0,a.v6)({key:1},l.tileConf.props,(0,a.Tb)(l.tileConf.on),{draggable:!n.readOnly,onClick:t[0]||(t[0]=(0,s.D$)((e=>r.showConditionEditor=!0),["stop"]))}),{default:(0,a.k6)((()=>[(0,a.Lk)("div",He,[qe,(0,a.Lk)("span",Me,[Re,(0,a.eW)(" [ "),(0,a.Lk)("span",{class:"code",textContent:(0,i.v_)(n.value)},null,8,Pe),(0,a.eW)(" ] ")])])])),_:1},16,["draggable"])),r.showConditionEditor&&!n.readOnly?((0,a.uX)(),(0,a.CE)("div",ze,[(0,a.bF)(u,{title:"Edit Condition",visible:!0,onClose:t[2]||(t[2]=e=>r.showConditionEditor=!1)},{default:(0,a.k6)((()=>[r.showConditionEditor?((0,a.uX)(),(0,a.Wv)(c,{key:0,value:n.value,context:e.context,ref:"conditionEditor",onInput:(0,s.D$)(l.onConditionChange,["prevent","stop"])},{default:(0,a.k6)((()=>[Ke])),_:1},8,["value","context","onInput"])):(0,a.Q3)("",!0)])),_:1})])):(0,a.Q3)("",!0)])),_:1},16,["value","active","read-only","spacer-bottom","spacer-top"])}const Je=e=>((0,a.Qi)("data-v-cfcbaedc"),e=e(),(0,a.jt)(),e),Ge={for:"expression"},Ze=["disabled"],et=Je((()=>(0,a.Lk)("i",{class:"fas fa-check"},null,-1)));function tt(e,t,n,i,o,r){const l=(0,a.g2)("ContextAutocomplete");return(0,a.uX)(),(0,a.CE)("form",{class:"expression-editor",onSubmit:t[0]||(t[0]=(0,s.D$)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent","stop"]))},[(0,a.Lk)("label",Ge,[(0,a.RG)(e.$slots,"default",{},void 0,!0),(0,a.bF)(l,{value:o.newValue,items:e.contextAutocompleteItems,quote:n.quote,onInput:(0,s.D$)(r.onInput,["stop"]),ref:"input"},null,8,["value","items","quote","onInput"])]),(0,a.Lk)("label",null,[(0,a.Lk)("button",{type:"submit",disabled:!o.hasChanges},[et,(0,a.eW)(" Save ")],8,Ze)])],32)}var nt=n(3714),at={emits:["input"],mixins:[q.A],components:{ContextAutocomplete:nt.A},props:{value:{type:[String,Number,Boolean,Object,Array],default:""},allowEmpty:{type:Boolean,default:!1},placeholder:{type:String,default:""},quote:{type:Boolean,default:!1}},data(){return{hasChanges:!1,newValue:null}},methods:{onSubmit(e){const t=this.newValue?.trim();(t.length||this.allowEmpty)&&(e.target.value=t,this.$emit("input",e))},onInput(e){if(null==e?.detail)return;const t=""+e.detail;t?.trim()?.length?this.hasChanges=t!==this.value:this.hasChanges=this.allowEmpty,this.$nextTick((()=>{this.newValue=t}))}},watch:{value(){this.hasChanges=!1}},mounted(){this.hasChanges=!1,this.newValue=this.value,this.value?.trim?.()?.length||(this.hasChanges=this.allowEmpty),this.$nextTick((()=>{this.textInput?.focus()}))}};const it=(0,P.A)(at,[["render",tt],["__scopeId","data-v-cfcbaedc"]]);var st=it,ot={emits:["change","click","delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],mixins:[q.A],components:{ExpressionEditor:st,ListItem:oe,Modal:M.A,Tile:Ce},props:{value:{type:String,required:!0},active:{type:Boolean,default:!1},isElse:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0}},computed:{dragListeners(){return this.readOnly?{}:{drag:this.onDragStart,dragend:this.onDragEnd,dragenter:e=>this.$emit("dragenter",e),dragleave:e=>this.$emit("dragleave",e),dragover:e=>this.$emit("dragover",e),drop:this.onDrop}},tileConf(){return{props:{value:this.value,class:"keyword",readOnly:this.readOnly,withDelete:!this.readOnly},on:{...this.dragListeners,delete:()=>this.$emit("delete"),input:this.onInput}}}},data(){return{dragging:!1,showConditionEditor:!1}},methods:{onConditionChange(e){if(this.showConditionEditor=!1,this.readOnly)return;const t=e.target.value?.trim();t?.length&&(e.target.value=t,this.$emit("change",t))},onInput(e){e&&!this.readOnly&&this.$emit("input",e)},onDragStart(e){this.readOnly||(this.dragging=!0,this.$emit("drag",e))},onDragEnd(e){this.dragging=!1,this.$emit("dragend",e)},onDrop(e){this.dragging=!1,this.readOnly||this.$emit("drop",e)}}};const rt=(0,P.A)(ot,[["render",Ye],["__scopeId","data-v-7d017735"]]);var lt=rt;const dt={class:"tile-name"},ct={class:"icon"},ut={class:"name"},pt=["textContent"];function ht(e,t,n,s,o,r){const l=(0,a.g2)("Tile"),d=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(d,{class:"end-block-container",active:n.active,value:{},"read-only":!1,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop,onDragenter:t[0]||(t[0]=t=>e.$emit("dragenter",t)),onDragleave:t[1]||(t[1]=t=>e.$emit("dragleave",t)),onDragover:t[2]||(t[2]=t=>e.$emit("dragover",t)),onDrop:t[3]||(t[3]=t=>e.$emit("drop",t))},{default:(0,a.k6)((()=>[(0,a.bF)(l,{class:"keyword",draggable:!1,"read-only":!0},{default:(0,a.k6)((()=>[(0,a.Lk)("div",dt,[(0,a.Lk)("span",ct,[(0,a.Lk)("i",{class:(0,i.C4)(n.icon)},null,2)]),(0,a.Lk)("span",ut,[(0,a.Lk)("span",{class:"keyword",textContent:(0,i.v_)(n.value)},null,8,pt)])])])),_:1})])),_:1},8,["active","spacer-bottom","spacer-top"])}var gt={mixins:[q.A],components:{ListItem:oe,Tile:Ce},props:{value:{type:String,required:!0},icon:{type:String,required:!0},active:{type:Boolean,default:!1},spacerTop:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!1}}};const vt=(0,P.A)(gt,[["render",ht]]);var mt=vt,yt={name:"ConditionBlock",mixins:[q.A],emits:["add-else","delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ActionsBlock:Qe,ConditionTile:lt,EndBlockTile:mt},props:{value:{type:Object,required:!0},active:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},dragging:{type:Boolean,default:!1},hasElse:{type:Boolean,default:!1},indent:{type:Number,default:0},isElse:{type:Boolean,default:!1},isInsideLoop:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!1},spacerTop:{type:Boolean,default:!1}},data(){return{dragging_:!1}},computed:{condition(){return this.getCondition(this.key)},conditionTileConf(){return{props:{active:this.active,context:this.context,readOnly:this.readOnly,spacerBottom:this.spacerBottom,spacerTop:this.spacerTop},on:{change:this.onConditionChange,delete:e=>this.$emit("delete",e),drag:this.onDragStart,dragend:this.onDragEnd,dragenterspacer:e=>this.$emit("dragenter",e),dragleavespacer:e=>this.$emit("dragleave",e),dragover:e=>this.$emit("dragover",e),dragoverspacer:e=>this.$emit("dragoverspacer",e),drop:this.onDrop}}},isDragging(){return this.dragging_||this.dragging},key(){return this.getKey(this.value)}},methods:{onActionsChange(e){this.key&&!this.readOnly&&this.$emit("input",{[this.key]:e})},onConditionChange(e){this.key&&!this.readOnly&&e?.length&&(e=`if \${${e.trim()}}`,this.$emit("input",{[e]:this.value[this.key]}))},onDragStart(e){this.readOnly||(this.dragging_=!0,this.$emit("drag",e))},onDragEnd(e){this.dragging_=!1,this.$emit("dragend",e)},onDrop(e){this.readOnly||(this.dragging_=!1,this.$emit("drop",e))}}};const ft=(0,P.A)(yt,[["render",Oe],["__scopeId","data-v-79ae696c"]]);var kt=ft;const bt=(0,a.Lk)("div",{class:"tile-name"},[(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-rotate"})]),(0,a.Lk)("span",{class:"name"},[(0,a.Lk)("span",{class:"keyword"},"continue")])],-1);function Ct(e,t,n,i,o,r){const l=(0,a.g2)("Tile"),d=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(d,{class:"continue-tile",value:"continue",active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop},{default:(0,a.k6)((()=>[(0,a.bF)(l,{value:n.value,class:"keyword",draggable:!1,"read-only":n.readOnly,"with-delete":!n.readOnly,onClick:t[0]||(t[0]=(0,s.D$)((()=>{}),["stop"])),onDelete:t[1]||(t[1]=t=>e.$emit("delete"))},{default:(0,a.k6)((()=>[bt])),_:1},8,["value","read-only","with-delete"])])),_:1},8,["active","read-only","spacer-bottom","spacer-top"])}var Dt={emits:["delete"],components:{ListItem:oe,Tile:Ce},props:{value:{type:String,default:"continue"},active:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0}}};const wt=(0,P.A)(Dt,[["render",Ct]]);var Et=wt;const $t={class:"loop-block"};function Lt(e,t,n,i,o,r){const l=(0,a.g2)("LoopTile"),d=(0,a.g2)("EndBlockTile"),c=(0,a.g2)("ActionsBlock");return(0,a.uX)(),(0,a.CE)("div",$t,[(0,a.bF)(c,{value:n.value,collapsed:n.collapsed,context:r.context_,dragging:r.isDragging,indent:n.indent,"is-inside-loop":!0,"read-only":n.readOnly,onInput:r.onActionsChange,onDrag:t[1]||(t[1]=t=>e.$emit("drag",t)),onDragend:t[2]||(t[2]=t=>e.$emit("dragend",t)),onDragenter:t[3]||(t[3]=t=>e.$emit("dragenter",t)),onDragleave:t[4]||(t[4]=t=>e.$emit("dragleave",t)),onDragover:t[5]||(t[5]=t=>e.$emit("dragover",t)),onDrop:t[6]||(t[6]=t=>e.$emit("drop",t))},{before:(0,a.k6)((()=>[(0,a.bF)(l,(0,a.v6)(r.loopTileConf.props,(0,a.Tb)(r.loopTileConf.on),{onInput:t[0]||(t[0]=(0,s.D$)((()=>{}),["prevent","stop"])),"spacer-top":n.spacerTop,"spacer-bottom":!1}),null,16,["spacer-top"])])),after:(0,a.k6)((()=>[(0,a.bF)(d,{value:`end ${n.type}`,icon:"fas fa-arrow-rotate-right",active:n.active,"spacer-bottom":n.spacerBottom||n.dragging,onDrop:r.onDrop},null,8,["value","active","spacer-bottom","onDrop"])])),_:1},8,["value","collapsed","context","dragging","indent","read-only","onInput"])])}const xt=e=>((0,a.Qi)("data-v-54198b35"),e=e(),(0,a.jt)(),e),Bt={key:0,class:"drag-spacer"},Tt={class:"tile-name"},At=xt((()=>(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-arrow-rotate-left"})],-1))),Ot={key:0,class:"name"},It={class:"keyword"},St={key:0},Vt=["textContent"],_t=xt((()=>(0,a.Lk)("span",{class:"keyword"}," in ",-1))),Xt=["textContent"],Wt={key:1,class:"name"},Ft=xt((()=>(0,a.Lk)("span",{class:"keyword"},"while",-1))),Qt=["textContent"],jt={key:1,class:"editor-container"};function Nt(e,t,n,o,r,l){const d=(0,a.g2)("Tile"),c=(0,a.g2)("LoopEditor"),u=(0,a.g2)("ExpressionEditor"),p=(0,a.g2)("Modal"),h=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(h,(0,a.v6)({class:"loop-tile",value:l.value,active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop},(0,a.Tb)(l.dragListeners),{onInput:t[2]||(t[2]=t=>e.$emit("input",t))}),{default:(0,a.k6)((()=>[r.dragging&&!n.spacerTop?((0,a.uX)(),(0,a.CE)("div",Bt," ")):(0,a.Q3)("",!0),(0,a.bF)(d,(0,a.v6)(l.tileConf.props,(0,a.Tb)(l.tileConf.on),{draggable:!n.readOnly,onClick:t[0]||(t[0]=(0,s.D$)((e=>r.showLoopEditor=!0),["stop"]))}),{default:(0,a.k6)((()=>[(0,a.Lk)("div",Tt,[At,"for"===n.type?((0,a.uX)(),(0,a.CE)("span",Ot,[(0,a.Lk)("span",It,[(0,a.eW)("for"),n.async?((0,a.uX)(),(0,a.CE)("span",St,"k")):(0,a.Q3)("",!0)]),(0,a.eW)(),(0,a.Lk)("span",{class:"code",textContent:(0,i.v_)(n.iterator)},null,8,Vt),_t,(0,a.eW)(" [ "),(0,a.Lk)("span",{class:"code",textContent:(0,i.v_)(n.iterable)},null,8,Xt),(0,a.eW)(" ] ")])):"while"===n.type?((0,a.uX)(),(0,a.CE)("span",Wt,[Ft,(0,a.eW)(" [ "),(0,a.Lk)("span",{class:"code",textContent:(0,i.v_)(n.condition)},null,8,Qt),(0,a.eW)(" ] ")])):(0,a.Q3)("",!0)])])),_:1},16,["draggable"]),r.showLoopEditor&&!n.readOnly?((0,a.uX)(),(0,a.CE)("div",jt,[(0,a.bF)(p,{title:"Edit Loop",visible:!0,onClose:t[1]||(t[1]=e=>r.showLoopEditor=!1)},{default:(0,a.k6)((()=>[r.showLoopEditor&&"for"===n.type?((0,a.uX)(),(0,a.Wv)(c,{key:0,iterator:n.iterator,iterable:n.iterable,async:n.async,context:e.context,onChange:l.onLoopChange},{default:(0,a.k6)((()=>[(0,a.eW)(" Loop ")])),_:1},8,["iterator","iterable","async","context","onChange"])):r.showLoopEditor&&"while"===n.type?((0,a.uX)(),(0,a.Wv)(u,{key:1,value:n.condition,context:e.context,onInput:(0,s.D$)(l.onConditionChange,["prevent","stop"])},{default:(0,a.k6)((()=>[(0,a.eW)(" Loop Condition ")])),_:1},8,["value","context","onInput"])):(0,a.Q3)("",!0)])),_:1})])):(0,a.Q3)("",!0)])),_:1},16,["value","active","read-only","spacer-bottom","spacer-top"])}const Ht=e=>((0,a.Qi)("data-v-f2db70a8"),e=e(),(0,a.jt)(),e),qt={for:"iterator"},Mt=["value"],Rt={for:"iterable"},Pt={class:"async"},Ut=["checked"],zt=["disabled"],Kt=Ht((()=>(0,a.Lk)("i",{class:"fas fa-check"},null,-1)));function Yt(e,t,n,i,o,r){const l=(0,a.g2)("ContextAutocomplete");return(0,a.uX)(),(0,a.CE)("form",{class:"loop-editor",onSubmit:t[3]||(t[3]=(0,s.D$)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent","stop"]))},[(0,a.eW)(" for "),(0,a.Lk)("label",qt,[(0,a.Lk)("input",{type:"text",name:"iterator",autocomplete:"off",autofocus:!0,placeholder:"Iterator",value:o.newValue.iterator,ref:"iterator",onInput:t[0]||(t[0]=(0,s.D$)((e=>r.onInput("iterator",e)),["stop"]))},null,40,Mt)]),(0,a.eW)(" in "),(0,a.Lk)("label",Rt,[(0,a.bF)(l,{value:o.newValue.iterable,items:e.contextAutocompleteItems,placeholder:"Iterable",onInput:t[1]||(t[1]=(0,s.D$)((e=>r.onInput("iterable",e)),["stop"])),ref:"iterable"},null,8,["value","items"])]),(0,a.Lk)("label",Pt,[(0,a.Lk)("input",{class:"checkbox",type:"checkbox",name:"async",ref:"async",checked:n.async,onInput:t[2]||(t[2]=(0,s.D$)((e=>r.onInput("async",e)),["stop"]))},null,40,Ut),(0,a.eW)("  Run in parallel ")]),(0,a.Lk)("label",null,[(0,a.Lk)("button",{type:"submit",disabled:!o.hasChanges},[Kt,(0,a.eW)(" Save ")],8,zt)])],32)}var Jt={emits:["change","input"],mixins:[q.A],components:{ContextAutocomplete:nt.A},props:{async:{type:Boolean,default:!1},iterable:{type:String,default:""},iterator:{type:String,default:""}},data(){return{hasChanges:!0,newValue:{iterator:null,iterable:null,async:null}}},methods:{onSubmit(){const e=this.$refs.iterator.value.trim(),t=this.$refs.iterable.value.trim(),n=this.$refs.async.checked;e.length&&t.length&&this.$emit("change",{iterator:e,iterable:t,async:n})},onInput(e,t){const n=""+(t.target?.value||t.detail);n?.trim()?.length?("iterator"===e&&(this.hasChanges=n!==this.iterator),this.hasChanges||"iterable"!==e||(this.hasChanges=n!==this.iterable),this.hasChanges||"async"!==e||(this.hasChanges=n!==this.async)):this.hasChanges=!1,this.$nextTick((()=>{this.newValue[e]=n}))}},watch:{value(){this.hasChanges=!1,this.newValue={iterator:this.iterator,iterable:this.iterable,async:this.async}}},mounted(){this.newValue={iterator:this.iterator,iterable:this.iterable,async:this.async},this.$nextTick((()=>{this.$refs.iterator.focus()}))}};const Gt=(0,P.A)(Jt,[["render",Yt],["__scopeId","data-v-f2db70a8"]]);var Zt=Gt,en={mixins:[q.A],emits:["change","click","delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ExpressionEditor:st,LoopEditor:Zt,ListItem:oe,Modal:M.A,Tile:Ce},props:{active:{type:Boolean,default:!1},async:{type:Boolean,default:!1},condition:{type:String},iterator:{type:String},iterable:{type:String},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0},type:{type:String,required:!0}},computed:{dragListeners(){return this.readOnly?{}:{drag:this.onDragStart,dragend:this.onDragEnd,dragenter:e=>this.$emit("dragenter",e),dragleave:e=>this.$emit("dragleave",e),dragover:e=>this.$emit("dragover",e),drop:this.onDrop}},tileConf(){return{props:{value:this.value,class:"keyword",readOnly:this.readOnly,withDelete:!this.readOnly},on:{...this.dragListeners,delete:()=>this.$emit("delete"),input:this.onInput}}},value(){return`for ${this.iterator} in ${this.iterable}`}},data(){return{dragging:!1,showLoopEditor:!1}},methods:{onConditionChange(e){if(this.showLoopEditor=!1,this.readOnly)return;const t=e.target.value?.trim();t?.length&&(e.target.value=t,this.$emit("change",t))},onLoopChange(e){this.showLoopEditor=!1,this.readOnly||this.$emit("change",e)},onInput(e){e&&!this.readOnly&&this.$emit("input",e)},onDragStart(e){this.readOnly||(this.dragging=!0,this.$emit("drag",e))},onDragEnd(e){this.dragging=!1,this.$emit("dragend",e)},onDrop(e){this.dragging=!1,this.readOnly||this.$emit("drop",e)}}};const tn=(0,P.A)(en,[["render",Nt],["__scopeId","data-v-54198b35"]]);var nn=tn,an={name:"LoopBlock",mixins:[q.A],emits:["delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ActionsBlock:Qe,LoopTile:nn,EndBlockTile:mt},props:{value:{type:Object,required:!0},type:{type:String,required:!0},active:{type:Boolean,default:!1},async:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},dragging:{type:Boolean,default:!1},indent:{type:Number,default:0},isInsideLoop:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!1},spacerTop:{type:Boolean,default:!1}},data(){return{dragging_:!1}},computed:{changeHandler(){return"for"===this.type?this.onForChange:"while"===this.type?this.onWhileChange:()=>{}},context_(){const e={...this.context},t=this.loop?.iterator?.trim();return t?.length&&(e[t]={source:"for"}),e},isDragging(){return this.dragging_||this.dragging},key(){return this.getKey(this.value)},loop(){return"for"===this.type?this.getFor(this.key):"while"===this.type?{condition:this.getWhile(this.key)}:{}},loopTileConf(){return{props:{...this.loop,active:this.active,context:this.context_,readOnly:this.readOnly,spacerBottom:this.spacerBottom,spacerTop:this.spacerTop,type:this.type},on:{change:this.changeHandler,delete:e=>this.$emit("delete",e),drag:this.onDragStart,dragend:this.onDragEnd,dragenterspacer:e=>this.$emit("dragenter",e),dragleavespacer:e=>this.$emit("dragleave",e),dragover:e=>this.$emit("dragover",e),dragoverspacer:e=>this.$emit("dragoverspacer",e),drop:this.onDrop}}}},methods:{onActionsChange(e){this.key&&!this.readOnly&&this.$emit("input",{[this.key]:e})},onForChange(e){const t=e?.iterable?.trim(),n=e?.iterator?.trim(),a=e?.async||!1;if(!this.key||this.readOnly||!t?.length||!n?.length)return;const i="for"+(a?"k":"");e=`${i} ${n} in \${${t}}`,this.$emit("input",{[e]:this.value[this.key]})},onWhileChange(e){if(e=e?.trim(),!this.key||this.readOnly||!e?.length)return;const t=`while \${${e}}`;this.$emit("input",{[t]:this.value[this.key]})},onDragStart(e){this.readOnly||(this.dragging_=!0,this.$emit("drag",e))},onDragEnd(e){this.dragging_=!1,this.$emit("dragend",e)},onDrop(e){this.readOnly||(this.dragging_=!1,this.$emit("drop",e))}}};const sn=(0,P.A)(an,[["render",Lt]]);var on=sn;const rn={class:"tile-name"},ln=(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-angle-right"})],-1),dn={class:"name"},cn=(0,a.Lk)("span",{class:"keyword"},"return",-1),un=["textContent"],pn={key:0,class:"editor-container"};function hn(e,t,n,o,r,l){const d=(0,a.g2)("Tile"),c=(0,a.g2)("ExpressionEditor"),u=(0,a.g2)("Modal"),p=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(p,{class:"return-tile",value:n.value,active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop,onInput:t[2]||(t[2]=t=>e.$emit("input",t))},{default:(0,a.k6)((()=>[(0,a.bF)(d,(0,a.v6)(l.tileConf.props,(0,a.Tb)(l.tileConf.on),{onClick:t[0]||(t[0]=(0,s.D$)((e=>r.showExprEditor=!0),["stop"]))}),{default:(0,a.k6)((()=>[(0,a.Lk)("div",rn,[ln,(0,a.Lk)("span",dn,[cn,(0,a.eW)(),(0,a.Lk)("span",{class:"code",textContent:(0,i.v_)(n.value)},null,8,un)])])])),_:1},16),r.showExprEditor&&!n.readOnly?((0,a.uX)(),(0,a.CE)("div",pn,[(0,a.bF)(u,{title:"Edit Return",visible:!0,onClose:t[1]||(t[1]=e=>r.showExprEditor=!1)},{default:(0,a.k6)((()=>[r.showExprEditor?((0,a.uX)(),(0,a.Wv)(c,{key:0,value:n.value,"allow-empty":!0,context:e.context,quote:!0,placeholder:"Optional return value",ref:"exprEditor",onInput:(0,s.D$)(l.onExprChange,["prevent","stop"])},{default:(0,a.k6)((()=>[(0,a.eW)(" Value or Expression ")])),_:1},8,["value","context","onInput"])):(0,a.Q3)("",!0)])),_:1})])):(0,a.Q3)("",!0)])),_:1},8,["value","active","read-only","spacer-bottom","spacer-top"])}var gn={mixins:[q.A],emits:["change","click","delete","input"],components:{ExpressionEditor:st,ListItem:oe,Modal:M.A,Tile:Ce},props:{value:{type:[String,Number,Boolean,Object,Array],default:""},active:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0}},computed:{tileConf(){return{props:{value:this.value,class:"keyword",draggable:!1,readOnly:this.readOnly,withDelete:!this.readOnly},on:{delete:()=>this.$emit("delete"),input:this.onInput}}}},data(){return{showExprEditor:!1}},methods:{onExprChange(e){if(this.showExprEditor=!1,this.readOnly)return;const t=e.target.value?.trim();e.target.value=t,this.$emit("change",t)},onInput(e){e&&!this.readOnly&&this.$emit("input",e)}}};const vn=(0,P.A)(gn,[["render",hn]]);var mn=vn;const yn=e=>((0,a.Qi)("data-v-73c595c1"),e=e(),(0,a.jt)(),e),fn=yn((()=>(0,a.Lk)("div",{class:"tile-name"},[(0,a.Lk)("span",{class:"icon"},[(0,a.Lk)("i",{class:"fas fa-square-root-variable"})]),(0,a.Lk)("span",{class:"name"},[(0,a.Lk)("div",{class:"keyword"},"set")])],-1))),kn={class:"variables"},bn=["textContent"],Cn=["textContent"],Dn={key:0,class:"editor-container"},wn={class:"name"},En=["onBlur","onUpdate:modelValue"],$n={class:"value"},Ln={class:"variable"},xn={class:"name"},Bn={class:"value"},Tn=yn((()=>(0,a.Lk)("div",{class:"buttons"},[(0,a.Lk)("button",{type:"submit",class:"btn btn-primary"}," Save ")],-1)));function An(e,t,n,o,r,l){const d=(0,a.g2)("Tile"),c=(0,a.g2)("ContextAutocomplete"),u=(0,a.g2)("Modal"),p=(0,a.g2)("ListItem");return(0,a.uX)(),(0,a.Wv)(p,(0,a.v6)({class:["set-variables-tile",{active:n.active}],dragging:r.dragging_,value:n.value,active:n.active,"read-only":n.readOnly,"spacer-bottom":n.spacerBottom,"spacer-top":n.spacerTop},(0,a.Tb)(l.dragListeners),{onInput:t[8]||(t[8]=t=>e.$emit("input",t))}),{default:(0,a.k6)((()=>[(0,a.bF)(d,(0,a.v6)(l.tileConf.props,(0,a.Tb)(l.tileConf.on),{draggable:!n.readOnly,onClick:t[0]||(t[0]=(0,s.D$)((e=>r.showEditor=!0),["stop"]))}),{default:(0,a.k6)((()=>[fn,(0,a.Lk)("div",kn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.value,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"variable",key:t},[(0,a.Lk)("span",{class:"code name",textContent:(0,i.v_)(t)},null,8,bn),(0,a.eW)(" = "),(0,a.Lk)("span",{class:"code value",textContent:(0,i.v_)(e)},null,8,Cn)])))),128))])])),_:1},16,["draggable"]),r.showEditor&&!n.readOnly?((0,a.uX)(),(0,a.CE)("div",Dn,[(0,a.bF)(u,{title:"Set Variables",visible:!0,onClose:t[7]||(t[7]=e=>r.showEditor=!1)},{default:(0,a.k6)((()=>[(0,a.Lk)("form",{class:"editor",onSubmit:t[6]||(t[6]=(0,s.D$)(((...e)=>l.onChange&&l.onChange(...e)),["prevent"]))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.newValue,((n,i)=>((0,a.uX)(),(0,a.CE)("div",{class:"variable",key:i},[(0,a.Lk)("span",wn,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Variable Name",onBlur:e=>l.onBlur(i),onInput:t[1]||(t[1]=(0,s.D$)((()=>{}),["prevent","stop"])),"onUpdate:modelValue":e=>r.newValue[i][0]=e},null,40,En),[[s.Jo,r.newValue[i][0]]]),(0,a.eW)(" = ")]),(0,a.Lk)("span",$n,[(0,a.bF)(c,{value:r.newValue[i][1],items:e.contextAutocompleteItems,quote:!0,"select-on-tab":!1,placeholder:"Value",onInput:(0,s.D$)((e=>r.newValue[i][1]=e.detail),["prevent","stop"])},null,8,["value","items","onInput"])])])))),128)),(0,a.Lk)("div",Ln,[(0,a.Lk)("span",xn,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Variable Name",ref:"newVarName",onInput:t[2]||(t[2]=(0,s.D$)((()=>{}),["prevent","stop"])),"onUpdate:modelValue":t[3]||(t[3]=e=>r.newVariable.name=e)},null,544),[[s.Jo,r.newVariable.name]]),(0,a.eW)(" = ")]),(0,a.Lk)("span",Bn,[(0,a.bF)(c,{value:r.newVariable.value,items:e.contextAutocompleteItems,quote:!0,"select-on-tab":!1,placeholder:"Value",onInput:t[4]||(t[4]=(0,s.D$)((e=>r.newVariable.value=e.detail),["prevent","stop"])),onBlur:t[5]||(t[5]=e=>l.onBlur(null))},null,8,["value","items"])])]),Tn],32)])),_:1})])):(0,a.Q3)("",!0)])),_:1},16,["class","dragging","value","active","read-only","spacer-bottom","spacer-top"])}var On={mixins:[q.A],emits:["click","delete","drag","dragend","dragenter","dragleave","dragover","drop","input"],components:{ContextAutocomplete:nt.A,ListItem:oe,Modal:M.A,Tile:Ce},props:{active:{type:Boolean,default:!1},dragging:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},spacerBottom:{type:Boolean,default:!0},spacerTop:{type:Boolean,default:!0},value:{type:Object,default:()=>({})}},computed:{dragListeners(){return this.readOnly?{}:{drag:this.onDragStart,dragend:this.onDragEnd,dragenter:e=>this.$emit("dragenter",e),dragleave:e=>this.$emit("dragleave",e),dragover:e=>this.$emit("dragover",e),drop:this.onDrop}},tileConf(){return{props:{value:this.value,class:"keyword",readOnly:this.readOnly,withDelete:!this.readOnly},on:{...this.dragListeners,delete:()=>this.$emit("delete"),input:this.onInput}}}},data(){return{dragging_:!1,newValue:[],newVariable:{name:"",value:""},showEditor:!1}},methods:{onChange(){if(this.showEditor=!1,this.readOnly)return;const e=this.newValue;this.newVariable.name?.trim?.()?.length&&e.push([this.newVariable.name,this.newVariable.value]);const t=e.map((([e,t])=>{e=this.sanitizeName(e);try{t=JSON.parse(t)}catch(n){t=t?.trim()}return[e,t]})).reduce(((e,[t,n])=>t?.length?(e[t]=n,e):e),{});Object.keys(t).length&&this.onInput(t)},onInput(e){e&&!this.readOnly&&this.$emit("input",{set:e})},onBlur(e){if(!this.readOnly)if(null!=e){const t=this.sanitizeName(this.newValue[e][0]);t?.length?this.newValue[e][0]=t:this.newValue.splice(e,1)}else{const e=this.sanitizeName(this.newVariable.name),t=this.newVariable.value;e?.length&&(this.newValue.push([e,t]),this.newVariable={name:"",value:""},this.$nextTick((()=>{this.$refs.newVarName?.focus()})))}},onDragStart(e){this.readOnly||(this.dragging_=!0,this.$emit("drag",e))},onDragEnd(e){this.dragging_=!1,this.$emit("dragend",e)},onDrop(e){this.dragging_=!1,this.readOnly||this.$emit("drop",e)},sanitizeName(e){return e?.trim()?.replace(/[^\w_]/g,"_")},syncValue(){this.newValue=Object.entries(this.value)}},watch:{showEditor(e){e?this.$nextTick((()=>{this.$refs.newVarName?.focus()})):this.newVariable={name:"",value:""}},value:{immediate:!0,handler(){this.syncValue()}}},mounted(){this.syncValue(),this.$nextTick((()=>{this.$refs.newVarName?.focus()}))}};const In=(0,P.A)(On,[["render",An],["__scopeId","data-v-73c595c1"]]);var Sn=In,Vn={name:"ActionsList",mixins:[q.A,ae.A],emits:["add-else","change","collapse","drag","dragend","dragenter","dragleave","dragover","drop","input","reset","update"],components:{ActionsListItem:de,ActionTile:z,AddTile:Ee,BreakTile:Te,ConditionBlock:kt,ContinueTile:Et,ListItem:oe,LoopBlock:on,ReturnTile:mn,SetVariablesTile:Sn},props:{collapsed:{type:Boolean,default:!1},dragging:{type:Boolean,default:!1},hasElse:{type:Boolean,default:!1},indent:{type:Number,default:0},isInsideLoop:{type:Boolean,default:!1},parent:{type:Object,default:null},readOnly:{type:Boolean,default:!1},value:{type:Object,default:()=>({name:void 0,actions:[]})}},data(){return{collapseAddButtons:!0,newValue:[],dragIndices:void 0,initialValue:void 0,newAction:{},spacerElements:{}}},computed:{collapsedBlocks(){return this.newValue.reduce(((e,t,n)=>this.isActionsBlock(t)?this.isDragging?(this.elses[n]?e[n]=this.dragBlockIndex===n-1:e[n]=this.dragBlockIndex===n,e):(e[n]=this.collapsed,e):e),{})},componentsData(){return this.newValue.map(((e,t)=>{let n={props:{value:e,active:this.isDragging,context:this.contexts[t],isInsideLoop:!!(this.isInsideLoop||this.getFor(e)||this.getWhile(e)),readOnly:this.readOnly,ref:`action-tile-${t}`,spacerBottom:this.visibleBottomSpacers[t],spacerTop:this.visibleTopSpacers[t]},on:{delete:()=>this.deleteAction(t),drag:e=>this.onDragStart(t,e),dragend:e=>this.onDragEnd(e),dragenter:e=>this.onDragEnter(t,e),dragleave:e=>this.onDragLeave(t,e),dragover:e=>this.onDragOver(e),drop:e=>{try{this.onDrop(t,e)}finally{this.isDragging=!1}},input:e=>this.editAction(e,t)}};this.getCondition(e)&&this.newValue[t+1]&&this.isElse(this.newValue[t+1])&&(n.props.hasElse=!0),this.isActionsBlock(e)&&(n.props.indent=this.indent+1);const a=this.getFor(e);a&&(n.props.async=a.async,n.props.type="for");const i=this.getWhile(e);return i&&(n.props.type="while"),this.isSet(e)&&(n.props.value=e.set),n}))},conditions(){return this.newValue?.reduce?.(((e,t,n)=>{const a=this.getCondition(t);return a&&(e[n]={condition:a,actions:t[Object.keys(t)[0]]}),e}),{})||{}},contexts(){const e={...this.context},t=this.newValue?.reduce?.(((t,n,a)=>(t[a]=this.getContext(n,a,e),t)),{})||{},n=Object.keys(t).length;return n>0?(t[n]=this.getContext(null,n,t[n-1]),t[n]={...this.context,...e,...t[n-1],...t[n]}):t[0]={...this.context},t},dragBlockIndex(){if(null!=this.dragIndex&&1===this.dragIndices?.length&&this.dragIndices[0]===this.dragIndex&&this.isActionsBlock(this.newValue[this.dragIndex]))return this.dragIndex},isDragging:{get(){return this.dragging||(this.dragIndices?.length||0)>0},set(e){e||(this.dragIndices=null)}},elses(){return this.newValue?.reduce?.(((e,t,n)=>(this.isElse(t)&&this.conditions[n-1]&&(e[n]=t[Object.keys(t)[0]]),e)),{})||{}},fors(){return this.newValue?.reduce?.(((e,t,n)=>(this.getFor(t)&&(e[n]=t),e)),{})||{}},whiles(){return this.newValue?.reduce?.(((e,t,n)=>(this.getWhile(t)&&(e[n]=t),e)),{})||{}},loops(){return[...Object.keys(this.fors),...Object.keys(this.whiles)].reduce(((e,t)=>(e[t]=this.newValue[t],e)),{})},sets(){return this.newValue?.reduce?.(((e,t,n)=>(this.isSet(t)&&(e[n]=t),e)),{})||{}},hasChanges(){return this.newStringValue!==this.stringValue},stringValue(){return JSON.stringify(this.value)},newStringValue(){return JSON.stringify(this.newValue)},dragIndex(){if(this.isDragging)return this.dragIndices?.[0]},breakIndex(){return this.getTileIndex((e=>this.isBreak(e)))},continueIndex(){return this.getTileIndex((e=>this.isContinue(e)))},returnIndex(){return this.getTileIndex((e=>this.isReturn(e)))},returnValue(){if(null==this.returnIndex)return"";const e=this.newValue[this.returnIndex];if(null==e)return"";let t=null;return t=Array.isArray(e)?1===e.length?e[0].match(/^return\s*(.*)$/)?.[1]:e:e.return,t||""},showAddButtons(){return 0===this.indent&&0===this.newValue.length||!this.collapseAddButtons},showAddButtonsExpander(){return!this.readOnly&&(this.newValue?.length>0||this.indent>0)&&Object.entries(this.visibleAddButtons).filter((([e,t])=>t&&"action"!=e)).length>1},stopIndex(){return null!=this.breakIndex?this.breakIndex:null!=this.continueIndex?this.continueIndex:null!=this.returnIndex?this.returnIndex:null},allowAddButtons(){return!this.readOnly&&!this.collapsed&&null==this.stopIndex},visibleActions(){return this.newValue.reduce(((e,t,n)=>(null!=this.stopIndex&&n>this.stopIndex||(this.conditions[n]||this.elses[n]||this.fors[n]||this.whiles[n]||this.isAction(t)||this.isBreak(t)||this.isContinue(t)||this.isReturn(t)||this.isSet(t))&&(e[n]=t),e)),{})},visibleAddButtons(){return{action:this.allowAddButtons,return:this.allowAddButtons,condition:this.allowAddButtons,for:this.allowAddButtons,while:this.allowAddButtons,set:this.allowAddButtons,else:this.allowAddButtons&&this.parent&&this.getCondition(this.parent)&&!this.hasElse,break:this.allowAddButtons&&this.isInsideLoop,continue:this.allowAddButtons&&this.isInsideLoop}},visibleTopSpacers(){const e=this.dragIndex;return this.newValue.reduce(((t,n,a)=>(t[a]=!this.isElse(n)&&(null==e||e>a||e===a&&this.dragIndices.length>1),t)),{})},visibleBottomSpacers(){const e=this.dragIndex;return this.newValue.reduce(((t,n,a)=>(t[a]=null!=e&&(e<a||e===a&&this.dragIndices.length>1)||null==e&&a===this.newValue.length-1,t)),{})}},methods:{onDragStart(e,t){this.readOnly||(t=Array.isArray(t)?[e,...t]:[e],this.dragIndices=t,this.$emit("drag",t))},onDragEnd(){this.isDragging=!1,this.$emit("dragend")},onDragEnter(e,t){this.isDragging&&!this.readOnly&&(t.stopPropagation?.(),this.$emit("dragenter",e))},onDragLeave(e,t){this.isDragging&&!this.readOnly&&(t.stopPropagation?.(),this.$emit("dragleave",e))},onDragOver(e){this.$emit("dragover",e)},onDrop(e,t){if(!this.isDragging||null==t||null==e||this.readOnly)return;t.stopPropagation?.();let n=[];if(n=t.detail?.length?[e,...t.detail]:[e],t=new CustomEvent("drop",{bubbles:!1,cancelable:!0,detail:n}),this.indent>0)return void this.$emit("drop",t);const a=this.dragIndices.slice(-1)[0];e=t.detail.slice(-1)[0];const i=this.getParentBlock(this.dragIndices),s=this.getParentBlock(n);if(!i||!s)return;const o=i?.[a],r=s?.[e];if(!o)return;const l=this.getCondition(o)&&this.isElse(i[a+1])?2:1;this.isElse(r)&&(e+=1),s.splice(e,0,...i.splice(a,l)),this.$emit("input",this.newValue)},onCollapse(){this.$emit("collapse")},getContext(e,t,n){const a={...n||this.context||{}};t>0&&(a.output={source:"action",action:this.newValue[t-1]}),this.isSet(e)&&Object.keys(e.set).forEach((e=>{e?.length&&(n[e]={source:"local"})}));const i=this.getFor(e)?.iterator;return i?.length&&(n[i]={source:"for"}),a},getParentBlock(e){e=[...e];let t=this.newValue;while(t&&e.length>1)if(t=t[e.shift()],t){const e=this.getKey(t);e&&(t=t[e])}return t},editAction(e,t){e?.target&&e.stopPropagation?e.stopPropagation?.():(this.newValue[t]=e,this.$emit("input",this.newValue))},addAction(e){this.newValue.push({...e,action:e.name||e.action})},addCondition(){this.newValue.push({"if ${True}":[]}),this.selectLastExprEditor()},addForLoop(){this.newValue.push({"for _ in ${range(10)}":[]}),this.selectLastExprEditor()},addWhileLoop(){this.newValue.push({"while ${True}":[]}),this.selectLastExprEditor()},addBreak(){this.newValue.push("break")},addContinue(){this.newValue.push("continue")},addSet(){this.newValue.push({set:{}}),this.selectLastExprEditor()},addReturn(){this.newValue.push({return:null}),this.selectLastExprEditor()},editReturn(e){this.newValue[this.returnIndex]={return:e?.length?e:null}},selectLastExprEditor(){this.$nextTick((()=>{const e=this.$refs["action-tile-"+(this.newValue.length-1)]?.[0];if(!e)return;const t=e.$el?.querySelector(".tile");t&&(t.click(),this.$nextTick((()=>{const t=e.$el?.querySelector(".editor-container");if(!t)return;const n=t.querySelector('input[type="text"]');n&&(n.value="",n.focus())})))}))},addElse(){this.newValue.push({else:[]})},deleteAction(e){const t=this.getCondition(this.newValue[e])&&this.isElse(this.newValue?.[e+1])?2:1,n=this.$refs[`action-tile-${e}`]?.[0]?.$el;n?(n.classList.add("shrink"),setTimeout((()=>{n.classList.remove("shrink"),this.newValue.splice(e,t)}),300)):this.newValue.splice(e,t)},getTileIndex(e){const t=this.newValue?.reduce?.(((t,n,a)=>t>=0?t:e(n)?a:t),-1);return t>=0?t:null},syncSpacers(){this.$nextTick((()=>{this.spacerElements=Object.keys(this.newValue).reduce(((e,t)=>(e[t]=this.$refs[`dropTarget_${t}`]?.[0],e)),{})}))},syncValue(){this.value&&this.hasChanges&&(this.newValue=this.value)}},watch:{newValue:{deep:!0,handler(e){this.$emit("input",e),this.syncSpacers()}},dragIndices(){this.syncSpacers()},value:{immediate:!0,deep:!0,handler(){this.syncValue()}}},mounted(){this.syncValue(),this.syncSpacers()},updated(){this.hasChanges&&this.$emit("update",this.newValue)}};const _n=(0,P.A)(Vn,[["render",w],["__scopeId","data-v-74ca2010"]]);var Xn=_n},9667:function(e,t,n){n.d(t,{A:function(){return h}});var a=n(641),i=n(3751);const s=e=>((0,a.Qi)("data-v-0bc64e95"),e=e(),(0,a.jt)(),e),o=s((()=>(0,a.Lk)("i",{class:"fas fa-clipboard"},null,-1))),r=[o];function l(e,t,n,s,o,l){return(0,a.uX)(),(0,a.CE)("button",{class:"copy-button",ref:"copyButton",title:"Copy to clipboard",onClick:t[0]||(t[0]=(0,i.D$)(((...e)=>l.copy&&l.copy(...e)),["prevent"])),onInput:t[1]||(t[1]=(0,i.D$)(((...e)=>l.copy&&l.copy(...e)),["prevent"]))},r,544)}var d=n(2002),c={name:"CopyButton",emits:["input","click"],mixins:[d.A],props:{text:{type:String}},methods:{async copy(e){this.text?.length&&await this.copyToClipboard(this.text),this.$emit(e.type,e)}}},u=n(6262);const p=(0,u.A)(c,[["render",l],["__scopeId","data-v-0bc64e95"]]);var h=p},8692:function(e,t,n){n.d(t,{A:function(){return c}});var a=n(641),i=n(33);const s=["innerHTML"];function o(e,t,n,o,r,l){return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["dragged",{hidden:!l.draggingVisible}]),style:(0,i.Tr)({top:`${r.top}px`,left:`${r.left}px`})},[l.draggingVisible?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"content",innerHTML:n.element?.outerHTML||"..."},null,8,s)):(0,a.Q3)("",!0)],6)}var r={emits:["contextmenu","drag","dragend","drop"],props:{disabled:{type:Boolean,default:!1},element:{type:Object},touchDragStartThreshold:{type:Number,default:500},touchDragMoveCancelDistance:{type:Number,default:10},value:{type:[Object,String,Number,Boolean,Array],default:()=>({})}},data(){return{dragging:!1,draggingHTML:null,eventsHandlers:{contextmenu:this.onContextMenu,drag:this.onDrag,dragend:this.onDragEnd,dragstart:this.onDragStart,drop:this.onDragEnd,touchcancel:this.onDragEnd,touchend:this.onTouchEnd,touchmove:this.onTouchMove,touchstart:this.onTouchStart},initialCursorOffset:null,left:0,top:0,touchDragStartTimer:null,touchScrollDirection:[0,0],touchScrollSpeed:10,touchScrollTimer:null,touchStart:null,touchOverElement:null}},computed:{draggingVisible(){return this.dragging&&this.touchStart},shouldScroll(){return this.touchScrollDirection[0]||this.touchScrollDirection[1]}},methods:{onContextMenu(e){!this.disabled&&this.touchStart?(e.preventDefault(),e.stopPropagation(),this.onDragStart(e)):this.$emit("contextmenu",e)},onDragStart(e){this.disabled||(this.dragging=!0,this.draggingHTML=this.$slots.default?.()?.el?.outerHTML,e.value=this.value,e.dataTransfer&&(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/json",JSON.stringify(this.value))),this.cancelTouchDragStart(),this.$emit("drag",e))},onDragEnd(e){this.disabled||(this.reset(),this.$emit("dragend",e))},onTouchStart(e){if(this.disabled)return;const t=e.touches?.[0];t&&(this.touchStart=[t.clientX,t.clientY],this.cancelTouchDragStart(),this.touchDragStartTimer=setTimeout((()=>{this.onDragStart(e)}),this.touchDragStartThreshold))},onTouchMove(e){if(this.disabled)return;const t=e.touches?.[0];if(!t||!this.touchStart)return;if(this.touchDragStartTimer){const n=Math.hypot(t.clientX-this.touchStart[0],t.clientY-this.touchStart[1]);if(n>this.touchDragMoveCancelDistance)return void this.reset();this.onDragStart(e)}e.preventDefault();const{clientX:n,clientY:a}=t;this.left=n,this.top=a,this.left=n-this.touchStart[0],this.top=a-this.touchStart[1],this.touchScroll(e);let i=document.elementsFromPoint(n,a).filter((e=>e.dataset?.droppable&&!e.classList.contains("dragged")))?.[0];i?(this.dispatchEvent("dragenter",i),this.touchOverElement=i):this.touchOverElement=null},touchScroll(e){if(this.disabled)return;const t=this.getScrollableParent();if(!t)return;const n=e.touches?.[0];if(!n)return;const{clientX:a,clientY:i}=n,s=t.getBoundingClientRect(),o=[(a-s.left)/s.width,(i-s.top)/s.height],r=[0,0];o[0]<0?r[0]=-1:o[0]>1&&(r[0]=1),o[1]<0?r[1]=-1:o[1]>1&&(r[1]=1),this.handleTouchScroll(r,t)},onTouchEnd(e){if(this.disabled)return;const t=this.touchOverElement;t&&this.dispatchEvent("drop",t),this.onDragEnd(e)},handleTouchScroll(e,t){this.touchScrollDirection=e,e[0]||e[1]?this.touchScrollTimer||(this.touchScrollTimer=setInterval((()=>{if(!t)return;const[n,a]=e;t.scrollBy(n*this.touchScrollSpeed,a*this.touchScrollSpeed)}),1e3/60)):this.cancelScroll()},getScrollableParent(){let e=this.element?.parentElement;while(e){if(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth){const t=window.getComputedStyle(e);if(["scroll","auto"].includes(t.overflowY)||["scroll","auto"].includes(t.overflowX))return e}e=e.parentElement}return null},dispatchEvent(e,t){t.dispatchEvent(new DragEvent(e,{target:{...t,value:this.value}}))},cancelScroll(){this.touchScrollDirection=[0,0],this.touchScrollTimer&&(clearInterval(this.touchScrollTimer),this.touchScrollTimer=null)},cancelTouchDragStart(){this.touchDragStartTimer&&(clearTimeout(this.touchDragStartTimer),this.touchDragStartTimer=null)},reset(){this.cancelTouchDragStart(),this.cancelScroll(),this.dragging=!1,this.touchStart=null,this.touchOverElement=null,this.left=0,this.top=0,this.initialCursorOffset=null},installHandlers(){console.debug("Installing drag handlers on",this.element),this.element?.setAttribute("draggable",!0),Object.entries(this.eventsHandlers).forEach((([e,t])=>{this.element?.addEventListener(e,t)}))},uninstallHandlers(){console.debug("Uninstalling drag handlers from",this.element),this.element?.setAttribute("draggable",!1),Object.entries(this.eventsHandlers).forEach((([e,t])=>{this.element?.removeEventListener(e,t)}))}},watch:{dragging(){this.dragging?(this.element?.classList.add("dragged"),this.$nextTick((()=>{this.touchStart&&(this.initialCursorOffset=[this.element?.offsetLeft-this.touchStart[0],this.element?.offsetTop-this.touchStart[1]])}))):this.element?.classList.remove("dragged")},disabled(e){e?(this.reset(),this.uninstallHandlers()):this.installHandlers()},element(){this.uninstallHandlers(),this.installHandlers()},touchOverElement(e,t){e!==t&&(t&&this.dispatchEvent("dragleave",t),e&&this.dispatchEvent("dragenter",e))}},mounted(){this.installHandlers()},unmounted(){this.uninstallHandlers()}},l=n(6262);const d=(0,l.A)(r,[["render",o],["__scopeId","data-v-dd2759da"]]);var c=d},3118:function(e,t,n){n.d(t,{A:function(){return d}});var a=n(641);const i={class:"droppable"};function s(e,t,n,s,o,r){return(0,a.uX)(),(0,a.CE)("div",i)}var o={emits:["dragenter","dragleave","dragover","drop"],props:{element:{type:Object},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data(){return{eventsHandlers:{dragenter:this.onDragEnter,dragleave:this.onDragLeave,dragover:this.onDragOver,drop:this.onDrop},selected:!1}},methods:{onDragEnter(e){this.disabled||this.selected||(this.selected=!0,this.$emit("dragenter",e))},onDragLeave(e){if(this.disabled||!this.selected)return;const t=this.element.getBoundingClientRect();e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom||(this.selected=!1,this.$emit("dragleave",e))},onDragOver(e){this.disabled||(e.preventDefault(),this.selected=!0,this.$emit("dragover",e))},onDrop(e){this.disabled||(this.selected=!1,this.$emit("drop",e))},installHandlers(){const e=this.element;e&&(console.debug("Installing drop handlers on",this.element),e.dataset&&(e.dataset.droppable=!0),e.addEventListener&&Object.entries(this.eventsHandlers).forEach((([t,n])=>{e.addEventListener(t,n)})))},uninstallHandlers(){const e=this.element;e&&(console.debug("Uninstalling drop handlers from",this.element),e.dataset?.droppable&&delete e.dataset.droppable,e.removeEventListener&&Object.entries(this.eventsHandlers).forEach((([t,n])=>{e.removeEventListener(t,n)})))}},watch:{active(){this.active?this.element?.classList.add("active"):this.element?.classList.remove("active")},disabled:{handler(){this.disabled?this.element?.classList.add("disabled"):this.element?.classList.remove("disabled")}},element:{handler(){this.uninstallHandlers(),this.installHandlers()}},selected:{handler(e,t){e&&!t?this.element?.classList.add("selected"):!e&&t&&this.element?.classList.remove("selected")}}},mounted(){this.$nextTick((()=>{this.installHandlers()}))},unmounted(){this.uninstallHandlers()}},r=n(6262);const l=(0,r.A)(o,[["render",s]]);var d=l},2573:function(e,t,n){n.d(t,{A:function(){return p}});var a=n(641),i=n(33);const s=["href"],o=["src","alt","title"],r=["src","alt","title"];function l(e,t,n,l,d,c){return(0,a.uX)(),(0,a.CE)("div",{class:"extension-icon",style:(0,i.Tr)({width:`${n.size}`,height:`${n.size}`})},[n.withDocsLink?((0,a.uX)(),(0,a.CE)("a",{key:0,href:c.docsUrl,target:"_blank"},[(0,a.Lk)("img",{src:c.iconUrl,alt:c.extensionName,title:c.extensionName},null,8,o)],8,s)):((0,a.uX)(),(0,a.CE)("img",{key:1,src:c.iconUrl,alt:c.extensionName,title:c.extensionName},null,8,r))],4)}var d={props:{name:{type:String,required:!0},size:{type:String,default:"1.75em"},withDocsLink:{type:Boolean,default:!1}},computed:{iconUrl(){return`https://static.platypush.tech/icons/${this.extensionName}-64.png`},extensionType(){return"backend"==this.name.split(".")[0]?"backend":"plugin"},extensionName(){const e=this.name.split(".");return e.length<1?this.name:("backend"==e[0]&&e.shift(),e.join("."))},docsUrl(){return`https://docs.platypush.tech/platypush/${this.extensionType}s/${this.extensionName}.html`}}},c=n(6262);const u=(0,c.A)(d,[["render",l],["__scopeId","data-v-0353c248"]]);var p=u}}]);
//# sourceMappingURL=7329.e544d80e.js.map
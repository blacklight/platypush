(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[9131],{3762:function(){},2544:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(6252),i=n(9963);const l=e=>((0,s.dD)("data-v-0bc64e95"),e=e(),(0,s.Cn)(),e),a=l((()=>(0,s._)("i",{class:"fas fa-clipboard"},null,-1))),o=[a];function r(e,t,n,l,a,r){return(0,s.wg)(),(0,s.iD)("button",{class:"copy-button",ref:"copyButton",title:"Copy to clipboard",onClick:t[0]||(t[0]=(0,i.iM)(((...e)=>r.copy&&r.copy(...e)),["prevent"])),onInput:t[1]||(t[1]=(0,i.iM)(((...e)=>r.copy&&r.copy(...e)),["prevent"]))},o,544)}var c=n(8637),u={name:"CopyButton",emits:["input","click"],mixins:[c.Z],props:{text:{type:String}},methods:{async copy(e){this.text?.length&&await this.copyToClipboard(this.text),this.$emit(e.type,e)}}},g=n(3744);const d=(0,g.Z)(u,[["render",r],["__scopeId","data-v-0bc64e95"]]);var h=d},2126:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(6252),i=n(3577);const l=["href"],a=["src","alt","title"],o=["src","alt","title"];function r(e,t,n,r,c,u){return(0,s.wg)(),(0,s.iD)("div",{class:"extension-icon",style:(0,i.j5)({width:`${n.size}`,height:`${n.size}`})},[n.withDocsLink?((0,s.wg)(),(0,s.iD)("a",{key:0,href:u.docsUrl,target:"_blank"},[(0,s._)("img",{src:u.iconUrl,alt:u.extensionName,title:u.extensionName},null,8,a)],8,l)):((0,s.wg)(),(0,s.iD)("img",{key:1,src:u.iconUrl,alt:u.extensionName,title:u.extensionName},null,8,o))],4)}var c={props:{name:{type:String,required:!0},size:{type:String,default:"1.75em"},withDocsLink:{type:Boolean,default:!1}},computed:{iconUrl(){return`https://static.platypush.tech/icons/${this.extensionName}-64.png`},extensionType(){return"backend"==this.name.split(".")[0]?"backend":"plugin"},extensionName(){const e=this.name.split(".");return e.length<1?this.name:("backend"==e[0]&&e.shift(),e.join("."))},docsUrl(){return`https://docs.platypush.tech/platypush/${this.extensionType}s/${this.extensionName}.html`}}},u=n(3744);const g=(0,u.Z)(c,[["render",r],["__scopeId","data-v-0353c248"]]);var d=g},9131:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return $e}});var s=n(6252),i=n(9963),l=n(3577);const a={class:"row plugin extensions-container"},o={class:"filter-container"},r=["disabled"],c={class:"items"},u={key:0,class:"extension"},g=["data-name","onClick"],d={class:"name"},h={key:0,class:"enabled icon",title:"Enabled"},p={key:0,class:"enabled icon fas fa-circle-check"},f={key:0,class:"extension-body-container until tablet"},m={key:0,class:"extension-body-container from desktop"};function x(e,t,n,x,b,k){const y=(0,s.up)("Loading"),_=(0,s.up)("ExtensionIcon"),w=(0,s.up)("Extension");return(0,s.wg)(),(0,s.iD)("div",a,[b.loading?((0,s.wg)(),(0,s.j4)(y,{key:0})):(0,s.kq)("",!0),(0,s._)("header",null,[(0,s._)("div",o,[(0,s.wy)((0,s._)("input",{type:"text",ref:"filter",placeholder:"Extension name","onUpdate:modelValue":t[0]||(t[0]=e=>b.filter=e),disabled:b.loading},null,8,r),[[i.nr,b.filter]])])]),(0,s._)("main",null,[(0,s._)("div",c,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.extensionNames,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"extension-container",key:e},[k.matchesFilter(e)?((0,s.wg)(),(0,s.iD)("div",u,[(0,s._)("div",{class:(0,l.C_)(["item",{selected:e===b.selectedExtension}]),"data-name":e,onClick:t=>k.onClick(e,!1)},[(0,s.Wm)(_,{name:e,size:"1.75em"},null,8,["name"]),(0,s._)("span",d,(0,l.zw)(k.extensions[e].name),1),k.enabledExtensions[e]?((0,s.wg)(),(0,s.iD)("span",h,[k.enabledExtensions[e]?((0,s.wg)(),(0,s.iD)("i",p)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)],10,g),b.selectedExtension&&e===b.selectedExtension?((0,s.wg)(),(0,s.iD)("div",f,[(0,s.Wm)(w,{extension:k.extensions[b.selectedExtension],config:k.enabledExtensions[b.selectedExtension],"config-file":b.configFile},null,8,["extension","config","config-file"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])))),128))]),b.selectedExtension?((0,s.wg)(),(0,s.iD)("div",m,[(0,s.Wm)(w,{extension:k.extensions[b.selectedExtension],config:k.enabledExtensions[b.selectedExtension],"config-file":b.configFile},null,8,["extension","config","config-file"])])):(0,s.kq)("",!0)])])}const b=e=>((0,s.dD)("data-v-3fa6b036"),e=e(),(0,s.Cn)(),e),k={class:"extension"},y=b((()=>(0,s._)("span",{class:"from tablet"},"Documentation",-1))),_=b((()=>(0,s._)("span",{class:"from tablet"},"Install",-1))),w=b((()=>(0,s._)("span",{class:"from tablet"},"Configuration",-1))),C={class:"extension-body"};function v(e,t,n,i,l,a){const o=(0,s.up)("Tab"),r=(0,s.up)("Tabs"),c=(0,s.up)("Doc"),u=(0,s.up)("Config"),g=(0,s.up)("Install");return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("header",null,[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(o,{selected:"doc"===l.selectedTab,"icon-class":"fas fa-book",onInput:t[0]||(t[0]=e=>l.selectedTab="doc")},{default:(0,s.w5)((()=>[y])),_:1},8,["selected"]),(0,s.Wm)(o,{selected:"install"===l.selectedTab,"icon-class":"fas fa-download",onInput:t[1]||(t[1]=e=>l.selectedTab="install")},{default:(0,s.w5)((()=>[_])),_:1},8,["selected"]),(0,s.Wm)(o,{selected:"config"===l.selectedTab,"icon-class":"fas fa-square-check",onInput:t[2]||(t[2]=e=>l.selectedTab="config")},{default:(0,s.w5)((()=>[w])),_:1},8,["selected"])])),_:1})]),(0,s._)("div",C,["doc"===l.selectedTab?((0,s.wg)(),(0,s.j4)(c,{key:0,extension:n.extension},null,8,["extension"])):"config"===l.selectedTab?((0,s.wg)(),(0,s.j4)(u,{key:1,extension:n.extension,config:n.config,"config-file":n.configFile},null,8,["extension","config","config-file"])):"install"===l.selectedTab?((0,s.wg)(),(0,s.j4)(g,{key:2,extension:n.extension},null,8,["extension"])):(0,s.kq)("",!0)])])}var D=n(8735),L=n(3176);const E={key:0,class:"config-container current"},$=["innerHTML"],q=["innerHTML"];function j(e,t,n,i,a,o){const r=(0,s.up)("CopyButton");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o.highlightedCurrentConfig?((0,s.wg)(),(0,s.iD)("div",E,[(0,s.Wm)(r,{text:a.curYamlConfig},null,8,["text"]),(0,s._)("pre",null,[(0,s._)("code",{class:"config-snippet",innerHTML:o.highlightedCurrentConfig},null,8,$)])])):(0,s.kq)("",!0),(0,s._)("div",{class:(0,l.C_)(["config-container snippet",{fullscreen:!o.highlightedCurrentConfig}])},[(0,s.Wm)(r,{text:n.extension.config_snippet},null,8,["text"]),(0,s._)("pre",null,[(0,s._)("code",{class:"config-snippet",innerHTML:o.highlightedConfigSnippet},null,8,q)])],2)],64)}n(8783);var I=n(637),T=n(2544),O=n(8637),Z={name:"Extension",mixins:[O.Z],components:{CopyButton:T.Z},props:{extension:{type:Object,required:!0},config:{type:Object},configFile:{type:String}},data(){return{curYamlConfig:null}},computed:{highlightedConfigSnippet(){return I.Z.highlight(`# Configuration template. You can add it to ${this.configFile}\n`+this.extension.config_snippet,{language:"yaml"}).value.trim()},highlightedCurrentConfig(){return this.curYamlConfig?I.Z.highlight("# Currently loaded configuration\n"+this.curYamlConfig,{language:"yaml"}).value.trim():null}},methods:{async loadCurrentConfig(){this.config?this.curYamlConfig=await this.request("utils.to_yaml",{obj:{[this.extension.name]:this.config}}):this.curYamlConfig=null}},mounted(){this.loadCurrentConfig(),this.$watch("config",this.loadCurrentConfig)}},U=n(3744);const W=(0,U.Z)(Z,[["render",j],["__scopeId","data-v-325a3576"]]);var F=W;const N=e=>((0,s.dD)("data-v-49986d05"),e=e(),(0,s.Cn)(),e),H={class:"doc"},R=["href"],z=["textContent"],B=["innerHTML"],M={key:0,class:"actions"},S=N((()=>(0,s._)("h3",null,[(0,s._)("i",{class:"icon fas fa-play"}),(0,s.Uk)("   Actions ")],-1))),Y=["href"],P={key:1,class:"events"},A=N((()=>(0,s._)("h3",null,[(0,s._)("i",{class:"icon fas fa-flag"}),(0,s.Uk)("   Events ")],-1))),K=["href"];function V(e,t,n,i,a,o){const r=(0,s.up)("ExtensionIcon");return(0,s.wg)(),(0,s.iD)("section",H,[(0,s._)("header",null,[(0,s._)("h2",null,[(0,s._)("a",{class:"title",href:n.extension.doc_url,target:"_blank"},[(0,s.Wm)(r,{name:n.extension.name,size:"2em","with-docs-link":""},null,8,["name"]),(0,s._)("span",{class:"name",textContent:(0,l.zw)(n.extension.name)},null,8,z)],8,R)])]),a.doc?((0,s.wg)(),(0,s.iD)("article",{key:0,onClick:t[0]||(t[0]=(...e)=>o.onDocClick&&o.onDocClick(...e))},[(0,s._)("div",{class:"doc-content",innerHTML:a.doc},null,8,B),Object.keys(n.extension.actions||{}).length>0?((0,s.wg)(),(0,s.iD)("div",M,[S,(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.actionNames,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"action",key:e},[(0,s._)("a",{href:`/#execute?action=${n.extension.name}.${e}`},(0,l.zw)(n.extension.name)+"."+(0,l.zw)(e),9,Y)])))),128))])])):(0,s.kq)("",!0),Object.keys(n.extension.events||{}).length>0?((0,s.wg)(),(0,s.iD)("div",P,[A,(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.eventNames,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"event",key:e},[(0,s._)("a",{href:n.extension.events[e].doc_url,target:"_blank"},(0,l.zw)(e),9,K)])))),128))])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])}var J=n(2126),G=n(5250),Q={name:"Doc",mixins:[O.Z],components:{ExtensionIcon:J.Z},props:{extension:{type:Object,required:!0}},data(){return{doc:null,localPageRegex:new RegExp("^/?#.*$")}},computed:{actionNames(){return Object.keys(this.extension.actions).sort()},eventNames(){return Object.keys(this.extension.events).sort()}},methods:{async parseDoc(){return this.extension.doc?.length?await this.request("utils.rst_to_html",{text:this.extension.doc}):null},refreshDoc(){this.parseDoc().then((e=>this.doc=e))},onDocClick(e){if("a"!==e.target.tagName.toLowerCase())return!0;e.preventDefault();const t=e.target.getAttribute("href");if(!t)return!0;if(t.match(this.localPageRegex))return window.location.href=t,!0;const n=t.match(/^https:\/\/docs\.platypush\.tech\/platypush\/(plugins|backend)\/([\w.]+)\.html#?.*$/);if(!n)return e.preventDefault(),window.open(t,"_blank"),!0;let[s,i]=n.slice(1);"backend"===s&&(i=`backend.${i}`),G.$.emit("update:extension",i),e.preventDefault()}},mounted(){this.refreshDoc(),this.$watch("extension.doc",this.refreshDoc)}};const X=(0,U.Z)(Q,[["render",V],["__scopeId","data-v-49986d05"]]);var ee=X;const te=e=>((0,s.dD)("data-v-973683d8"),e=e(),(0,s.Cn)(),e),ne={class:"install-container"},se={class:"top"},ie=te((()=>(0,s._)("header",null,[(0,s._)("h2",null,"Dependencies")],-1))),le={class:"body"},ae={class:"container install-cmd-container"},oe=["innerHTML"],re={key:0,class:"buttons install-btn"},ce=["disabled"],ue=te((()=>(0,s._)("i",{class:"fas fa-download"},null,-1))),ge={key:0,class:"bottom"},de=te((()=>(0,s._)("header",null,[(0,s._)("h2",null,"Output")],-1))),he={class:"body"},pe={class:"container install-output",ref:"installOutput"},fe=["textContent"],me={key:0,class:"loading-container"};function xe(e,t,n,i,a,o){const r=(0,s.up)("CopyButton"),c=(0,s.up)("Loading"),u=(0,s.up)("RestartButton");return(0,s.wg)(),(0,s.iD)("div",ne,[(0,s._)("section",se,[ie,(0,s._)("div",le,[(0,s._)("div",ae,[o.installCmd?((0,s.wg)(),(0,s.j4)(r,{key:0,text:o.installCmd},null,8,["text"])):(0,s.kq)("",!0),(0,s._)("pre",null,[a.loading?((0,s.wg)(),(0,s.j4)(c,{key:0})):((0,s.wg)(),(0,s.iD)("code",{key:1,innerHTML:o.highlightedInstallCmd},null,8,oe))])]),o.installCmd?((0,s.wg)(),(0,s.iD)("div",re,[a.installDone?((0,s.wg)(),(0,s.j4)(u,{key:0})):(0,s.kq)("",!0),(0,s._)("button",{type:"button",class:"btn btn-default",disabled:a.installRunning,onClick:t[0]||(t[0]=(...e)=>o.installExtension&&o.installExtension(...e))},[ue,(0,s.Uk)(" Install ")],8,ce)])):(0,s.kq)("",!0)])]),a.installRunning||a.installOutput?((0,s.wg)(),(0,s.iD)("section",ge,[de,(0,s._)("div",he,[(0,s._)("div",pe,[(0,s.Wm)(r,{text:a.installOutput},null,8,["text"]),(0,s._)("pre",null,[(0,s._)("code",{textContent:(0,l.zw)(a.installOutput)},null,8,fe),a.installRunning?((0,s.wg)(),(0,s.iD)("div",me,[(0,s.Uk)("\n            "),(0,s.Wm)(c),(0,s.Uk)("\n          ")])):(0,s.kq)("",!0)])],512)])])):(0,s.kq)("",!0)])}n(3762);var be=n(6791),ke=n(2717),ye={name:"Install",mixins:[O.Z],emit:["install-start","install-end"],components:{CopyButton:T.Z,Loading:be.Z,RestartButton:ke.Z},props:{extension:{type:Object,required:!0}},data(){return{installRunning:!1,installDone:!1,installOutput:null,installCmds:[],pendingCommands:0,error:null,loading:!1}},computed:{installCmd(){return this.installCmds.length?this.installCmds.join("\n").trim():null},highlightedInstallCmd(){return I.Z.highlight(this.installCmd?this.installCmds.map((e=>`$ ${e}`)).join("\n").trim():"# No extra installation steps required",{language:"bash"}).value}},methods:{wsProcess(e){try{const t="https:"===window.location.protocol?"wss":"ws",n=`${t}://${location.host}${e}`,s=new WebSocket(n);s.onmessage=this.onMessage,s.onerror=this.onError,s.onclose=this.onClose}catch(t){this.notify({error:!0,title:"Websocket initialization error",text:t.toString()}),console.error("Websocket initialization error"),console.error(t),this.error=t,this.installRunning=!1}},onMessage(e){this.installOutput||(this.installOutput=""),this.installOutput+=e.data},onClose(){this.installRunning=!1,this.$emit("install-end",this.extension),this.error||(this.installDone=!0),this.notify({title:"Extension installed",html:`Extension <b>${this.extension.name}</b> installed successfully`,image:{iconClass:"fas fa-check"}})},onError(e){this.notify({error:!0,title:"Websocket error",text:e.toString()}),console.error("Websocket error"),console.error(e),this.error=e,this.installRunning=!1},installExtension(){if(!this.installCmd)return;this.error=null,this.installRunning=!0,this.installOutput="",this.$emit("install-start",this.extension);const e=this.installCmds.join(";\n");this.request("shell.exec",{cmd:e,ws:!0}).then((e=>{this.wsProcess(e.ws_path)})).catch((e=>{this.error=e,this.installRunning=!1,this.$emit("install-end",this.extension)}))},async refreshInstallCmds(){this.loading=!0;try{this.installCmds=await this.request("application.get_install_commands",{extension:this.extension.name})}finally{this.loading=!1}}},mounted(){this.refreshInstallCmds(),this.$watch("extension.name",(()=>{this.refreshInstallCmds()})),this.$watch("installOutput",(()=>{this.$nextTick((()=>{this.$refs.installOutput.focus(),this.$refs.installOutput.scrollTop=this.$refs.installOutput.scrollHeight}))}))}};const _e=(0,U.Z)(ye,[["render",xe],["__scopeId","data-v-973683d8"]]);var we=_e,Ce={name:"Extension",components:{Config:F,Doc:ee,Install:we,Tab:D.Z,Tabs:L.Z},props:{extension:{type:Object,required:!0},config:{type:Object},configFile:{type:String}},data(){return{selectedTab:"doc"}}};const ve=(0,U.Z)(Ce,[["render",v],["__scopeId","data-v-3fa6b036"]]);var De=ve,Le={name:"Extensions",mixins:[O.Z],components:{Extension:De,ExtensionIcon:J.Z,Loading:be.Z},data(){return{loading:!1,plugins:{},backends:{},enabledPlugins:{},enabledBackends:{},filter:"",selectedExtension:null,configFile:null,config:{}}},computed:{extensions(){const e={};return Object.entries(this.plugins).forEach((([t,n])=>{e[t]={...n,name:t}})),Object.entries(this.backends).forEach((([t,n])=>{t=`backend.${t}`,e[t]={...n,name:t}})),e},enabledExtensions(){return[this.enabledPlugins,this.enabledBackends].reduce(((e,t)=>(Object.entries(t).forEach((([t,n])=>{e[t]=n})),e)),{})},extensionNames(){return Object.keys(this.extensions).sort()}},methods:{onClick(e,t=!0,n=!0){this.selectedExtension===e?this.selectedExtension=null:this.onInput(e,t,n)},onInput(e,t=!0,n=!0){t&&(this.filter=e);const s=e?.toLowerCase()?.trim();if(s?.length&&this.extensions[s]){this.selectedExtension=s,n&&this.setUrlArgs({extension:s});const e=this.$el.querySelector(`.extensions-container .item[data-name="${s}"]`);e&&e.scrollIntoView({behavior:"smooth"})}else this.selectedExtension=null,n&&this.setUrlArgs({})},matchesFilter(e){return!this.filter||e.includes(this.filter.toLowerCase())},async loadExtensions(){this.loading=!0;let[e,t]=[[],[]];try{[this.plugins,this.backends,e,t,this.config]=await Promise.all([this.request("inspect.get_all_plugins"),this.request("inspect.get_all_backends"),this.request("inspect.get_enabled_plugins"),this.request("inspect.get_enabled_backends"),this.request("inspect.get_config")])}finally{this.loading=!1}this.enabledPlugins=e.reduce(((e,t)=>(e[t]=this.config[t]||{},e)),{}),this.enabledBackends=t.reduce(((e,t)=>(t=`backend.${t}`,e[t]=this.config[t]||{},e)),{}),this.loadExtensionFromUrl(),this.$watch("$route.hash",(()=>this.loadExtensionFromUrl()))},async loadConfigFile(){this.configFile=await this.request("config.get_config_file")},loadExtensionFromUrl(){const e=this.getUrlArgs().extension;e&&this.$nextTick((()=>this.onInput(e,!1,!1)))}},mounted(){this.loadConfigFile(),this.loadExtensions(),G.$.on("update:extension",(e=>this.onInput(e,!1))),this.$nextTick((()=>this.$refs.filter.focus()))}};const Ee=(0,U.Z)(Le,[["render",x],["__scopeId","data-v-74d75ec7"]]);var $e=Ee},4712:function(e,t,n){var s=n(3390);s.registerLanguage("xml",n(4610)),s.registerLanguage("bash",n(8780)),s.registerLanguage("c",n(612)),s.registerLanguage("cpp",n(6248)),s.registerLanguage("csharp",n(3707)),s.registerLanguage("css",n(5064)),s.registerLanguage("markdown",n(2003)),s.registerLanguage("diff",n(7731)),s.registerLanguage("ruby",n(7905)),s.registerLanguage("go",n(2399)),s.registerLanguage("graphql",n(1738)),s.registerLanguage("ini",n(4762)),s.registerLanguage("java",n(8257)),s.registerLanguage("javascript",n(978)),s.registerLanguage("json",n(14)),s.registerLanguage("kotlin",n(5812)),s.registerLanguage("less",n(4210)),s.registerLanguage("lua",n(4981)),s.registerLanguage("makefile",n(7903)),s.registerLanguage("perl",n(2482)),s.registerLanguage("objectivec",n(2446)),s.registerLanguage("php",n(2656)),s.registerLanguage("php-template",n(5112)),s.registerLanguage("plaintext",n(2437)),s.registerLanguage("python",n(8245)),s.registerLanguage("python-repl",n(3722)),s.registerLanguage("r",n(4730)),s.registerLanguage("rust",n(9880)),s.registerLanguage("scss",n(1062)),s.registerLanguage("shell",n(7874)),s.registerLanguage("sql",n(8935)),s.registerLanguage("swift",n(7690)),s.registerLanguage("yaml",n(1392)),s.registerLanguage("typescript",n(8987)),s.registerLanguage("vbnet",n(7531)),s.registerLanguage("wasm",n(1533)),s.HighlightJS=s,s.default=s,e.exports=s},8783:function(e,t,n){"use strict";n(4712)}}]);
//# sourceMappingURL=9131.f8dd140b.js.map
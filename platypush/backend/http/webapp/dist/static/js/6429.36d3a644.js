"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[6429],{1065:function(e,t,s){s.d(t,{Z:function(){return r}});s(560);var n=s(8637),a={name:"Utils",mixins:[n.Z],computed:{audioExtensions(){return new Set(["3gp","aa","aac","aax","act","aiff","amr","ape","au","awb","dct","dss","dvf","flac","gsm","iklax","ivs","m4a","m4b","m4p","mmf","mp3","mpc","msv","nmf","nsf","ogg,","opus","ra,","raw","sln","tta","vox","wav","wma","wv","webm","8svx"])},videoExtensions(){return new Set(["webm","mkv","flv","flv","vob","ogv","ogg","drc","gif","gifv","mng","avi","mts","m2ts","mov","qt","wmv","yuv","rm","rmvb","asf","amv","mp4","m4p","m4v","mpg","mp2","mpeg","mpe","mpv","mpg","mpeg","m2v","m4v","svi","3gp","3g2","mxf","roq","nsv","flv","f4v","f4p","f4a","f4b"])},mediaExtensions(){return new Set([...this.videoExtensions,...this.audioExtensions])}},methods:{convertTime(e){e=parseFloat(e);const t={};t.h=""+parseInt(e/3600),t.m=""+parseInt(e/60-60*t.h),t.s=""+parseInt(e-(3600*t.h+60*t.m));for(const n of["m","s"])parseInt(t[n])<10&&(t[n]="0"+t[n]);const s=[];return parseInt(t.h)&&s.push(t.h),s.push(t.m,t.s),s.join(":")},async startStreaming(e,t,s=!1){let n=e,a=null;e instanceof Object?(n=e.url,a=e.subtitles):e={url:n};const l=await this.request(`${t}.start_streaming`,{media:n,subtitles:a,download:s});return{...e,...l}},async stopStreaming(e,t){await this.request(`${t}.stop_streaming`,{media_id:e})}}};const l=a;var r=l},4904:function(e,t,s){s.d(t,{Z:function(){return y}});var n=s(6252),a=s(9963),l=s(3577);const r={class:"dropdown-container"},i=["title"],o=["textContent"],d={class:"body-container hidden",ref:"dropdownContainer"};function c(e,t,s,c,u,p){const f=(0,n.up)("DropdownBody");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("button",{title:s.title,ref:"button",onClick:t[0]||(t[0]=(0,a.iM)((e=>p.toggle(e)),["stop"]))},[s.iconClass?((0,n.wg)(),(0,n.iD)("i",{key:0,class:(0,l.C_)(["icon",s.iconClass])},null,2)):(0,n.kq)("",!0),s.text?((0,n.wg)(),(0,n.iD)("span",{key:1,class:"text",textContent:(0,l.zw)(s.text)},null,8,o)):(0,n.kq)("",!0)],8,i),(0,n._)("div",d,[(0,n.Wm)(f,{id:s.id,keepOpenOnItemClick:s.keepOpenOnItemClick,ref:"dropdown",onClick:p.onClick},{default:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","keepOpenOnItemClick","onClick"])],512)])}const u=["id"];function p(e,t,s,a,l,r){return(0,n.wg)(),(0,n.iD)("div",{class:"dropdown",id:s.id,onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[(0,n.WI)(e.$slots,"default",{},void 0,!0)],8,u)}var f={emits:["click"],props:{id:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1}}},h=s(3744);const v=(0,h.Z)(f,[["render",p],["__scopeId","data-v-14579c63"]]);var m=v,w=s(5250),g={components:{DropdownBody:m},emits:["click"],props:{id:{type:String},iconClass:{default:"fa fa-ellipsis-h"},text:{type:String},title:{type:String},keepOpenOnItemClick:{type:Boolean,default:!1}},data(){return{visible:!1}},computed:{buttonStyle(){return this.$refs.button?getComputedStyle(this.$refs.button):{}},buttonWidth(){return parseFloat(this.buttonStyle.width||0)},buttonHeight(){return parseFloat(this.buttonStyle.height||0)}},methods:{documentClickHndl(e){if(!this.visible)return;let t=e.target;while(t){if(t.classList.contains("dropdown"))return;t=t.parentElement}this.close()},getDropdownWidth(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).width):0},getDropdownHeight(){const e=this.$refs.dropdown?.$el;return e?parseFloat(getComputedStyle(e).height):0},onClick(e){return this.keepOpenOnItemClick||this.close(),"A"===e.target.tagName?(e.preventDefault(),!1):e.defaultPrevented?(e.stopPropagation(),!1):void 0},close(){this.visible=!1,document.removeEventListener("click",this.documentClickHndl),w.$.emit("dropdown-close")},open(){document.addEventListener("click",this.documentClickHndl);const e=this.$refs.dropdown?.$el;e.parentElement||this.$el.appendChild(e),this.visible=!0,this.$refs.dropdownContainer.classList.remove("hidden"),this.$nextTick((()=>{const e=this.$refs.button.getBoundingClientRect(),t={left:e.left+window.scrollX,top:e.top+window.scrollY},s={left:t.left,top:t.top+this.buttonHeight},n=this.getDropdownWidth(),a=this.getDropdownHeight();s.left+n>(window.innerWidth+window.scrollX)/2&&(s.left-=n-this.buttonWidth),s.top+a>(window.innerHeight+window.scrollY)/2&&(s.top-=a+this.buttonHeight-10);const l=this.$refs.dropdown.$el;l.classList.add("fade-in"),l.style.top=`${s.top}px`,l.style.left=`${s.left}px`,w.$.emit("dropdown-open",this.$refs.dropdown),this.$refs.dropdownContainer.classList.add("hidden")}))},toggle(e){e.stopPropagation(),this.$emit("click"),this.visible?this.close():this.open()},onKeyUp(e){e.stopPropagation(),"Escape"===e.key&&this.close()}},mounted(){document.body.addEventListener("keyup",this.onKeyUp)},unmounted(){document.body.removeEventListener("keyup",this.onKeyUp)}};const _=(0,h.Z)(g,[["render",c],["__scopeId","data-v-f096e0a0"]]);var y=_},7597:function(e,t,s){s.d(t,{Z:function(){return h}});var n=s(6252),a=s(3577);const l=["title"],r={key:0,class:"col-2 icon"},i=["textContent"];function o(e,t,s,o,d,c){const u=(0,n.up)("Icon");return(0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["row item",{...c.itemClass_,disabled:s.disabled}]),title:s.hoverText,onClick:t[0]||(t[0]=(...e)=>c.clicked&&c.clicked(...e))},[s.iconClass?.length||s.iconUrl?.length?((0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(u,{class:(0,a.C_)(s.iconClass),url:s.iconUrl},null,8,["class","url"])])):(0,n.kq)("",!0),(0,n._)("div",{class:(0,a.C_)(["text",{"col-10":null!=s.iconClass}]),textContent:(0,a.zw)(s.text)},null,10,i)],10,l)}var d=s(657),c=s(5250),u={components:{Icon:d.Z},emits:["click","input"],props:{iconClass:{type:String},iconUrl:{type:String},text:{type:String},hoverText:{type:String,default:null},disabled:{type:Boolean,default:!1},itemClass:{}},computed:{itemClass_(){return"string"===typeof this.itemClass?{[this.itemClass]:!0}:this.itemClass}},methods:{clicked(e){if(this.$parent.keepOpenOnItemClick||c.$.emit("dropdown-close"),this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.$emit("input",e)}}},p=s(3744);const f=(0,p.Z)(u,[["render",o],["__scopeId","data-v-2babe09c"]]);var h=f},657:function(e,t,s){s.d(t,{Z:function(){return u}});var n=s(6252),a=s(3577);const l={class:"icon-container"},r=["src","alt"];function i(e,t,s,i,o,d){return(0,n.wg)(),(0,n.iD)("div",l,[s.url?.length?((0,n.wg)(),(0,n.iD)("img",{key:0,class:"icon",src:s.url,alt:s.alt},null,8,r)):d.className?.length?((0,n.wg)(),(0,n.iD)("i",{key:1,class:(0,a.C_)(["icon",d.className]),style:(0,a.j5)({color:s.color})},null,6)):(0,n.kq)("",!0)])}var o={props:{class:{type:String},url:{type:String},color:{type:String,default:""},alt:{type:String,default:""}},computed:{className(){return this.class}}},d=s(3744);const c=(0,d.Z)(o,[["render",i],["__scopeId","data-v-706a3bd1"]]);var u=c},6429:function(e,t,s){s.d(t,{Z:function(){return st}});var n=s(6252),a=s(3577);const l={class:"torrent-container"},r={class:"nav-container"};function i(e,t,s,i,o,d){const c=(0,n.up)("Info"),u=(0,n.up)("Modal"),p=(0,n.up)("Header"),f=(0,n.up)("Transfers"),h=(0,n.up)("Results"),v=(0,n.up)("Nav");return(0,n.wg)(),(0,n.iD)("div",l,[d.infoItem?((0,n.wg)(),(0,n.j4)(u,{key:0,title:"Torrent info",visible:null!==d.infoItem,onClose:t[0]||(t[0]=e=>o.infoIndex=null)},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{torrent:d.infoItem},null,8,["torrent"])])),_:1},8,["visible"])):(0,n.kq)("",!0),(0,n._)("div",{class:(0,a.C_)(["header-container",{"with-nav":!o.navCollapsed}])},[(0,n.Wm)(p,{"with-nav":!o.navCollapsed,"selected-view":o.selectedView,loading:o.loading,onSearch:t[1]||(t[1]=e=>d.search(e)),onTorrentAdd:t[2]||(t[2]=e=>d.download(e)),onToggle:t[3]||(t[3]=e=>o.navCollapsed=!o.navCollapsed)},null,8,["with-nav","selected-view","loading"])],2),(0,n._)("main",null,[(0,n._)("div",{class:(0,a.C_)(["view-container",{"with-nav":!o.navCollapsed}])},["transfers"===o.selectedView?((0,n.wg)(),(0,n.j4)(f,{key:0,transfers:o.transfers,onPause:t[4]||(t[4]=e=>d.pause(e)),onResume:t[5]||(t[5]=e=>d.resume(e)),onRemove:t[6]||(t[6]=e=>d.remove(e))},null,8,["transfers"])):"search"===o.selectedView?((0,n.wg)(),(0,n.j4)(h,{key:1,results:o.results,onDownload:t[7]||(t[7]=e=>d.download(e)),onInfo:t[8]||(t[8]=e=>o.infoIndex=e),onNextPage:t[9]||(t[9]=e=>d.search(o.query,o.page+1))},null,8,["results"])):(0,n.kq)("",!0)],2),(0,n._)("div",r,[o.navCollapsed?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(v,{key:0,"selected-view":o.selectedView,onToggle:t[10]||(t[10]=e=>o.navCollapsed=!o.navCollapsed),onInput:t[11]||(t[11]=e=>o.selectedView=e)},null,8,["selected-view"]))])])])}const o=e=>((0,n.dD)("data-v-8eed74b0"),e=e(),(0,n.Cn)(),e),d={class:"info"},c={class:"row"},u=o((()=>(0,n._)("div",{class:"label"},"Title",-1))),p={class:"value"},f={class:"row"},h=o((()=>(0,n._)("div",{class:"label"},"URL",-1))),v={class:"value"},m=o((()=>(0,n._)("i",{class:"fas fa-up-right-from-square"},null,-1))),w=[m],g=o((()=>(0,n._)("i",{class:"fas fa-clipboard"},null,-1))),_=[g],y={class:"row"},b=o((()=>(0,n._)("div",{class:"label"},"Size",-1))),C={class:"value"},k={class:"row"},I=o((()=>(0,n._)("div",{class:"label"},"Seeders",-1))),x={class:"value"},D={class:"row"},T=o((()=>(0,n._)("div",{class:"label"},"Leechers",-1))),$={class:"value"},S={class:"row"},q=o((()=>(0,n._)("div",{class:"label"},"Uploaded",-1))),z={class:"value"},Z={key:0,class:"row"},N=o((()=>(0,n._)("div",{class:"label"},"Description",-1))),U={class:"value"},L={key:1,class:"row"},E=o((()=>(0,n._)("div",{class:"label"},"Year",-1))),R={class:"value"};function O(e,t,s,l,r,i){return(0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",c,[u,(0,n._)("div",p,(0,a.zw)(s.torrent.title),1)]),(0,n._)("div",f,[h,(0,n._)("div",v,[(0,n._)("button",{title:"Open",onClick:t[0]||(t[0]=e=>i.openInNewTab(s.torrent.url))},w),(0,n._)("button",{title:"Copy",onClick:t[1]||(t[1]=t=>e.copyToClipboard(s.torrent.url))},_)])]),(0,n._)("div",y,[b,(0,n._)("div",C,(0,a.zw)(e.convertSize(s.torrent.size)),1)]),(0,n._)("div",k,[I,(0,n._)("div",x,(0,a.zw)(s.torrent.seeds),1)]),(0,n._)("div",D,[T,(0,n._)("div",$,(0,a.zw)(s.torrent.peers),1)]),(0,n._)("div",S,[q,(0,n._)("div",z,(0,a.zw)(e.formatDate(s.torrent.created_at,!0)),1)]),s.torrent.description?((0,n.wg)(),(0,n.iD)("div",Z,[N,(0,n._)("div",U,(0,a.zw)(s.torrent.description),1)])):(0,n.kq)("",!0),s.torrent.year?((0,n.wg)(),(0,n.iD)("div",L,[E,(0,n._)("div",R,(0,a.zw)(s.torrent.year),1)])):(0,n.kq)("",!0)])}var V=s(8637),W={mixins:[V.Z],props:{torrent:{type:Object,default:()=>({})}},methods:{openInNewTab(e){window.open(e,"_blank")}}},H=s(3744);const j=(0,H.Z)(W,[["render",O],["__scopeId","data-v-8eed74b0"]]);var P=j,F=s(9963);const B=e=>((0,n.dD)("data-v-0ae4cd8d"),e=e(),(0,n.Cn)(),e),M={class:"row"},K={class:"search-box"},Y=["disabled","placeholder"],A=["placeholder","value"],Q={class:"button-container"},X={key:0,type:"submit",title:"Loading",disabled:""},G={key:1,type:"submit",title:"Add torrent URL"},J=B((()=>(0,n._)("i",{class:"fa fa-download"},null,-1))),ee=[J],te={key:2,type:"submit",title:"Search"},se=B((()=>(0,n._)("i",{class:"fa fa-search"},null,-1))),ne=[se],ae={key:0,class:"right side col-1"},le=B((()=>(0,n._)("i",{class:"fa fa-bars"},null,-1))),re=[le];function ie(e,t,s,l,r,i){const o=(0,n.up)("Loading");return(0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["header",{"with-nav":s.withNav}])},[(0,n._)("div",M,[(0,n._)("div",{class:(0,a.C_)(["left side",i.leftSideClasses])},[(0,n._)("form",{onSubmit:t[1]||(t[1]=(0,F.iM)(((...e)=>i.submit&&i.submit(...e)),["prevent"]))},[(0,n._)("label",K,["transfers"===s.selectedView?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:0,type:"search",disabled:s.loading,placeholder:i.placeholder,"onUpdate:modelValue":t[0]||(t[0]=e=>r.torrentURL=e)},null,8,Y)),[[F.nr,r.torrentURL]]):"search"===s.selectedView?((0,n.wg)(),(0,n.iD)("input",{key:1,type:"search",placeholder:i.placeholder,value:s.query,ref:"search"},null,8,A)):(0,n.kq)("",!0)]),(0,n._)("span",Q,[s.loading?((0,n.wg)(),(0,n.iD)("button",X,[(0,n.Wm)(o)])):"transfers"===s.selectedView?((0,n.wg)(),(0,n.iD)("button",G,ee)):"search"===s.selectedView?((0,n.wg)(),(0,n.iD)("button",te,ne)):(0,n.kq)("",!0)])],32)],2),s.withNav?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",ae,[(0,n._)("button",{onClick:t[2]||(t[2]=t=>e.$emit("toggle")),title:"Toggle navigation"},re)]))])],2)}var oe=s(6791),de={name:"Header",emits:["torrent-add","search","toggle"],components:{Loading:oe.Z},props:{query:{type:String,default:""},loading:{type:Boolean,default:!1},withNav:{type:Boolean,default:!1},selectedView:{type:String,default:"transfers"}},data(){return{torrentURL:""}},computed:{placeholder(){return"transfers"===this.selectedView?"Add torrent URL":"Search torrents"},leftSideClasses(){return this.withNav?{"col-11":!0}:{"col-12":!0}}},methods:{submit(){const e=this.$refs?.search?.value?.trim();"transfers"===this.selectedView&&this.torrentURL?.length?this.$emit("torrent-add",this.torrentURL):"search"===this.selectedView&&e?.length&&this.$emit("search",e)}}};const ce=(0,H.Z)(de,[["render",ie],["__scopeId","data-v-0ae4cd8d"]]);var ue=ce,pe=s(5166);const fe=e=>((0,n.dD)("data-v-5185ff00"),e=e(),(0,n.Cn)(),e),he=fe((()=>(0,n._)("i",{class:"fa fa-bars"},null,-1))),ve=[he],me=["title","onClick"];function we(e,t,s,l,r,i){return(0,n.wg)(),(0,n.iD)("nav",null,[(0,n._)("button",{class:"menu-button",onClick:t[0]||(t[0]=t=>e.$emit("toggle"))},ve),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.views,((t,l)=>((0,n.wg)(),(0,n.iD)("li",{key:l,title:t.displayName,class:(0,a.C_)({selected:l===s.selectedView}),onClick:t=>e.$emit("input",l)},[(0,n._)("i",{class:(0,a.C_)(t.iconClass)},null,2)],10,me)))),128))])}var ge={emits:["input","toggle"],props:{selectedView:{type:String},collapsed:{type:Boolean,default:!1},views:{type:Object,default:()=>({search:{displayName:"Search",iconClass:"fa fa-search"},transfers:{displayName:"Transfers",iconClass:"fa fa-download"}})}}};const _e=(0,H.Z)(ge,[["render",we],["__scopeId","data-v-5185ff00"]]);var ye=_e;const be=e=>((0,n.dD)("data-v-52a230bc"),e=e(),(0,n.Cn)(),e),Ce={class:"results-container"},ke={key:0,class:"no-content"},Ie={class:"info"},xe={class:"title"},De={class:"additional-info"},Te={class:"info-pill size"},$e=be((()=>(0,n._)("span",{class:"label"},[(0,n._)("i",{class:"fa fa-hdd"})],-1))),Se=be((()=>(0,n._)("span",{class:"separator"},null,-1))),qe={class:"value"},ze=be((()=>(0,n._)("span",{class:"separator"}," | ",-1))),Ze={class:"info-pill seeds"},Ne=be((()=>(0,n._)("span",{class:"label"},[(0,n._)("i",{class:"fa fa-users"})],-1))),Ue=be((()=>(0,n._)("span",{class:"separator"},null,-1))),Le={class:"value"},Ee=be((()=>(0,n._)("span",{class:"separator"}," | ",-1))),Re={class:"info-pill created-at"},Oe=be((()=>(0,n._)("span",{class:"label"},[(0,n._)("i",{class:"fa fa-calendar"})],-1))),Ve=be((()=>(0,n._)("span",{class:"separator"},null,-1))),We={class:"value"},He=be((()=>(0,n._)("span",{class:"separator"}," | ",-1))),je={class:"actions"},Pe=["onClick"],Fe=be((()=>(0,n._)("i",{class:"fa fa-info-circle"},null,-1))),Be=[Fe],Me=["onClick"],Ke=be((()=>(0,n._)("i",{class:"fa fa-download"},null,-1))),Ye=[Ke];function Ae(e,t,s,l,r,i){return(0,n.wg)(),(0,n.iD)("div",Ce,[s.results?.length?((0,n.wg)(),(0,n.iD)("div",{key:1,class:"results",ref:"body",onScroll:t[0]||(t[0]=(...e)=>i.onScroll&&i.onScroll(...e))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.results,((t,s)=>((0,n.wg)(),(0,n.iD)("div",{class:"result",key:s},[(0,n._)("div",Ie,[(0,n._)("div",xe,(0,a.zw)(t.title),1),(0,n._)("div",De,[(0,n._)("span",Te,[$e,Se,(0,n._)("span",qe,(0,a.zw)(e.convertSize(t.size)),1)]),ze,(0,n._)("span",Ze,[Ne,Ue,(0,n._)("span",Le,(0,a.zw)(t.seeds),1)]),Ee,(0,n._)("span",Re,[Oe,Ve,(0,n._)("span",We,(0,a.zw)(e.formatDate(t.created_at,!0)),1)]),He])]),(0,n._)("div",je,[(0,n._)("button",{title:"Torrent info",onClick:t=>e.$emit("info",s)},Be,8,Pe),(0,n._)("button",{title:"Download",onClick:s=>e.$emit("download",t.url)},Ye,8,Me)])])))),128))],544)):((0,n.wg)(),(0,n.iD)("div",ke,"No results"))])}var Qe={emits:["download","info","next-page"],mixins:[V.Z],props:{results:{type:Array,default:()=>[]},page:{type:Number,default:1}},data(){return{scrollTimeout:null}},methods:{onScroll(){const e=this.$refs.body.scrollTop,t=parseFloat(getComputedStyle(this.$refs.body).height),s=this.$refs.body.scrollHeight;if(e>=s-t-5){if(this.scrollTimeout||!this.results.length)return;this.scrollTimeout=setTimeout((()=>{this.scrollTimeout=null}),250),this.$emit("next-page",this.page+1)}}}};const Xe=(0,H.Z)(Qe,[["render",Ae],["__scopeId","data-v-52a230bc"]]);var Ge=Xe,Je=s(8),et={mixins:[V.Z],components:{Info:P,Header:ue,Modal:pe.Z,Nav:ye,Results:Ge,Transfers:Je.Z},props:{pluginName:{type:String,required:!0}},data(){return{loading:!1,transfers:{},results:[],selectedView:"transfers",navCollapsed:!1,query:"",page:1,infoIndex:null}},computed:{infoItem(){return null===this.infoIndex?null:this.results[this.infoIndex]}},methods:{torrentId(e){return e?.hash&&e.hash.length?e.hash:e.url},onTorrentUpdate(e){this.transfers[this.torrentId(e)]=e},onTorrentQueued(e){this.onTorrentUpdate(e),this.notify({text:"Torrent queued for download",image:{icon:"hourglass-start"}})},onTorrentStart(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download started: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentResume(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download resumed: <b>${e.name}</b>`,image:{icon:"play"}})},onTorrentPause(e){this.onTorrentUpdate(e),this.notify({html:`Torrent download paused: <b>${e.name}</b>`,image:{icon:"pause"}})},onTorrentCompleted(e){this.onTorrentUpdate(e),this.transfers[this.torrentId(e)].finish_date=(new Date).toISOString(),this.transfers[this.torrentId(e)].progress=100,this.notify({html:`Torrent download completed: <b>${e.name}</b>`,image:{icon:"check"}})},onTorrentRemove(e){const t=this.torrentId(e);t in this.transfers&&delete this.transfers[t]},async search(e,t=1){this.loading=!0,this.query=e;let s=[];try{s=await this.request(`${this.pluginName}.search`,{query:e,page:t})}finally{this.loading=!1}this.results=1===t?s:this.results.concat(s),s.length>0&&(this.page=t)},async download(e){await this.request(`${this.pluginName}.download`,{torrent:e})},async pause(e){await this.request(`${this.pluginName}.pause`,{torrent:e.url}),await this.refresh()},async resume(e){await this.request(`${this.pluginName}.resume`,{torrent:e.url}),await this.refresh()},async remove(e){await this.request(`${this.pluginName}.remove`,{torrent:e.url}),await this.refresh()},async refresh(){this.loading=!0;try{this.transfers=Object.values(await this.request(`${this.pluginName}.status`)||{}).reduce(((e,t)=>(e[this.torrentId(t)]=t,e)),{})}finally{this.loading=!1}}},mounted(){this.refresh(),this.selectedView=this.transfers.length?"transfers":"search",this.subscribe(this.onTorrentUpdate,"on-torrent-update","platypush.message.event.torrent.TorrentDownloadStartEvent","platypush.message.event.torrent.TorrentDownloadProgressEvent","platypush.message.event.torrent.TorrentSeedingStartEvent","platypush.message.event.torrent.TorrentStateChangeEvent"),this.subscribe(this.onTorrentQueued,"on-torrent-queued","platypush.message.event.torrent.TorrentQueuedEvent"),this.subscribe(this.onTorrentStart,"on-torrent-queued","platypush.message.event.torrent.TorrentDownloadedMetadataEvent"),this.subscribe(this.onTorrentResume,"on-torrent-resume","platypush.message.event.torrent.TorrentResumedEvent"),this.subscribe(this.onTorrentPause,"on-torrent-pause","platypush.message.event.torrent.TorrentPausedEvent"),this.subscribe(this.onTorrentStop,"on-torrent-stop","platypush.message.event.torrent.TorrentDownloadStopEvent"),this.subscribe(this.onTorrentCompleted,"on-torrent-completed","platypush.message.event.torrent.TorrentDownloadCompletedEvent"),this.subscribe(this.onTorrentRemove,"on-torrent-remove","platypush.message.event.torrent.TorrentRemovedEvent");const e=document.querySelector('.search-box input[type="search"]');e&&this.$nextTick((()=>e.focus()))},destroy(){this.unsubscribe("on-torrent-update"),this.unsubscribe("on-torrent-remove")}};const tt=(0,H.Z)(et,[["render",i],["__scopeId","data-v-250eee36"]]);var st=tt},8:function(e,t,s){s.d(t,{Z:function(){return me}});var n=s(6252),a=s(3577);const l=e=>((0,n.dD)("data-v-65e233cd"),e=e(),(0,n.Cn)(),e),r={key:1,class:"torrent-transfers fade-in"},i={key:0,class:"no-content"},o=["onClick"],d={class:"col-8 left side"},c=["textContent"],u={class:"col-2 right side"},p=["textContent"],f={class:"col-2 right side"},h={key:0,class:"modal-body torrent-info"},v={key:0,class:"row"},m=l((()=>(0,n._)("div",{class:"attr"},"Name",-1))),w=["textContent"],g={key:1,class:"row"},_=l((()=>(0,n._)("div",{class:"attr"},"State",-1))),y=["textContent"],b={class:"row"},C=l((()=>(0,n._)("div",{class:"attr"},"Progress",-1))),k=["textContent"],I={class:"row"},x=l((()=>(0,n._)("div",{class:"attr"},"DL rate",-1))),D=["textContent"],T={class:"row"},$=l((()=>(0,n._)("div",{class:"attr"},"UL rate",-1))),S=["textContent"],q={class:"row"},z=l((()=>(0,n._)("div",{class:"attr"},"Size",-1))),Z=["textContent"],N={key:2,class:"row"},U=l((()=>(0,n._)("div",{class:"attr"},"Remaining",-1))),L=["textContent"],E={class:"row"},R=l((()=>(0,n._)("div",{class:"attr"},"URL",-1))),O={class:"value nowrap"},V=["href","textContent"],W={class:"row"},H=l((()=>(0,n._)("div",{class:"attr"},"Peers",-1))),j=["textContent"],P={key:3,class:"row"},F=l((()=>(0,n._)("div",{class:"attr"},"Started",-1))),B=["textContent"],M={key:4,class:"row"},K=l((()=>(0,n._)("div",{class:"attr"},"Finished",-1))),Y=["textContent"],A={key:5,class:"row"},Q=l((()=>(0,n._)("div",{class:"attr"},"Save path",-1))),X=["textContent"],G={key:6,class:"row"},J=l((()=>(0,n._)("div",{class:"attr"},"Files",-1))),ee={class:"value files-container"},te=["href","textContent"],se={key:0,class:"modal-body torrent-files"},ne={class:"col-1 icon"},ae={key:1,class:"fa fa-file"},le=["textContent"];function re(e,t,s,l,re,ie){const oe=(0,n.up)("Loading"),de=(0,n.up)("DropdownItem"),ce=(0,n.up)("Dropdown"),ue=(0,n.up)("Modal");return re.loading?((0,n.wg)(),(0,n.j4)(oe,{key:0})):((0,n.wg)(),(0,n.iD)("div",r,[Object.keys(s.transfers).length?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",i,"No torrent transfers in progress")),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.transfers,((s,l)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(["row item",{selected:re.selectedItem===l}]),key:l,onClick:e=>re.selectedItem=l},[(0,n._)("div",d,[(0,n._)("i",{class:(0,a.C_)(["icon fa",{"fa-check":null!=s.finish_date,"fa-play":!s.finish_date&&"downloading"===s.state&&!s.paused,"fa-pause":!s.finish_date&&"downloading"===s.state&&s.paused,"fa-stop":!s.finish_date&&"stopped"===s.state}])},null,2),(0,n._)("div",{class:"title",textContent:(0,a.zw)(s.name||s.hash||s.url)},null,8,c)]),(0,n._)("div",u,[(0,n._)("span",{textContent:(0,a.zw)(`${s.progress}%`)},null,8,p)]),(0,n._)("div",f,[(0,n.Wm)(ce,{title:"Actions","icon-class":"fa fa-ellipsis-h",onClick:e=>re.selectedItem=l},{default:(0,n.w5)((()=>["downloading"!==s.state||s.paused?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(de,{key:0,"icon-class":"fa fa-pause",text:"Pause transfer",onInput:t=>e.$emit("pause",s)},null,8,["onInput"])),"downloading"===s.state&&s.paused?((0,n.wg)(),(0,n.j4)(de,{key:1,"icon-class":"fa fa-play",text:"Resume transfer",onInput:t=>e.$emit("resume",s)},null,8,["onInput"])):(0,n.kq)("",!0),(0,n.Wm)(de,{"icon-class":"fa fa-trash",text:"Remove transfer",onInput:t=>e.$emit("remove",s)},null,8,["onInput"]),(0,n.Wm)(de,{"icon-class":"fa fa-folder",text:"View files",onInput:t[0]||(t[0]=t=>e.$refs.torrentFiles.isVisible=!0)}),(0,n.Wm)(de,{"icon-class":"fa fa-info",text:"Torrent info",onInput:t[1]||(t[1]=t=>e.$refs.torrentInfo.isVisible=!0)})])),_:2},1032,["onClick"])])],10,o)))),128)),(0,n.Wm)(ue,{ref:"torrentInfo",title:"Torrent info",width:"80%"},{default:(0,n.w5)((()=>[null!=re.selectedItem&&s.transfers[re.selectedItem]?((0,n.wg)(),(0,n.iD)("div",h,[s.transfers[re.selectedItem].name?((0,n.wg)(),(0,n.iD)("div",v,[m,(0,n._)("div",{class:"value",textContent:(0,a.zw)(s.transfers[re.selectedItem].name)},null,8,w)])):(0,n.kq)("",!0),s.transfers[re.selectedItem].state?((0,n.wg)(),(0,n.iD)("div",g,[_,(0,n._)("div",{class:"value",textContent:(0,a.zw)(s.transfers[re.selectedItem].state)},null,8,y)])):(0,n.kq)("",!0),(0,n._)("div",b,[C,(0,n._)("div",{class:"value",textContent:(0,a.zw)(`${s.transfers[re.selectedItem].progress||0}%`)},null,8,k)]),(0,n._)("div",I,[x,(0,n._)("div",{class:"value",textContent:(0,a.zw)(`${e.convertSize(s.transfers[re.selectedItem].download_rate||0)}/s`)},null,8,D)]),(0,n._)("div",T,[$,(0,n._)("div",{class:"value",textContent:(0,a.zw)(`${e.convertSize(s.transfers[re.selectedItem].upload_rate||0)}/s`)},null,8,S)]),(0,n._)("div",q,[z,(0,n._)("div",{class:"value",textContent:(0,a.zw)(e.convertSize(s.transfers[re.selectedItem].size||0))},null,8,Z)]),s.transfers[re.selectedItem].remaining_bytes?((0,n.wg)(),(0,n.iD)("div",N,[U,(0,n._)("div",{class:"value",textContent:(0,a.zw)(e.convertSize(s.transfers[re.selectedItem].remaining_bytes))},null,8,L)])):(0,n.kq)("",!0),(0,n._)("div",E,[R,(0,n._)("div",O,[(0,n._)("a",{href:s.transfers[re.selectedItem].url,target:"_blank",textContent:(0,a.zw)(s.transfers[re.selectedItem].url)},null,8,V)])]),(0,n._)("div",W,[H,(0,n._)("div",{class:"value",textContent:(0,a.zw)(s.transfers[re.selectedItem].peers||0)},null,8,j)]),s.transfers[re.selectedItem].start_date?((0,n.wg)(),(0,n.iD)("div",P,[F,(0,n._)("div",{class:"value",textContent:(0,a.zw)(e.formatDateTime(s.transfers[re.selectedItem].start_date))},null,8,B)])):(0,n.kq)("",!0),s.transfers[re.selectedItem].finish_date?((0,n.wg)(),(0,n.iD)("div",M,[K,(0,n._)("div",{class:"value",textContent:(0,a.zw)(e.formatDateTime(s.transfers[re.selectedItem].finish_date))},null,8,Y)])):(0,n.kq)("",!0),s.transfers[re.selectedItem].save_path?((0,n.wg)(),(0,n.iD)("div",A,[Q,(0,n._)("div",{class:"value",textContent:(0,a.zw)(s.transfers[re.selectedItem].save_path)},null,8,X)])):(0,n.kq)("",!0),s.transfers[re.selectedItem].files?((0,n.wg)(),(0,n.iD)("div",G,[J,(0,n._)("div",ee,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.transfers[re.selectedItem].files,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{class:"file",key:t},[(0,n._)("a",{href:`/file?path=${encodeURIComponent(e)}`,target:"_blank",textContent:(0,a.zw)(e)},null,8,te)])))),128))])])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])),_:1},512),(0,n.Wm)(ue,{ref:"torrentFiles",title:"Torrent files",width:"80%"},{default:(0,n.w5)((()=>[null!=re.selectedItem&&s.transfers[re.selectedItem]?((0,n.wg)(),(0,n.iD)("div",se,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(ie.relativeFiles,((t,l)=>((0,n.wg)(),(0,n.iD)("div",{class:"row",key:t},[(0,n._)("div",ne,[s.isMedia&&e.mediaExtensions.has(t.split(".").pop())?((0,n.wg)(),(0,n.j4)(ce,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(de,{"icon-class":"fa fa-play",text:"Play",onInput:t=>e.$emit("play",{url:`file://${s.transfers[re.selectedItem].files[l]}`,type:"file"})},null,8,["onInput"])])),_:2},1024)):((0,n.wg)(),(0,n.iD)("i",ae))]),(0,n._)("div",{class:"col-11 name",textContent:(0,a.zw)(t)},null,8,le)])))),128))])):(0,n.kq)("",!0)])),_:1},512)]))}var ie=s(6791),oe=s(8637),de=s(1065),ce=s(5166),ue=s(4904),pe=s(7597),fe={emits:["pause","play","play-with-captions","refresh","remove","resume"],components:{Dropdown:ue.Z,DropdownItem:pe.Z,Loading:ie.Z,Modal:ce.Z},mixins:[oe.Z,de.Z],props:{isMedia:{type:Boolean,default:!1},transfers:{type:Object,default:()=>({})}},data(){return{loading:!1,selectedItem:null}},computed:{relativeFiles(){return null!=this.selectedItem&&this.transfers[this.selectedItem]?.files?.length?this.transfers[this.selectedItem].files.map((e=>e.split("/").pop())):[]}}},he=s(3744);const ve=(0,he.Z)(fe,[["render",re],["__scopeId","data-v-65e233cd"]]);var me=ve}}]);
//# sourceMappingURL=6429.36d3a644.js.map